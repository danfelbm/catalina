import{d as F,Z as ne,c as B,k as S,w as Y,j as M,o as n,e as V,G as z,b as w,u as e,B as O,p as ee,y as te,z as j,x as se,C as W,a as p,i as D,m as ie,g as h,t as k,f,h as Z,n as re,F as de,r as ue}from"./app-C-ljWtfy.js";import{_ as J}from"./InputError.vue_vue_type_script_setup_true_lang-DuWfpyDP.js";import{P as K,a as U,_ as T}from"./createLucideIcon-_oXcxsH_.js";import{h as ce,u as pe,n as H,_ as Q,a as me}from"./Label.vue_vue_type_script_setup_true_lang-BUmVMQfq.js";import{a as fe,c as ve,u as ge,g as _e,d as he,b as ae}from"./VisuallyHidden-SZsN-sM_.js";import{V as ye}from"./VisuallyHiddenInput-BrgKv1qv.js";import{_ as be}from"./AuthLayout.vue_vue_type_script_setup_true_lang-CUawt_68.js";import{M as xe}from"./mail-DbSCQi_1.js";import{L}from"./loader-circle-B5yojVdb.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-DK8M-y8i.js";const ke=["INPUT","TEXTAREA"];function we(u,l,a,s={}){if(!l||s.enableIgnoredElement&&ke.includes(l.nodeName))return null;const{arrowKeyOptions:d="both",attributeName:m="[data-reka-collection-item]",itemsArray:c=[],loop:v=!0,dir:g="ltr",preventScroll:x=!0,focus:y=!1}=s,[E,C,P,A,$,N]=[u.key==="ArrowRight",u.key==="ArrowLeft",u.key==="ArrowUp",u.key==="ArrowDown",u.key==="Home",u.key==="End"],I=P||A,i=E||C;if(!$&&!N&&(!I&&!i||d==="vertical"&&i||d==="horizontal"&&I))return null;const o=c;if(!o.length)return null;x&&u.preventDefault();let _=null;return i||I?_=oe(o,l,{goForward:I?A:g==="ltr"?E:C,loop:v}):$?_=o.at(0)||null:N&&(_=o.at(-1)||null),y&&(_==null||_.focus()),_}function oe(u,l,a,s=u.length){if(--s===0)return null;const d=u.indexOf(l),m=a.goForward?d+1:d-1;if(!a.loop&&(m<0||m>=u.length))return null;const c=(m+u.length)%u.length,v=u[c];return v?v.hasAttribute("disabled")&&v.getAttribute("disabled")!=="false"?oe(u,v,a,s):v:null}const[Ce,Ve]=ve("PinInputRoot");var Ie=F({inheritAttrs:!1,__name:"PinInputRoot",props:{modelValue:{type:null,required:!1},defaultValue:{type:Array,required:!1},placeholder:{type:String,required:!1,default:""},mask:{type:Boolean,required:!1},otp:{type:Boolean,required:!1},type:{type:null,required:!1,default:"text"},dir:{type:String,required:!1},disabled:{type:Boolean,required:!1},id:{type:String,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1},name:{type:String,required:!1},required:{type:Boolean,required:!1}},emits:["update:modelValue","complete"],setup(u,{emit:l}){const a=u,s=l,{mask:d,otp:m,placeholder:c,type:v,disabled:g,dir:x}=ne(a),{forwardRef:y}=ce(),E=fe(x),C=pe(a,"modelValue",s,{defaultValue:a.defaultValue??[],passive:a.modelValue===void 0}),P=B(()=>Array.isArray(C.value)?[...C.value]:[]),A=S(new Set);function $(i){A.value.add(i)}const N=B(()=>a.type==="number"),I=B(()=>P.value.filter(o=>!!o||N.value&&o===0).length===A.value.size);return Y(C,()=>{I.value&&s("complete",C.value)},{deep:!0}),Ve({modelValue:C,currentModelValue:P,mask:d,otp:m,placeholder:c,type:v,dir:E,disabled:g,isCompleted:I,inputElements:A,onInputElementChange:$,isNumericMode:N}),(i,o)=>(n(),M(e(K),O(i.$attrs,{ref:e(y),dir:e(E),"data-complete":I.value?"":void 0,"data-disabled":e(g)?"":void 0}),{default:V(()=>[z(i.$slots,"default",{modelValue:e(C)}),w(ye,{id:i.id,as:"input",feature:"focusable",tabindex:"-1",value:P.value.join(""),name:i.name??"",disabled:e(g),required:i.required,onFocus:o[0]||(o[0]=_=>{var t,r;return(r=(t=Array.from(A.value))==null?void 0:t[0])==null?void 0:r.focus()})},null,8,["id","value","name","disabled","required"])]),_:3},16,["dir","data-complete","data-disabled"]))}}),Ee=Ie,Pe=F({__name:"PinInputInput",props:{index:{type:Number,required:!0},disabled:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"input"}},setup(u){const l=u,a=Ce(),s=B(()=>Array.from(a.inputElements.value)),d=B(()=>a.currentModelValue.value[l.index]),m=B(()=>l.disabled||a.disabled.value),c=B(()=>a.otp.value),v=B(()=>a.mask.value),{primitiveElement:g,currentElement:x}=ge();function y(t){var q;const r=t.target;if((((q=t.data)==null?void 0:q.length)??0)>1){i(r.value);return}if(a.isNumericMode.value&&!/^\d*$/.test(r.value)){r.value=r.value.replace(/\D/g,"");return}r.value=t.data??"",_(l.index,r.value);const b=s.value[l.index+1];b&&b.focus()}function E(){const t=x.value;se(()=>{t&&!t.value&&(t.placeholder=a.placeholder.value)})}function C(t){we(t,_e(),void 0,{itemsArray:s.value,focus:!0,loop:!1,arrowKeyOptions:"horizontal",dir:a.dir.value})}function P(t){if(t.preventDefault(),t.target.value)_(l.index,"");else{const q=s.value[l.index-1];q&&(q.focus(),_(l.index-1,""))}}function A(t){t.key==="Delete"&&(t.preventDefault(),_(l.index,""))}function $(t){const r=t.target;r.setSelectionRange(1,1),r.value||(r.placeholder="")}function N(t){E()}function I(t){t.preventDefault();const r=t.clipboardData;if(!r)return;const b=r.getData("text");i(b)}function i(t){var G;const r=[...a.currentModelValue.value],b=t.length>=s.value.length?0:l.index,q=Math.min(b+t.length,s.value.length);for(let R=b;R<q;R++){const le=s.value[R],X=t[R-b];a.isNumericMode.value&&!/^\d*$/.test(X)||(r[R]=X,le.focus())}a.modelValue.value=r,(G=s.value[q])==null||G.focus()}function o(t){let r=t.length-1;for(;r>=0&&t[r]==="";)t.pop(),r--;return t}function _(t,r){const b=[...a.currentModelValue.value];if(a.isNumericMode.value){const q=+r;r===""||isNaN(q)?delete b[t]:b[t]=q}else b[t]=r;a.modelValue.value=o(b)}return Y(d,()=>{d.value||E()}),ee(()=>{a.onInputElementChange(x.value)}),te(()=>{var t;(t=a.inputElements)==null||t.value.delete(x.value)}),(t,r)=>(n(),M(e(K),{ref_key:"primitiveElement",ref:g,autocapitalize:"none",as:t.as,"as-child":t.asChild,autocomplete:c.value?"one-time-code":"false",type:v.value?"password":"text",inputmode:e(a).isNumericMode.value?"numeric":"text",pattern:e(a).isNumericMode.value?"[0-9]*":void 0,placeholder:e(a).placeholder.value,value:d.value,disabled:m.value,"data-disabled":m.value?"":void 0,"data-complete":e(a).isCompleted.value?"":void 0,"aria-label":`pin input ${t.index+1} of ${s.value.length}`,onInput:r[0]||(r[0]=b=>y(b)),onKeydown:[j(C,["left","right","up","down","home","end"]),j(P,["backspace"]),j(A,["delete"])],onFocus:$,onBlur:N,onPaste:I},{default:V(()=>[z(t.$slots,"default")]),_:3},8,["as","as-child","autocomplete","type","inputmode","pattern","placeholder","value","disabled","data-disabled","data-complete","aria-label"]))}}),Ae=Pe;const qe=F({__name:"PinInput",props:{modelValue:{default:()=>[]},defaultValue:{},placeholder:{},mask:{type:Boolean},otp:{type:Boolean},type:{},dir:{},disabled:{type:Boolean},id:{},asChild:{type:Boolean},as:{},name:{},required:{type:Boolean},class:{}},emits:["update:modelValue","complete"],setup(u,{emit:l}){const a=u,s=l,d=H(a,"class"),m=he(d,s);return(c,v)=>(n(),M(e(Ee),O({"data-slot":"pin-input"},e(m),{class:e(U)("flex items-center gap-2 has-disabled:opacity-50 disabled:cursor-not-allowed",a.class)}),{default:V(()=>[z(c.$slots,"default")]),_:3},16,["class"]))}}),Be=F({__name:"PinInputGroup",props:{asChild:{type:Boolean},as:{},class:{}},setup(u){const l=u,a=H(l,"class"),s=ae(a);return(d,m)=>(n(),M(e(K),O({"data-slot":"pin-input-group"},e(s),{class:e(U)("flex items-center",l.class)}),{default:V(()=>[z(d.$slots,"default")]),_:3},16,["class"]))}}),Me=F({__name:"PinInputSlot",props:{index:{},disabled:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},setup(u){const l=u,a=H(l,"class"),s=ae(a);return(d,m)=>(n(),M(e(Ae),O({"data-slot":"pin-input-slot"},e(s),{class:e(U)("border-input focus:border-ring focus:ring-ring/50 focus:aria-invalid:ring-destructive/20 dark:bg-input/30 dark:focus:aria-invalid:ring-destructive/40 aria-invalid:border-destructive focus:aria-invalid:border-destructive relative flex h-9 w-9 items-center justify-center border-y border-r text-sm shadow-xs transition-all outline-none text-center first:rounded-l-md first:border-l last:rounded-r-md focus:z-10 focus:ring-[3px]",l.class)}),null,16,["class"]))}}),Ne={key:0,class:"mb-4 text-center text-muted-foreground"},$e={key:0},Se={key:0},Fe={key:1},Re={key:2},De={key:3},Te={key:1},ze={key:1,class:"mb-4 text-center text-muted-foreground"},Oe={key:0},je={key:1},We={key:2},Le={key:2,class:"mb-4 text-center text-sm font-medium text-green-600"},Ke={class:"grid gap-6"},Ue={class:"grid gap-2"},He={class:"relative"},Ge={class:"grid gap-6"},Xe={class:"text-center"},Ze={class:"text-sm text-muted-foreground"},Je={key:0},Qe={key:0},Ye={class:"font-medium"},et={key:1},tt={class:"font-medium"},at={key:2},ot={class:"font-medium"},lt={key:1},nt={key:0},st={class:"font-medium"},it={key:1},rt={class:"font-medium"},dt={class:"font-medium"},ut={key:2},ct={class:"font-medium"},pt={class:"font-medium"},mt={class:"grid gap-2"},ft={class:"flex justify-center"},vt={class:"flex flex-col gap-3"},gt={class:"flex flex-col gap-2 text-center"},Et=F({__name:"LoginOTP",props:{status:{},authConfig:{},censoredEmail:{},otpCredential:{},otpChannel:{},whatsappEnabled:{type:Boolean}},setup(u){const l=u,a=S(l.censoredEmail?"otp":"credential"),s=S(l.censoredEmail||""),d=B(()=>l.authConfig||{login_type:"email",input_type:"email",placeholder:"correo@ejemplo.com",pattern:null,label:"Correo Electrónico"}),m=W({credential:""}),c=W({credential:l.otpCredential||"",otp_code:[]}),v=W({credential:"",otp_code:""}),g=S(!1),x=S(0),y=S(null),E=B(()=>x.value===0),C=B(()=>x.value>0?`Reenviar en ${x.value}s`:"Reenviar código"),P=(i=60)=>{x.value=i,y.value&&clearInterval(y.value),y.value=window.setInterval(()=>{x.value--,x.value<=0&&(clearInterval(y.value),y.value=null)},1e3)},A=()=>{g.value=!0,m.post(route("auth.request-otp"),{onSuccess:i=>{i.props&&i.props.censoredEmail&&(s.value=i.props.censoredEmail),a.value="otp",c.credential=m.credential,c.clearErrors(),P(60)},onError:()=>{},onFinish:()=>{g.value=!1}})},$=()=>{const i=c.otp_code.join("");v.credential=c.credential,v.otp_code=i,v.post(route("auth.verify-otp"),{onSuccess:()=>{},onError:()=>{c.otp_code=[]}})},N=()=>{E.value&&(g.value=!0,c.post(route("auth.resend-otp"),{onSuccess:i=>{i.props&&i.props.censoredEmail&&(s.value=i.props.censoredEmail),P(60)},onFinish:()=>{g.value=!1}}))},I=()=>{a.value="credential",c.reset(),y.value&&(clearInterval(y.value),y.value=null),x.value=0};return ee(()=>{a.value==="otp"&&P(60)}),te(()=>{y.value&&clearInterval(y.value)}),(i,o)=>(n(),M(be,{title:a.value==="credential"?"Iniciar Sesión":"Verificar Código"},{default:V(()=>[w(e(ie),{title:"Iniciar Sesión"}),a.value==="credential"?(n(),p("div",Ne,[d.value.login_type==="documento"?(n(),p("p",$e,[o[2]||(o[2]=h(" Ingresa tu documento de identidad para recibir el código de verificación ")),i.whatsappEnabled?l.otpChannel==="whatsapp"?(n(),p("strong",Fe,"vía WhatsApp")):l.otpChannel==="both"?(n(),p("strong",Re,"vía correo electrónico y WhatsApp")):(n(),p("strong",De,"vía correo electrónico")):(n(),p("strong",Se,"vía correo electrónico"))])):(n(),p("p",Te," Ingresa tu "+k(d.value.label.toLowerCase())+" para recibir el código de verificación ",1))])):(n(),p("div",ze,[l.otpChannel==="whatsapp"?(n(),p("p",Oe,o[3]||(o[3]=[h(" Ingresa el código de 6 dígitos enviado a tu "),f("strong",null,"WhatsApp",-1)]))):l.otpChannel==="both"?(n(),p("p",je,o[4]||(o[4]=[h(" Ingresa el código de 6 dígitos enviado a tu "),f("strong",null,"correo y WhatsApp",-1)]))):(n(),p("p",We,o[5]||(o[5]=[h(" Ingresa el código de 6 dígitos enviado a tu "),f("strong",null,"correo",-1)])))])),i.status?(n(),p("div",Le,k(i.status),1)):D("",!0),a.value==="credential"?(n(),p("form",{key:3,onSubmit:Z(A,["prevent"]),class:"flex flex-col gap-6"},[f("div",Ke,[f("div",Ue,[w(e(Q),{for:"credential"},{default:V(()=>[h(k(d.value.label),1)]),_:1}),f("div",He,[d.value.login_type==="email"?(n(),M(e(xe),{key:0,class:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"})):D("",!0),w(e(me),{id:"credential",type:d.value.input_type,required:"",autofocus:"",tabindex:"1",autocomplete:d.value.login_type==="email"?"email":"off",inputmode:d.value.login_type==="documento"?"numeric":void 0,modelValue:e(m).credential,"onUpdate:modelValue":o[0]||(o[0]=_=>e(m).credential=_),placeholder:d.value.placeholder,pattern:d.value.pattern,class:re({"pl-10":d.value.login_type==="email"})},null,8,["type","autocomplete","inputmode","modelValue","placeholder","pattern","class"])]),w(J,{message:e(m).errors.credential},null,8,["message"])]),w(e(T),{type:"submit",class:"mt-4 w-full",tabindex:"2",disabled:e(m).processing||g.value},{default:V(()=>[e(m).processing||g.value?(n(),M(e(L),{key:0,class:"mr-2 h-4 w-4 animate-spin"})):D("",!0),h(" "+k(e(m).processing||g.value?"Enviando...":"Enviar Código"),1)]),_:1},8,["disabled"])])],32)):(n(),p("form",{key:4,onSubmit:Z($,["prevent"]),class:"flex flex-col gap-6"},[f("div",Ge,[f("div",Xe,[f("p",Ze,[d.value.login_type==="email"?(n(),p("span",Je,[l.otpChannel==="whatsapp"?(n(),p("span",Qe,[o[6]||(o[6]=h(" Código enviado por WhatsApp al número asociado con ")),f("span",Ye,k(s.value||e(c).credential),1)])):l.otpChannel==="both"?(n(),p("span",et,[o[7]||(o[7]=h(" Código enviado al email ")),f("span",tt,k(s.value||e(c).credential),1),o[8]||(o[8]=h(" y WhatsApp "))])):(n(),p("span",at,[o[9]||(o[9]=h(" Código enviado al email ")),f("span",ot,k(s.value||e(c).credential),1)]))])):(n(),p("span",lt,[l.otpChannel==="whatsapp"?(n(),p("span",nt,[o[10]||(o[10]=h(" Código enviado por WhatsApp al número asociado con el documento ")),f("span",st,k(e(c).credential),1)])):l.otpChannel==="both"?(n(),p("span",it,[o[11]||(o[11]=h(" Código enviado al email ")),f("span",rt,k(s.value),1),o[12]||(o[12]=h(" y WhatsApp asociados al documento ")),f("span",dt,k(e(c).credential),1)])):(n(),p("span",ut,[o[13]||(o[13]=h(" Código enviado al email ")),f("span",ct,k(s.value),1),o[14]||(o[14]=h(" asociado al documento ")),f("span",pt,k(e(c).credential),1)]))]))])]),f("div",mt,[w(e(Q),{class:"text-center"},{default:V(()=>o[15]||(o[15]=[h("Código de Verificación")])),_:1}),f("div",ft,[w(e(qe),{modelValue:e(c).otp_code,"onUpdate:modelValue":o[1]||(o[1]=_=>e(c).otp_code=_),length:6,type:"text",placeholder:"0",class:"gap-2"},{default:V(()=>[w(e(Be),null,{default:V(()=>[(n(),p(de,null,ue(6,(_,t)=>w(e(Me),{key:_,index:t,class:"h-12 w-12 text-lg font-medium",inputmode:"numeric"},null,8,["index"])),64))]),_:1})]),_:1},8,["modelValue"])]),w(J,{message:e(c).errors.otp_code},null,8,["message"])]),f("div",vt,[w(e(T),{type:"submit",class:"w-full",disabled:e(v).processing||e(c).otp_code.join("").length!==6},{default:V(()=>[e(v).processing?(n(),M(e(L),{key:0,class:"mr-2 h-4 w-4 animate-spin"})):D("",!0),h(" "+k(e(v).processing?"Verificando...":"Verificar Código"),1)]),_:1},8,["disabled"]),f("div",gt,[w(e(T),{type:"button",variant:"ghost",size:"sm",onClick:N,disabled:!E.value||g.value},{default:V(()=>[g.value?(n(),M(e(L),{key:0,class:"mr-2 h-3 w-3 animate-spin"})):D("",!0),h(" "+k(g.value?"Enviando...":C.value),1)]),_:1},8,["disabled"]),w(e(T),{type:"button",variant:"ghost",size:"sm",onClick:I},{default:V(()=>[h(k(d.value.login_type==="email"?"Cambiar correo electrónico":"Cambiar documento"),1)]),_:1})])])])],32))]),_:1},8,["title"]))}});export{Et as default};
