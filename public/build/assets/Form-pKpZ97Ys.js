import{_ as ta}from"./AppLayout.vue_vue_type_script_setup_true_lang-DrR_52Cc.js";import{e as z,l as S,C as ra}from"./DialogTitle.vue_vue_type_script_setup_true_lang-Cap5hEl3.js";import{_ as N}from"./createLucideIcon-_oXcxsH_.js";import{_ as k,c as h,a as w,b as $,F as da}from"./index-C1n5YpSv.js";import{_ as I}from"./CardDescription.vue_vue_type_script_setup_true_lang-Dy74ld2R.js";import{_ as la,a as na,b as L,c as O}from"./TabsTrigger.vue_vue_type_script_setup_true_lang-b7xwyLkR.js";import{D as ia}from"./DynamicFormRenderer-ZwLTy7_f.js";import{d as ua,k as V,c as C,C as ca,a as u,o as l,b as t,u as o,m as pa,e as r,f as s,j as P,i as _,W as ma,g as c,t as n,n as b,l as W,F as G,r as fa}from"./app-C-ljWtfy.js";import{A as ba}from"./arrow-left-CpNmfABz.js";import{S as M}from"./save-DnW2Ecqm.js";import{S as X}from"./send-I4y239CU.js";import{C as va}from"./clock-Cb6qrYV_.js";import{C as H}from"./circle-check-big-R1DwQvLv.js";import{C as J}from"./circle-x-jOj5Bprj.js";import{U as ga}from"./user-Q-m993Fk.js";import"./Label.vue_vue_type_script_setup_true_lang-BUmVMQfq.js";import"./index-BfIyhi4o.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-DK8M-y8i.js";import"./VisuallyHidden-SZsN-sM_.js";import"./RovingFocusItem-CaM9lr2a.js";import"./Checkbox.vue_vue_type_script_setup_true_lang-D7tWp4m1.js";import"./Textarea.vue_vue_type_script_setup_true_lang-Dq6pp1kI.js";import"./plus-CEd_Yrfl.js";import"./RadioGroupItem.vue_vue_type_script_setup_true_lang-xsTj8dRk.js";import"./VisuallyHiddenInput-BrgKv1qv.js";import"./useConditionalFields-Ca9-bdBL.js";import"./upload-DEXAboJi.js";import"./eye-C1Tj_mCC.js";import"./download-D_7q6ctc.js";import"./grip-vertical-DfJmJyer.js";import"./trash-2-BEi92pnC.js";const _a={class:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4"},ya={class:"space-y-6"},ka={class:"flex items-center justify-between"},ha={class:"space-y-1"},Ca={class:"flex items-center gap-2"},xa={class:"text-3xl font-bold tracking-tight"},wa={class:"text-muted-foreground"},$a={class:"flex items-start justify-between"},Pa={class:"flex items-start gap-3"},Aa={class:"space-y-1"},Ea={class:"flex items-center gap-2"},Fa={class:"text-sm text-muted-foreground"},ja={key:0},za={key:1},Sa={key:2},Na={key:3},Va={key:4},Ra={key:5},Ta={class:"flex items-start gap-2"},Ba={class:"flex-1"},qa={class:"text-xs mt-2 opacity-75"},Da={key:0},Ua={key:1},Ia={key:2},La={class:"grid grid-cols-2 gap-4 text-sm"},Oa={class:"font-medium"},Wa={class:"font-medium"},Ga={class:"font-medium text-xs"},Ma={class:"font-medium"},Xa={key:0,class:"p-4 bg-red-50 border border-red-200 rounded-lg"},Ha={class:"flex items-start gap-2"},Ja={class:"text-sm text-red-800"},Ka={key:1,class:"flex justify-end gap-3"},Qa={class:"flex items-center justify-between"},Ya={class:"flex items-center justify-between"},Za={class:"text-muted-foreground"},ae={class:"font-medium text-right max-w-xs"},ee={class:"grid grid-cols-2 gap-4 text-sm"},oe={class:"font-medium"},se={class:"font-medium"},te={class:"font-medium"},re={class:"font-medium"},Be=ua({__name:"Form",props:{convocatoria:{},postulacion:{},candidatura_aprobada:{}},setup(K){var T,B,q,D,U;const d=K,Q=[{title:"Postulaciones",href:"/postulaciones"},{title:d.convocatoria.nombre,href:`/convocatorias/${d.convocatoria.id}`}],A=V(),Y=C(()=>d.candidatura_aprobada?[{id:d.candidatura_aprobada.id,version:d.candidatura_aprobada.version,fecha_aprobacion:d.candidatura_aprobada.fecha_aprobacion,resumen:`Perfil v${d.candidatura_aprobada.version} - Aprobado ${d.candidatura_aprobada.fecha_aprobacion}`}]:[]),f=ca({formulario_data:((T=d.postulacion)==null?void 0:T.formulario_data)||{},candidatura_id:(B=d.postulacion)!=null&&B.candidatura_snapshot?(q=d.candidatura_aprobada)==null?void 0:q.id:null,enviar:!1}),x=V((D=d.postulacion)!=null&&D.candidatura_snapshot&&((U=d.candidatura_aprobada)==null?void 0:U.id)||null),E=C(()=>!!d.postulacion),R=C(()=>d.postulacion?d.postulacion.puede_editar:!0),j=C(()=>{var a;return!!((a=d.postulacion)!=null&&a.comentarios_admin)}),Z=a=>{switch(a){case"abierta":return H;case"futura":return ra;case"cerrada":return J;default:return S}},aa=()=>{f.enviar=!1,f.candidatura_id=x.value,f.post(`/convocatorias/${d.convocatoria.id}/postular`,{preserveScroll:!0})},v=V(null),ea=()=>{var a,e,i;if(v.value=null,!((a=A.value)!=null&&a.formularioCompleto)){const m=((e=A.value)==null?void 0:e.camposIncompletos)||[],p=(i=A.value)==null?void 0:i.perfilCandidaturaRequerido;m.length>0?v.value=`Formulario incompleto: Por favor completa todos los campos requeridos (${m.length} campos faltantes).`:p&&!x.value?v.value="Debes seleccionar tu perfil de candidatura aprobado para continuar.":v.value="Por favor completa todos los campos requeridos del formulario.";const g=document.querySelector('[role="tabpanel"]');g&&g.scrollIntoView({behavior:"smooth",block:"start"});return}f.enviar=!0,f.candidatura_id=x.value,f.post(`/convocatorias/${d.convocatoria.id}/postular`,{preserveScroll:!0,onError:m=>{const p=Object.values(m)[0];p?v.value=Array.isArray(p)?p[0]:p:v.value="Error al enviar la postulación. Por favor revisa los datos e intenta nuevamente."}})},oa=(a,e)=>{const i={};for(const[m,p]of Object.entries(a)){const g=e.find(F=>F.id===m);g&&(i[g.title]=Array.isArray(p)?p.join(", "):p)}return i},sa=C(()=>{var a;return(a=d.postulacion)!=null&&a.formulario_data?oa(d.postulacion.formulario_data,d.convocatoria.formulario_postulacion):{}}),y=C(()=>{var e,i,m,p,g,F;if(!((e=d.postulacion)!=null&&e.candidatura_snapshot))return null;const a=d.postulacion.candidatura_snapshot;return{usuario:((i=a.usuario)==null?void 0:i.name)||"N/A",version:((m=a.candidatura)==null?void 0:m.version_original)||"N/A",fecha_aprobacion:((p=a.candidatura)==null?void 0:p.fecha_aprobacion)||"N/A",aprobado_por:((F=(g=a.candidatura)==null?void 0:g.aprobado_por)==null?void 0:F.name)||"N/A"}});return(a,e)=>(l(),u(G,null,[t(o(pa),{title:`${E.value?"Editar":"Nueva"} Postulación - ${a.convocatoria.nombre}`},null,8,["title"]),t(ta,{breadcrumbs:Q},{default:r(()=>[s("div",_a,[s("div",ya,[s("div",ka,[s("div",ha,[s("div",Ca,[t(o(N),{variant:"ghost",size:"sm",onClick:e[0]||(e[0]=i=>o(ma).get("/postulaciones"))},{default:r(()=>[t(o(ba),{class:"h-4 w-4 mr-2"}),e[3]||(e[3]=c(" Volver "))]),_:1})]),s("h1",xa,n(E.value?"Editar Postulación":"Nueva Postulación"),1),s("p",wa,n(a.convocatoria.nombre),1)]),t(o(z),{class:b(a.convocatoria.estado_temporal==="abierta"?"bg-green-100 text-green-800":"bg-blue-100 text-blue-800")},{default:r(()=>[(l(),P(W(Z(a.convocatoria.estado_temporal)),{class:"mr-1 h-3 w-3"})),c(" "+n(a.convocatoria.estado_temporal_label),1)]),_:1},8,["class"])]),a.postulacion?(l(),P(o(k),{key:0,class:b({"border-yellow-500":a.postulacion.estado==="borrador","border-blue-500":a.postulacion.estado==="enviada","border-purple-500":a.postulacion.estado==="en_revision","border-green-500":a.postulacion.estado==="aceptada","border-red-500":a.postulacion.estado==="rechazada"})},{default:r(()=>[t(o(h),{class:"pt-6"},{default:r(()=>[s("div",$a,[s("div",Pa,[s("div",{class:b([{"bg-yellow-100 text-yellow-600":a.postulacion.estado==="borrador","bg-blue-100 text-blue-600":a.postulacion.estado==="enviada","bg-purple-100 text-purple-600":a.postulacion.estado==="en_revision","bg-green-100 text-green-600":a.postulacion.estado==="aceptada","bg-red-100 text-red-600":a.postulacion.estado==="rechazada"},"rounded-full p-2"])},[(l(),P(W(a.postulacion.estado==="borrador"?o(M):a.postulacion.estado==="enviada"?o(X):a.postulacion.estado==="en_revision"?o(va):a.postulacion.estado==="aceptada"?o(H):o(J)),{class:"h-5 w-5"}))],2),s("div",Aa,[s("div",Ea,[e[4]||(e[4]=s("h3",{class:"font-semibold"},"Estado actual:",-1)),t(o(z),{class:b(a.postulacion.estado==="borrador"?"bg-yellow-100 text-yellow-800":a.postulacion.estado==="enviada"?"bg-blue-100 text-blue-800":a.postulacion.estado==="en_revision"?"bg-purple-100 text-purple-800":a.postulacion.estado==="aceptada"?"bg-green-100 text-green-800":"bg-red-100 text-red-800")},{default:r(()=>[c(n(a.postulacion.estado_label),1)]),_:1},8,["class"])]),s("p",Fa,[a.postulacion.estado==="borrador"&&j.value?(l(),u("span",ja," Tu postulación fue devuelta a borrador. Revisa los comentarios del administrador abajo y realiza los ajustes necesarios. ")):a.postulacion.estado==="borrador"?(l(),u("span",za," Puedes editar y enviar tu postulación cuando esté completa. ")):a.postulacion.estado==="enviada"?(l(),u("span",Sa," Tu postulación ha sido enviada y está pendiente de revisión. ")):a.postulacion.estado==="en_revision"?(l(),u("span",Na," Tu postulación está siendo revisada por el administrador. ")):a.postulacion.estado==="aceptada"?(l(),u("span",Va," ¡Felicidades! Tu postulación ha sido aceptada. ")):a.postulacion.estado==="rechazada"?(l(),u("span",Ra," Tu postulación fue rechazada. Revisa los comentarios del administrador abajo y realiza los ajustes necesarios. ")):_("",!0)])])])]),j.value?(l(),u("div",{key:0,class:b([{"bg-red-50 dark:bg-red-950/20 border border-red-200 dark:border-red-800":a.postulacion.estado==="rechazada","bg-amber-50 dark:bg-amber-950/20 border border-amber-200 dark:border-amber-800":a.postulacion.estado==="borrador","bg-blue-50 dark:bg-blue-950/20 border border-blue-200 dark:border-blue-800":a.postulacion.estado==="enviada"||a.postulacion.estado==="en_revision","bg-green-50 dark:bg-green-950/20 border border-green-200 dark:border-green-800":a.postulacion.estado==="aceptada"},"mt-4 p-4 rounded-lg"])},[s("div",Ta,[t(o(S),{class:b([{"text-red-600 dark:text-red-400":a.postulacion.estado==="rechazada","text-amber-600 dark:text-amber-400":a.postulacion.estado==="borrador","text-blue-600 dark:text-blue-400":a.postulacion.estado==="enviada"||a.postulacion.estado==="en_revision","text-green-600 dark:text-green-400":a.postulacion.estado==="aceptada"},"h-5 w-5 mt-0.5 flex-shrink-0"])},null,8,["class"]),s("div",Ba,[s("p",{class:b(["font-semibold mb-1",{"text-red-900 dark:text-red-100":a.postulacion.estado==="rechazada","text-amber-900 dark:text-amber-100":a.postulacion.estado==="borrador","text-blue-900 dark:text-blue-100":a.postulacion.estado==="enviada"||a.postulacion.estado==="en_revision","text-green-900 dark:text-green-100":a.postulacion.estado==="aceptada"}])}," Comentarios de la comisión: ",2),s("p",{class:b(["text-sm whitespace-pre-wrap",{"text-red-800 dark:text-red-200":a.postulacion.estado==="rechazada","text-amber-800 dark:text-amber-200":a.postulacion.estado==="borrador","text-blue-800 dark:text-blue-200":a.postulacion.estado==="enviada"||a.postulacion.estado==="en_revision","text-green-800 dark:text-green-200":a.postulacion.estado==="aceptada"}])},n(a.postulacion.comentarios_admin),3),s("p",qa,[a.postulacion.estado==="rechazada"||a.postulacion.estado==="borrador"&&j.value?(l(),u("span",Da," Por favor, atiende estos comentarios antes de reenviar tu postulación. ")):a.postulacion.estado==="aceptada"?(l(),u("span",Ua," Tu postulación fue aceptada con estos comentarios. ")):(l(),u("span",Ia," Estos comentarios fueron agregados durante la revisión. "))])])])],2)):_("",!0)]),_:1})]),_:1},8,["class"])):_("",!0),t(o(k),null,{default:r(()=>[t(o(w),null,{default:r(()=>[t(o($),{class:"flex items-center gap-2"},{default:r(()=>[t(o(da),{class:"h-5 w-5"}),e[5]||(e[5]=c(" Información de la Convocatoria "))]),_:1}),t(o(I),null,{default:r(()=>[c(n(a.convocatoria.descripcion),1)]),_:1})]),_:1}),t(o(h),{class:"space-y-4"},{default:r(()=>[s("div",La,[s("div",null,[e[6]||(e[6]=s("span",{class:"text-muted-foreground"},"Cargo:",-1)),s("p",Oa,n(a.convocatoria.cargo),1)]),s("div",null,[e[7]||(e[7]=s("span",{class:"text-muted-foreground"},"Periodo:",-1)),s("p",Wa,n(a.convocatoria.periodo),1)]),s("div",null,[e[8]||(e[8]=s("span",{class:"text-muted-foreground"},"Fechas:",-1)),s("p",Ga,n(a.convocatoria.rango_fechas),1)]),s("div",null,[e[9]||(e[9]=s("span",{class:"text-muted-foreground"},"Ubicación:",-1)),s("p",Ma,n(a.convocatoria.ubicacion),1)])])]),_:1})]),_:1}),t(o(la),{"default-value":"formulario",class:"space-y-4"},{default:r(()=>[t(o(na),{class:"grid w-full grid-cols-2"},{default:r(()=>[t(o(L),{value:"formulario"},{default:r(()=>e[10]||(e[10]=[c(" Formulario de Postulación ")])),_:1}),t(o(L),{value:"resumen",disabled:!E.value},{default:r(()=>e[11]||(e[11]=[c(" Resumen Actual ")])),_:1},8,["disabled"])]),_:1}),t(o(O),{value:"formulario",class:"space-y-6"},{default:r(()=>[t(o(k),null,{default:r(()=>[t(o(w),null,{default:r(()=>[t(o($),null,{default:r(()=>e[12]||(e[12]=[c("Completa tu Postulación")])),_:1}),t(o(I),null,{default:r(()=>e[13]||(e[13]=[c(" Completa todos los campos requeridos para enviar tu postulación. ")])),_:1})]),_:1}),t(o(h),null,{default:r(()=>[t(ia,{ref_key:"formRenderer",ref:A,fields:a.convocatoria.formulario_postulacion,modelValue:o(f).formulario_data,"onUpdate:modelValue":e[1]||(e[1]=i=>o(f).formulario_data=i),"candidatura-seleccionada":x.value,"onUpdate:candidaturaSeleccionada":e[2]||(e[2]=i=>x.value=i),"candidaturas-aprobadas":Y.value,errors:o(f).errors,disabled:!R.value},null,8,["fields","modelValue","candidatura-seleccionada","candidaturas-aprobadas","errors","disabled"])]),_:1})]),_:1}),v.value?(l(),u("div",Xa,[s("div",Ha,[t(o(S),{class:"h-5 w-5 text-red-600 mt-0.5"}),s("p",Ja,n(v.value),1)])])):_("",!0),R.value?(l(),u("div",Ka,[t(o(N),{type:"button",variant:"outline",onClick:aa,disabled:o(f).processing},{default:r(()=>[t(o(M),{class:"mr-2 h-4 w-4"}),e[14]||(e[14]=c(" Guardar Borrador "))]),_:1},8,["disabled"]),t(o(N),{type:"button",onClick:ea,disabled:o(f).processing},{default:r(()=>[t(o(X),{class:"mr-2 h-4 w-4"}),e[15]||(e[15]=c(" Enviar Postulación "))]),_:1},8,["disabled"])])):_("",!0)]),_:1}),E.value?(l(),P(o(O),{key:0,value:"resumen",class:"space-y-4"},{default:r(()=>[t(o(k),null,{default:r(()=>[t(o(w),null,{default:r(()=>[t(o($),null,{default:r(()=>e[16]||(e[16]=[c("Estado de la Postulación")])),_:1})]),_:1}),t(o(h),{class:"space-y-4"},{default:r(()=>[s("div",Qa,[e[17]||(e[17]=s("span",{class:"text-muted-foreground"},"Estado:",-1)),t(o(z),{class:b(a.postulacion.estado==="aceptada"?"bg-green-100 text-green-800":a.postulacion.estado==="rechazada"?"bg-red-100 text-red-800":"bg-blue-100 text-blue-800")},{default:r(()=>[c(n(a.postulacion.estado_label),1)]),_:1},8,["class"])]),s("div",Ya,[e[18]||(e[18]=s("span",{class:"text-muted-foreground"},"Perfil vinculado:",-1)),s("span",null,n(y.value?"Sí":"No"),1)])]),_:1})]),_:1}),t(o(k),null,{default:r(()=>[t(o(w),null,{default:r(()=>[t(o($),null,{default:r(()=>e[19]||(e[19]=[c("Respuestas del Formulario")])),_:1})]),_:1}),t(o(h),{class:"space-y-3"},{default:r(()=>[(l(!0),u(G,null,fa(sa.value,(i,m)=>(l(),u("div",{key:m,class:"flex justify-between"},[s("span",Za,n(m)+":",1),s("span",ae,n(i),1)]))),128))]),_:1})]),_:1}),y.value?(l(),P(o(k),{key:0},{default:r(()=>[t(o(w),null,{default:r(()=>[t(o($),{class:"flex items-center gap-2"},{default:r(()=>[t(o(ga),{class:"h-5 w-5"}),e[20]||(e[20]=c(" Perfil de Candidatura Vinculado "))]),_:1})]),_:1}),t(o(h),{class:"space-y-3"},{default:r(()=>[s("div",ee,[s("div",null,[e[21]||(e[21]=s("span",{class:"text-muted-foreground"},"Usuario:",-1)),s("p",oe,n(y.value.usuario),1)]),s("div",null,[e[22]||(e[22]=s("span",{class:"text-muted-foreground"},"Versión:",-1)),s("p",se,"v"+n(y.value.version),1)]),s("div",null,[e[23]||(e[23]=s("span",{class:"text-muted-foreground"},"Fecha aprobación:",-1)),s("p",te,n(y.value.fecha_aprobacion),1)]),s("div",null,[e[24]||(e[24]=s("span",{class:"text-muted-foreground"},"Aprobado por:",-1)),s("p",re,n(y.value.aprobado_por),1)])])]),_:1})]),_:1})):_("",!0)]),_:1})):_("",!0)]),_:1})])])]),_:1})],64))}});export{Be as default};
