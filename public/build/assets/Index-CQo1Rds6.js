import{_ as N,a as R,b as M,c as U,d as W,e as O}from"./DialogTitle.vue_vue_type_script_setup_true_lang-keujMKwJ.js";import{_ as p}from"./createLucideIcon-xPfym20I.js";import{_ as c,c as m,F as V,a as F,b as S}from"./index-v0X4dJtb.js";import{a as X}from"./Label.vue_vue_type_script_setup_true_lang-ZtqQUjfr.js";import{_ as q,a as G,b as T,c as u,d as J,e as f}from"./TableHeader.vue_vue_type_script_setup_true_lang-BTf4uMaO.js";import{_ as K}from"./AppLayout.vue_vue_type_script_setup_true_lang-DbJ5w6pd.js";import{d as Q,k as B,a as _,o as d,b as t,u as e,m as Y,e as s,f as o,t as i,g as r,F as g,r as h,j as v,i as Z,n as ee,l as te,v as se,W as $}from"./app-DxMxyGIi.js";import{A as le}from"./arrow-left-D9MtFtFW.js";import{C as E}from"./circle-check-big-D8tIv9Ex.js";import{C as w}from"./clock-gmHfGU0E.js";import{C as I}from"./circle-x-iRAZ78kd.js";import{S as ae}from"./search-B_OCZyDU.js";import{E as oe}from"./eye-omRsoUsM.js";import"./VisuallyHidden-BBnR0lPC.js";import"./index-jh-0-z8Q.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-BQ8AGSZc.js";const ne={class:"flex h-full flex-1 flex-col gap-6 rounded-xl p-4"},re={class:"flex items-center justify-between"},ie={class:"text-muted-foreground"},de={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},ue={class:"flex items-center space-x-2"},fe={class:"text-2xl font-bold"},ce={class:"flex items-center space-x-2"},me={class:"text-2xl font-bold text-green-600"},_e={class:"flex items-center space-x-2"},pe={class:"text-2xl font-bold text-blue-600"},ge={class:"flex items-center space-x-2"},ve={class:"text-2xl font-bold text-red-600"},xe={class:"flex gap-4"},be={class:"flex-1"},he={class:"relative"},$e={class:"w-48"},we={key:0,class:"text-center py-8 text-muted-foreground"},ye={class:"flex items-center gap-2"},Ce={class:"w-20 bg-gray-200 rounded-full h-2"},ke={class:"text-xs text-muted-foreground"},Ve={class:"text-sm"},Fe={key:2,class:"mt-4 flex justify-center"},Se={class:"flex gap-2"},Oe=Q({__name:"Index",props:{votacion:{},imports:{}},setup(P){const x=P,y=B(""),C=B("all"),A=[{title:"Admin",href:"/admin/dashboard"},{title:"Votaciones",href:"/admin/votaciones"},{title:x.votacion.titulo,href:`/admin/votaciones/${x.votacion.id}/edit`},{title:"Historial de Importaciones",href:"#"}],j=[{value:"all",label:"Todos"},{value:"pending",label:"Pendientes"},{value:"processing",label:"Procesando"},{value:"completed",label:"Completadas"},{value:"failed",label:"Fallidas"}],b=n=>{switch(n){case"pending":return{icon:w,label:"Pendiente",class:"bg-yellow-100 text-yellow-800 border-yellow-300"};case"processing":return{icon:w,label:"Procesando",class:"bg-blue-100 text-blue-800 border-blue-300"};case"completed":return{icon:E,label:"Completada",class:"bg-green-100 text-green-800 border-green-300"};case"failed":return{icon:I,label:"Fallida",class:"bg-red-100 text-red-800 border-red-300"}}},k=()=>{$.get(`/admin/votaciones/${x.votacion.id}/edit`)},z=n=>{$.get(`/admin/imports/${n}`)},D=n=>new Date(n).toLocaleString("es-ES",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),H=n=>{if(n.status==="pending")return"En cola";if(n.status==="processing")return`${n.processed_rows}/${n.total_rows} procesados`;if(n.status==="failed")return"Falló durante procesamiento";const l=[];return n.successful_rows>0&&l.push(`${n.successful_rows} exitosos`),n.failed_rows>0&&l.push(`${n.failed_rows} errores`),l.join(", ")||"Sin datos"};return(n,l)=>(d(),_(g,null,[t(e(Y),{title:"Historial de Importaciones"}),t(K,{breadcrumbs:A},{default:s(()=>[o("div",ne,[o("div",re,[o("div",null,[l[2]||(l[2]=o("h1",{class:"text-3xl font-bold"},"Historial de Importaciones",-1)),o("p",ie," Votación: "+i(n.votacion.titulo),1)]),t(e(p),{variant:"outline",onClick:k},{default:s(()=>[t(e(le),{class:"mr-2 h-4 w-4"}),l[3]||(l[3]=r(" Volver a Votación "))]),_:1})]),o("div",de,[t(e(c),null,{default:s(()=>[t(e(m),{class:"pt-6"},{default:s(()=>[o("div",ue,[t(e(V),{class:"h-5 w-5 text-muted-foreground"}),o("div",null,[o("p",fe,i(n.imports.total),1),l[4]||(l[4]=o("p",{class:"text-xs text-muted-foreground"},"Total Importaciones",-1))])])]),_:1})]),_:1}),t(e(c),null,{default:s(()=>[t(e(m),{class:"pt-6"},{default:s(()=>[o("div",ce,[t(e(E),{class:"h-5 w-5 text-green-600"}),o("div",null,[o("p",me,i(n.imports.data.filter(a=>a.status==="completed").length),1),l[5]||(l[5]=o("p",{class:"text-xs text-muted-foreground"},"Completadas",-1))])])]),_:1})]),_:1}),t(e(c),null,{default:s(()=>[t(e(m),{class:"pt-6"},{default:s(()=>[o("div",_e,[t(e(w),{class:"h-5 w-5 text-blue-600"}),o("div",null,[o("p",pe,i(n.imports.data.filter(a=>["pending","processing"].includes(a.status)).length),1),l[6]||(l[6]=o("p",{class:"text-xs text-muted-foreground"},"Activas",-1))])])]),_:1})]),_:1}),t(e(c),null,{default:s(()=>[t(e(m),{class:"pt-6"},{default:s(()=>[o("div",ge,[t(e(I),{class:"h-5 w-5 text-red-600"}),o("div",null,[o("p",ve,i(n.imports.data.filter(a=>a.status==="failed").length),1),l[7]||(l[7]=o("p",{class:"text-xs text-muted-foreground"},"Fallidas",-1))])])]),_:1})]),_:1})]),t(e(c),null,{default:s(()=>[t(e(F),null,{default:s(()=>[t(e(S),null,{default:s(()=>l[8]||(l[8]=[r("Filtros")])),_:1})]),_:1}),t(e(m),null,{default:s(()=>[o("div",xe,[o("div",be,[o("div",he,[t(e(ae),{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),t(e(X),{modelValue:y.value,"onUpdate:modelValue":l[0]||(l[0]=a=>y.value=a),placeholder:"Buscar por nombre de archivo...",class:"pl-9"},null,8,["modelValue"])])]),o("div",$e,[t(e(N),{modelValue:C.value,"onUpdate:modelValue":l[1]||(l[1]=a=>C.value=a)},{default:s(()=>[t(e(R),null,{default:s(()=>[t(e(M),{placeholder:"Estado"})]),_:1}),t(e(U),null,{default:s(()=>[(d(),_(g,null,h(j,a=>t(e(W),{key:a.value,value:a.value},{default:s(()=>[r(i(a.label),1)]),_:2},1032,["value"])),64))]),_:1})]),_:1},8,["modelValue"])])])]),_:1})]),_:1}),t(e(c),null,{default:s(()=>[t(e(F),null,{default:s(()=>[t(e(S),null,{default:s(()=>[r("Importaciones ("+i(n.imports.total)+")",1)]),_:1})]),_:1}),t(e(m),null,{default:s(()=>[n.imports.data.length===0?(d(),_("div",we,[t(e(V),{class:"mx-auto h-12 w-12 mb-4"}),l[10]||(l[10]=o("p",null,"No hay importaciones registradas para esta votación",-1)),t(e(p),{variant:"outline",class:"mt-4",onClick:k},{default:s(()=>l[9]||(l[9]=[r(" Realizar Primera Importación ")])),_:1})])):(d(),v(e(q),{key:1},{default:s(()=>[t(e(G),null,{default:s(()=>[t(e(T),null,{default:s(()=>[t(e(u),null,{default:s(()=>l[11]||(l[11]=[r("Archivo")])),_:1}),t(e(u),null,{default:s(()=>l[12]||(l[12]=[r("Estado")])),_:1}),t(e(u),null,{default:s(()=>l[13]||(l[13]=[r("Progreso")])),_:1}),t(e(u),null,{default:s(()=>l[14]||(l[14]=[r("Resultados")])),_:1}),t(e(u),null,{default:s(()=>l[15]||(l[15]=[r("Creado por")])),_:1}),t(e(u),null,{default:s(()=>l[16]||(l[16]=[r("Fecha")])),_:1}),t(e(u),null,{default:s(()=>l[17]||(l[17]=[r("Duración")])),_:1}),t(e(u),{class:"text-right"},{default:s(()=>l[18]||(l[18]=[r("Acciones")])),_:1})]),_:1})]),_:1}),t(e(J),null,{default:s(()=>[(d(!0),_(g,null,h(n.imports.data,a=>(d(),v(e(T),{key:a.id},{default:s(()=>[t(e(f),{class:"font-medium"},{default:s(()=>[r(i(a.original_filename),1)]),_:2},1024),t(e(f),null,{default:s(()=>[t(e(O),{class:ee(b(a.status).class)},{default:s(()=>[(d(),v(te(b(a.status).icon),{class:"mr-1 h-3 w-3"})),r(" "+i(b(a.status).label),1)]),_:2},1032,["class"])]),_:2},1024),t(e(f),null,{default:s(()=>[o("div",ye,[o("div",Ce,[o("div",{class:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:se({width:`${a.progress_percentage}%`})},null,4)]),o("span",ke,i(a.progress_percentage)+"% ",1)])]),_:2},1024),t(e(f),null,{default:s(()=>[o("div",Ve,i(H(a)),1)]),_:2},1024),t(e(f),null,{default:s(()=>[r(i(a.created_by.name),1)]),_:2},1024),t(e(f),null,{default:s(()=>[r(i(D(a.created_at)),1)]),_:2},1024),t(e(f),null,{default:s(()=>[r(i(a.duration||"-"),1)]),_:2},1024),t(e(f),{class:"text-right"},{default:s(()=>[t(e(p),{variant:"ghost",size:"sm",onClick:L=>z(a.id)},{default:s(()=>[t(e(oe),{class:"h-4 w-4"})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})),n.imports.last_page>1?(d(),_("div",Fe,[o("div",Se,[(d(!0),_(g,null,h(n.imports.links,a=>(d(),v(e(p),{key:a.label,variant:a.active?"default":"outline",size:"sm",disabled:!a.url,onClick:L=>a.url&&e($).get(a.url),innerHTML:a.label},null,8,["variant","disabled","onClick","innerHTML"]))),128))])])):Z("",!0)]),_:1})]),_:1})])]),_:1})],64))}});export{Oe as default};
