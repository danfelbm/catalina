import{k as T,q as G,d as Z,c as I,a as d,o,f as b,b as m,i as c,u as n,e as v,g as x,t as p,n as W,F as z,r as N,j as M,h as J,v as re,w as X}from"./app-DaeX7cdw.js";import{c as ae,_ as j}from"./createLucideIcon-CjSnWMAs.js";import{_ as K,c as se,a as ne}from"./index-11KoE7K9.js";import{_ as U,a as H}from"./Label.vue_vue_type_script_setup_true_lang-CMHm9R99.js";import{U as ie}from"./upload-DUVKB5_L.js";import{E as de}from"./eye-C_jNXRru.js";import{D as ue}from"./download-DY1DMKCt.js";import{X as Q,C as ce,f as me,g as pe,h as fe,i as ve,j as he,k as ye,_ as be,a as _e,b as ke,c as $e,d as ge}from"./DialogTitle.vue_vue_type_script_setup_true_lang-D_nilgK0.js";import{_ as le}from"./Checkbox.vue_vue_type_script_setup_true_lang-ChzN2Ctw.js";import{_ as xe}from"./Textarea.vue_vue_type_script_setup_true_lang-Cnx2cgaS.js";import{P as we}from"./plus-BJOEnpvP.js";import{T as Fe}from"./trash-2-EKkXpNpQ.js";/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=ae("FileIcon",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const De=ae("GripVerticalIcon",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]);function Ce(){const F=T(!1),C=T({}),u=T(new Map);return{isUploading:F,uploadProgress:C,uploadErrors:u,uploadFiles:async(f,e)=>{var t,i;F.value=!0,u.value.clear();const s=new FormData;f.forEach(r=>{s.append("files[]",r)}),s.append("module",e.module),s.append("field_id",e.fieldId);try{const r=await G.post("/api/files/upload",s,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:$=>{if($.total){const a=Math.round($.loaded*100/$.total);f.forEach(g=>{C.value[g.name]=a,e.onProgress&&e.onProgress(g.name,a)})}}});if(r.data.success)return e.onSuccess&&e.onSuccess(r.data.files),r.data.files;throw new Error(r.data.message||"Error al subir archivos")}catch(r){const $=((i=(t=r.response)==null?void 0:t.data)==null?void 0:i.message)||r.message||"Error desconocido al subir archivos";throw f.forEach(a=>{u.value.set(a.name,$)}),e.onError&&e.onError(r),r}finally{F.value=!1,setTimeout(()=>{C.value={}},2e3)}},deleteFile:async f=>{try{return(await G.delete("/api/files/delete",{data:{path:f}})).data.success}catch(e){return console.error("Error al eliminar archivo:",e),!1}},downloadFile:async(f,e)=>{try{const s=await G.get("/api/files/download",{params:{path:f},responseType:"blob"}),t=window.URL.createObjectURL(new Blob([s.data])),i=document.createElement("a");i.href=t,i.setAttribute("download",e||f.split("/").pop()||"archivo"),document.body.appendChild(i),i.click(),i.remove(),window.URL.revokeObjectURL(t)}catch(s){throw console.error("Error al descargar archivo:",s),s}},getFileInfo:async f=>{try{const e=await G.get("/api/files/info",{params:{path:f}});return e.data.success?e.data.file:null}catch(e){return console.error("Error al obtener información del archivo:",e),null}},validateFileType:(f,e)=>{var i;const s=e.split(",").map(r=>r.trim().toLowerCase()),t="."+((i=f.name.split(".").pop())==null?void 0:i.toLowerCase());return s.some(r=>r===t)},validateFileSize:(f,e)=>{const s=e*1024*1024;return f.size<=s},formatFileSize:f=>{if(f===0)return"0 Bytes";const e=1024,s=["Bytes","KB","MB","GB"],t=Math.floor(Math.log(f)/Math.log(e));return Math.round(f/Math.pow(e,t)*100)/100+" "+s[t]}}}const Se={class:"space-y-2"},Ae={key:0,class:"text-red-500 ml-1"},Me={key:0,class:"text-sm text-muted-foreground"},Ee={class:"flex flex-col items-center justify-center text-center"},Be={class:"text-sm font-medium mb-1"},Ue={class:"text-xs text-muted-foreground"},ze=["multiple","accept","disabled"],Te={key:0,class:"space-y-2"},Ie={class:"space-y-2"},Ve={class:"flex items-center justify-between"},qe={class:"flex items-center space-x-3 flex-1"},je={class:"min-w-0 flex-1"},Pe={class:"text-sm font-medium truncate"},Le={key:0,class:"text-xs text-muted-foreground"},Re={class:"flex items-center space-x-2"},Ye={key:1,class:"space-y-2"},Ne={class:"space-y-2"},He={class:"space-y-2"},Oe={class:"flex items-center justify-between"},Ge={class:"flex items-center space-x-3 flex-1"},Ke=["src","alt"],We={class:"min-w-0 flex-1"},Xe={class:"text-sm font-medium truncate"},Ze={class:"text-xs text-muted-foreground"},Je={key:0,class:"w-full"},Qe={class:"w-full bg-gray-200 rounded-full h-1.5"},et={key:1,class:"text-xs text-red-600"},tt={key:2,class:"text-sm text-red-600"},at={key:3,class:"text-xs text-muted-foreground"},st={key:0},ra=Z({__name:"FileUploadField",props:{modelValue:{},label:{},description:{},required:{type:Boolean,default:!1},multiple:{type:Boolean,default:!1},maxFiles:{default:5},maxFileSize:{default:10},accept:{default:".pdf,.doc,.docx,.xls,.xlsx,.jpg,.jpeg,.png,.gif"},error:{},disabled:{type:Boolean,default:!1},showPreview:{type:Boolean,default:!0},module:{default:"postulaciones"},fieldId:{default:"file"},autoUpload:{type:Boolean,default:!0}},emits:["update:modelValue","filesSelected"],setup(F,{expose:C,emit:u}){const y=F,h=u,{isUploading:k,uploadFiles:E,deleteFile:V,formatFileSize:D}=Ce(),q=T(),f=T([]),e=T(new Map),s=T(new Map),t=T(new Map),i=I(()=>y.modelValue?y.modelValue.length>0&&typeof y.modelValue[0]=="string"?y.modelValue.map((l,w)=>({id:`existing_${w}`,name:l.split("/").pop()||"archivo",size:0,path:l,url:`/storage/${l}`})):y.modelValue:[]),r=I(()=>{const l=i.value.length+f.value.length;return y.multiple?l<y.maxFiles:l===0}),$=I(()=>y.accept.split(",").map(l=>l.trim().toLowerCase())),a=()=>{var l;!y.disabled&&r.value&&((l=q.value)==null||l.click())},g=l=>{var _;const w="."+((_=l.name.split(".").pop())==null?void 0:_.toLowerCase());return $.value.some(S=>S===w)},B=l=>{const w=y.maxFileSize*1024*1024;return l.size<=w},R=async l=>{const w=l.target,_=Array.from(w.files||[]);t.value.clear();const S=[];if(_.forEach(A=>{if(!g(A)){t.value.set(A.name,`Tipo de archivo no permitido. Solo se permiten: ${y.accept}`);return}if(!B(A)){t.value.set(A.name,`El archivo excede el tamaño máximo de ${y.maxFileSize}MB`);return}const Y=i.value.length+S.length;if(y.multiple&&Y>=y.maxFiles){t.value.set(A.name,`Se ha alcanzado el límite de ${y.maxFiles} archivos`);return}if(S.push(A),A.type.startsWith("image/")&&y.showPreview){const L=new FileReader;L.onload=oe=>{var ee;e.value.set(A.name,(ee=oe.target)==null?void 0:ee.result)},L.readAsDataURL(A)}}),y.multiple?f.value=[...f.value,...S]:f.value=S.slice(0,1),S.length>0&&(h("filesSelected",S),y.autoUpload&&y.module&&y.fieldId))try{const A=await E(S,{module:y.module,fieldId:y.fieldId,onProgress:(Y,L)=>{s.value.set(Y,L)},onSuccess:Y=>{const L=[...i.value,...Y];h("update:modelValue",L),f.value=[],e.value.clear()},onError:Y=>{console.error("Error al subir archivos:",Y),S.forEach(L=>{t.value.set(L.name,"Error al subir el archivo")})}})}catch(A){console.error("Error en carga automática:",A)}w.value=""},P=l=>{const w=f.value[l];e.value.delete(w.name),s.value.delete(w.name),t.value.delete(w.name),f.value.splice(l,1)},O=async l=>{const w=i.value[l];if(w.path)try{await V(w.path)}catch(S){console.error("Error al eliminar archivo del servidor:",S)}const _=[...i.value];if(_.splice(l,1),typeof y.modelValue[0]=="string"){const S=_.map(A=>A.path).filter(Boolean);h("update:modelValue",S)}else h("update:modelValue",_)};return C({selectedFiles:f,uploadProgress:s,uploadErrors:t}),(l,w)=>(o(),d("div",Se,[b("div",null,[m(n(U),{class:"text-sm font-medium"},{default:v(()=>[x(p(l.label)+" ",1),l.required?(o(),d("span",Ae,"*")):c("",!0)]),_:1}),l.description?(o(),d("p",Me,p(l.description),1)):c("",!0)]),m(n(K),{class:W(["border-2 border-dashed hover:border-primary/50 transition-colors cursor-pointer",{"opacity-50 cursor-not-allowed":l.disabled||!r.value||n(k),"border-red-300":l.error}]),onClick:a},{default:v(()=>[m(n(se),{class:"p-6"},{default:v(()=>[b("div",Ee,[m(n(ie),{class:"h-10 w-10 text-muted-foreground mb-3"}),b("p",Be,p(n(k)?"Subiendo archivos...":r.value?"Haz clic para seleccionar archivos":"Límite de archivos alcanzado"),1),b("p",Ue,p(l.multiple?`Hasta ${l.maxFiles} archivos`:"Un archivo")+" • Máx. "+p(l.maxFileSize)+"MB • Formatos: "+p(l.accept),1)])]),_:1})]),_:1},8,["class"]),b("input",{ref_key:"fileInputRef",ref:q,type:"file",multiple:l.multiple,accept:l.accept,disabled:l.disabled||!r.value||n(k),onChange:R,class:"hidden"},null,40,ze),i.value.length>0?(o(),d("div",Te,[m(n(U),{class:"text-xs text-muted-foreground"},{default:v(()=>w[0]||(w[0]=[x("Archivos cargados:")])),_:1}),b("div",Ie,[(o(!0),d(z,null,N(i.value,(_,S)=>(o(),M(n(K),{key:_.id,class:"p-3"},{default:v(()=>[b("div",Ve,[b("div",qe,[m(n(te),{class:"h-5 w-5 text-muted-foreground flex-shrink-0"}),b("div",je,[b("p",Pe,p(_.name),1),_.size>0?(o(),d("p",Le,p(n(D)(_.size)),1)):c("",!0)])]),b("div",Re,[_.url?(o(),M(n(j),{key:0,type:"button",variant:"ghost",size:"sm",onClick:J(A=>l.window.open(_.url,"_blank"),["stop"])},{default:v(()=>[m(n(de),{class:"h-4 w-4"})]),_:2},1032,["onClick"])):c("",!0),_.url?(o(),M(n(j),{key:1,type:"button",variant:"ghost",size:"sm",onClick:J(A=>l.window.open(_.url+"?download=true","_blank"),["stop"])},{default:v(()=>[m(n(ue),{class:"h-4 w-4"})]),_:2},1032,["onClick"])):c("",!0),l.disabled?c("",!0):(o(),M(n(j),{key:2,type:"button",variant:"ghost",size:"sm",onClick:J(A=>O(S),["stop"])},{default:v(()=>[m(n(Q),{class:"h-4 w-4 text-destructive"})]),_:2},1032,["onClick"]))])])]),_:2},1024))),128))])])):c("",!0),f.value.length>0?(o(),d("div",Ye,[m(n(U),{class:"text-xs text-muted-foreground"},{default:v(()=>w[1]||(w[1]=[x("Archivos pendientes de carga:")])),_:1}),b("div",Ne,[(o(!0),d(z,null,N(f.value,(_,S)=>(o(),M(n(K),{key:_.name,class:W(["p-3",{"border-red-300":t.value.has(_.name)}])},{default:v(()=>[b("div",He,[b("div",Oe,[b("div",Ge,[e.value.has(_.name)&&l.showPreview?(o(),d("img",{key:0,src:e.value.get(_.name),alt:_.name,class:"h-10 w-10 object-cover rounded flex-shrink-0"},null,8,Ke)):(o(),M(n(te),{key:1,class:"h-5 w-5 text-muted-foreground flex-shrink-0"})),b("div",We,[b("p",Xe,p(_.name),1),b("p",Ze,p(n(D)(_.size)),1)])]),l.disabled?c("",!0):(o(),M(n(j),{key:0,type:"button",variant:"ghost",size:"sm",onClick:A=>P(S)},{default:v(()=>[m(n(Q),{class:"h-4 w-4 text-destructive"})]),_:2},1032,["onClick"]))]),s.value.has(_.name)?(o(),d("div",Je,[b("div",Qe,[b("div",{class:"bg-primary h-1.5 rounded-full transition-all duration-300",style:re({width:`${s.value.get(_.name)}%`})},null,4)])])):c("",!0),t.value.has(_.name)?(o(),d("p",et,p(t.value.get(_.name)),1)):c("",!0)])]),_:2},1032,["class"]))),128))])])):c("",!0),l.error?(o(),d("p",tt,p(l.error),1)):c("",!0),!l.disabled&&r.value?(o(),d("div",at,[l.multiple?(o(),d("p",st,p(i.value.length+f.value.length)+" de "+p(l.maxFiles)+" archivos ",1)):c("",!0)])):c("",!0)]))}}),lt={class:"space-y-2"},ot={key:0,class:"text-red-500 ml-1"},rt={key:1,class:"text-sm text-muted-foreground"},nt={class:"relative"},it={class:"flex gap-2"},dt={class:"flex-1 relative"},ut={key:0,class:"text-xs text-muted-foreground mt-1"},ct=["id"],mt={key:3,class:"text-xs text-muted-foreground space-y-1"},pt={key:0},ft={key:1},vt={key:2},ht={key:3},yt=Z({__name:"DatePickerField",props:{modelValue:{},label:{},description:{},required:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},error:{},minDate:{},maxDate:{},format:{default:"DD/MM/YYYY"},allowPastDates:{type:Boolean,default:!0},allowFutureDates:{type:Boolean,default:!0}},emits:["update:modelValue"],setup(F,{emit:C}){const u=F,y=C,h=I({get:()=>{if(!u.modelValue)return"";let e;if(u.modelValue instanceof Date?e=u.modelValue:e=new Date(u.modelValue),isNaN(e.getTime()))return"";const s=e.getFullYear(),t=String(e.getMonth()+1).padStart(2,"0"),i=String(e.getDate()).padStart(2,"0");return`${s}-${t}-${i}`},set:e=>{if(!e){y("update:modelValue",null);return}const s=new Date(e),t=new Date;t.setHours(0,0,0,0),s.setHours(0,0,0,0),!(!u.allowPastDates&&s<t)&&(!u.allowFutureDates&&s>t||y("update:modelValue",e))}}),k=I(()=>u.minDate?u.minDate:u.allowPastDates?"":new Date().toISOString().split("T")[0]),E=I(()=>u.maxDate?u.maxDate:u.allowFutureDates?"":new Date().toISOString().split("T")[0]),V=e=>{if(!e)return"";try{const[s,t,i]=e.split("-");return u.format==="DD/MM/YYYY"?`${i}/${t}/${s}`:e}catch(s){return console.error("Error al formatear fecha:",s),e}},D=I(()=>h.value?V(h.value):""),q=()=>{y("update:modelValue",null)},f=`datepicker-${Math.random().toString(36).substr(2,9)}`;return(e,s)=>(o(),d("div",lt,[e.label?(o(),M(n(U),{key:0,for:f,class:"text-sm font-medium"},{default:v(()=>[x(p(e.label)+" ",1),e.required?(o(),d("span",ot,"*")):c("",!0)]),_:1})):c("",!0),e.description?(o(),d("p",rt,p(e.description),1)):c("",!0),b("div",nt,[b("div",it,[b("div",dt,[m(n(H),{id:f,type:"date",modelValue:h.value,"onUpdate:modelValue":s[0]||(s[0]=t=>h.value=t),disabled:e.disabled,min:k.value,max:E.value,class:W(["w-full",e.error?"border-red-300 focus:border-red-500":""]),"aria-invalid":!!e.error,"aria-describedby":e.error?`${f}-error`:void 0},null,8,["modelValue","disabled","min","max","class","aria-invalid","aria-describedby"]),m(n(ce),{class:"absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground pointer-events-none"})]),!e.required&&h.value?(o(),M(n(j),{key:0,type:"button",variant:"outline",size:"icon",onClick:q,disabled:e.disabled,title:"Limpiar fecha"},{default:v(()=>[m(n(Q),{class:"h-4 w-4"})]),_:1},8,["disabled"])):c("",!0)]),D.value&&e.format!=="YYYY-MM-DD"?(o(),d("p",ut," Fecha seleccionada: "+p(D.value),1)):c("",!0)]),e.error?(o(),d("p",{key:2,id:`${f}-error`,class:"text-sm text-red-600"},p(e.error),9,ct)):c("",!0),!e.allowPastDates||!e.allowFutureDates||e.minDate||e.maxDate?(o(),d("div",mt,[!e.allowPastDates&&!e.minDate?(o(),d("p",pt," * No se permiten fechas pasadas ")):c("",!0),!e.allowFutureDates&&!e.maxDate?(o(),d("p",ft," * No se permiten fechas futuras ")):c("",!0),e.minDate?(o(),d("p",vt," * Fecha mínima: "+p(V(e.minDate)),1)):c("",!0),e.maxDate?(o(),d("p",ht," * Fecha máxima: "+p(V(e.maxDate)),1)):c("",!0)])):c("",!0)]))}}),bt={class:"space-y-2"},_t={class:"flex items-start space-x-3"},kt={class:"flex-1 space-y-1"},$t={key:0,class:"text-red-500 ml-1"},gt={key:0,class:"text-sm text-muted-foreground"},xt={key:1,class:"text-xs text-green-600"},wt=["id"],Ft={class:"my-6 p-4 bg-gray-50 dark:bg-gray-900 rounded-lg border border-gray-200 dark:border-gray-700"},Dt=["innerHTML"],na=Z({__name:"DisclaimerField",props:{modelValue:{type:[Boolean,Object,null]},label:{},description:{},required:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},error:{},disclaimerText:{},modalTitle:{default:"Términos y Condiciones"},acceptButtonText:{default:"Acepto"},declineButtonText:{default:"No acepto"}},emits:["update:modelValue"],setup(F,{emit:C}){const u=F,y=C,h=T(!1),k=T(!1),E=T(null);u.modelValue&&(typeof u.modelValue=="boolean"?k.value=u.modelValue:typeof u.modelValue=="object"&&u.modelValue.accepted&&(k.value=u.modelValue.accepted,E.value=u.modelValue.timestamp||null)),X(()=>u.modelValue,s=>{s?typeof s=="boolean"?k.value=s:typeof s=="object"&&s.accepted!==void 0&&(k.value=s.accepted,E.value=s.timestamp||null):(k.value=!1,E.value=null)});const V=s=>{s&&!k.value&&!u.disabled?h.value=!0:s||q()},D=()=>{k.value=!0,E.value=new Date().toISOString(),y("update:modelValue",{accepted:!0,timestamp:E.value}),h.value=!1},q=()=>{k.value=!1,E.value=null,y("update:modelValue",null),h.value=!1},f=`disclaimer-${Math.random().toString(36).substr(2,9)}`,e=s=>new Date(s).toLocaleString("es-CO",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"});return(s,t)=>(o(),d("div",bt,[b("div",_t,[m(n(le),{id:f,checked:k.value,"onUpdate:checked":V,disabled:s.disabled,"aria-invalid":!!s.error,"aria-describedby":s.error?`${f}-error`:void 0,class:"mt-1"},null,8,["checked","disabled","aria-invalid","aria-describedby"]),b("div",kt,[m(n(U),{for:f,class:"text-sm font-medium cursor-pointer leading-relaxed",onClick:t[0]||(t[0]=()=>!s.disabled&&!k.value&&(h.value=!0))},{default:v(()=>[x(p(s.label)+" ",1),s.required?(o(),d("span",$t,"*")):c("",!0)]),_:1}),s.description?(o(),d("p",gt,p(s.description),1)):c("",!0),k.value&&E.value?(o(),d("p",xt," ✓ Aceptado el "+p(e(E.value)),1)):c("",!0),s.disabled?c("",!0):(o(),d("button",{key:2,type:"button",onClick:t[1]||(t[1]=i=>h.value=!0),class:"text-xs text-blue-600 hover:text-blue-800 underline"},p(k.value?"Ver términos aceptados":"Leer términos y condiciones"),1))])]),s.error?(o(),d("p",{key:0,id:`${f}-error`,class:"text-sm text-red-600 ml-6"},p(s.error),9,wt)):c("",!0),m(n(me),{open:h.value,"onUpdate:open":t[3]||(t[3]=i=>h.value=i)},{default:v(()=>[m(n(pe),{class:"max-w-2xl max-h-[80vh] overflow-y-auto"},{default:v(()=>[m(n(fe),null,{default:v(()=>[m(n(ve),null,{default:v(()=>[x(p(s.modalTitle),1)]),_:1}),m(n(he),null,{default:v(()=>t[4]||(t[4]=[x(" Por favor, lea atentamente los siguientes términos y condiciones: ")])),_:1})]),_:1}),b("div",Ft,[b("div",{class:"prose prose-sm dark:prose-invert max-w-none whitespace-pre-wrap",innerHTML:s.disclaimerText},null,8,Dt)]),m(n(ye),{class:"flex gap-2 sm:gap-0"},{default:v(()=>[!k.value||!s.disabled?(o(),M(n(j),{key:0,type:"button",variant:"outline",onClick:q,disabled:s.disabled},{default:v(()=>[x(p(s.declineButtonText),1)]),_:1},8,["disabled"])):c("",!0),!k.value||!s.disabled?(o(),M(n(j),{key:1,type:"button",onClick:D,disabled:s.disabled},{default:v(()=>[x(p(s.acceptButtonText),1)]),_:1},8,["disabled"])):c("",!0),k.value&&s.disabled?(o(),M(n(j),{key:2,type:"button",variant:"outline",onClick:t[2]||(t[2]=i=>h.value=!1)},{default:v(()=>t[5]||(t[5]=[x(" Cerrar ")])),_:1})):c("",!0)]),_:1})]),_:1})]),_:1},8,["open"])]))}}),Ct={class:"space-y-4"},St={key:0,class:"text-red-500 ml-1"},At={key:0,class:"text-sm text-muted-foreground mt-1"},Mt={key:1,class:"text-xs text-muted-foreground mt-1"},Et={class:"space-y-3"},Bt={class:"flex items-center justify-between"},Ut={class:"flex items-center gap-2"},zt={class:"text-sm font-medium"},Tt={key:0,class:"text-red-500 ml-1"},It={key:0,class:"text-red-500 ml-1"},Vt={key:0,class:"text-red-500 ml-1"},qt={key:0,class:"text-red-500 ml-1"},jt={key:0,class:"text-red-500 ml-1"},Pt={key:0,class:"text-red-500 ml-1"},Lt={key:0,class:"text-red-500 ml-1"},Rt={class:"space-y-2"},Yt=["id","name","value","checked","onChange","disabled"],Nt={key:0,class:"text-red-500 ml-1"},Ht={class:"space-y-2"},Ot={key:1,class:"text-sm text-muted-foreground text-center"},Gt={key:2,class:"text-sm text-red-600"},ia=Z({__name:"RepeaterField",props:{modelValue:{},label:{},description:{},required:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},error:{},minItems:{default:0},maxItems:{default:10},itemName:{default:"Elemento"},addButtonText:{default:"Agregar elemento"},removeButtonText:{default:"Eliminar"},fields:{}},emits:["update:modelValue"],setup(F,{emit:C}){const u=F,y=C,h=T([]);if(u.modelValue&&Array.isArray(u.modelValue))h.value=u.modelValue;else if(u.minItems>0)for(let t=0;t<u.minItems;t++)h.value.push(k());X(()=>u.modelValue,t=>{t&&Array.isArray(t)&&(h.value=t)}),X(h,t=>{y("update:modelValue",t)},{deep:!0});function k(){const t={id:`item-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,data:{}};return u.fields.forEach(i=>{i.type==="checkbox"?t.data[i.id]=[]:i.type==="repeater"?t.data[i.id]=[]:t.data[i.id]=""}),t}const E=()=>{h.value.length<u.maxItems&&h.value.push(k())},V=t=>{h.value.length>u.minItems&&h.value.splice(t,1)},D=(t,i,r)=>{h.value[t]&&(h.value[t].data[i]=r)},q=(t,i,r,$)=>{const a=h.value[t].data[i]||[];let g;$?g=[...a,r]:g=a.filter(B=>B!==r),D(t,i,g)},f=I(()=>h.value.length<u.maxItems),e=I(()=>h.value.length>u.minItems),s=I(()=>{const t=[];return u.minItems>0&&t.push(`Mínimo ${u.minItems} elemento${u.minItems>1?"s":""}`),u.maxItems<1/0&&t.push(`Máximo ${u.maxItems} elemento${u.maxItems>1?"s":""}`),t.length>0?t.join(" | "):""});return(t,i)=>(o(),d("div",Ct,[b("div",null,[m(n(U),{class:"text-base font-semibold"},{default:v(()=>[x(p(t.label)+" ",1),t.required?(o(),d("span",St,"*")):c("",!0)]),_:1}),t.description?(o(),d("p",At,p(t.description),1)):c("",!0),s.value?(o(),d("p",Mt,p(s.value),1)):c("",!0)]),b("div",Et,[(o(!0),d(z,null,N(h.value,(r,$)=>(o(),M(n(K),{key:r.id,class:W(["relative",[t.disabled?"opacity-60":""]])},{default:v(()=>[m(n(ne),{class:"pb-3"},{default:v(()=>[b("div",Bt,[b("div",Ut,[m(n(De),{class:"h-4 w-4 text-muted-foreground"}),b("span",zt,p(t.itemName)+" "+p($+1),1)]),e.value?(o(),M(n(j),{key:0,type:"button",variant:"ghost",size:"sm",onClick:a=>V($),disabled:t.disabled,class:"h-8 px-2"},{default:v(()=>[m(n(Fe),{class:"h-4 w-4 text-destructive"})]),_:2},1032,["onClick","disabled"])):c("",!0)])]),_:2},1024),m(n(se),{class:"space-y-4"},{default:v(()=>[(o(!0),d(z,null,N(t.fields,a=>{var g,B,R,P,O;return o(),d("div",{key:a.id,class:"space-y-2"},[a.type==="text"?(o(),d(z,{key:0},[m(n(U),{for:`${r.id}-${a.id}`,class:"text-sm"},{default:v(()=>[x(p(a.title)+" ",1),a.required?(o(),d("span",Tt,"*")):c("",!0)]),_:2},1032,["for"]),m(n(H),{id:`${r.id}-${a.id}`,"model-value":r.data[a.id]||"","onUpdate:modelValue":l=>D($,a.id,l),placeholder:a.description,disabled:t.disabled},null,8,["id","model-value","onUpdate:modelValue","placeholder","disabled"])],64)):a.type==="textarea"?(o(),d(z,{key:1},[m(n(U),{for:`${r.id}-${a.id}`,class:"text-sm"},{default:v(()=>[x(p(a.title)+" ",1),a.required?(o(),d("span",It,"*")):c("",!0)]),_:2},1032,["for"]),m(n(xe),{id:`${r.id}-${a.id}`,"model-value":r.data[a.id]||"","onUpdate:modelValue":l=>D($,a.id,l),placeholder:a.description,disabled:t.disabled,rows:"3"},null,8,["id","model-value","onUpdate:modelValue","placeholder","disabled"])],64)):a.type==="number"?(o(),d(z,{key:2},[m(n(U),{for:`${r.id}-${a.id}`,class:"text-sm"},{default:v(()=>[x(p(a.title)+" ",1),a.required?(o(),d("span",Vt,"*")):c("",!0)]),_:2},1032,["for"]),m(n(H),{id:`${r.id}-${a.id}`,type:"number","model-value":r.data[a.id]||"","onUpdate:modelValue":l=>D($,a.id,l),placeholder:a.description,disabled:t.disabled},null,8,["id","model-value","onUpdate:modelValue","placeholder","disabled"])],64)):a.type==="email"?(o(),d(z,{key:3},[m(n(U),{for:`${r.id}-${a.id}`,class:"text-sm"},{default:v(()=>[x(p(a.title)+" ",1),a.required?(o(),d("span",qt,"*")):c("",!0)]),_:2},1032,["for"]),m(n(H),{id:`${r.id}-${a.id}`,type:"email","model-value":r.data[a.id]||"","onUpdate:modelValue":l=>D($,a.id,l),placeholder:"ejemplo@correo.com",disabled:t.disabled},null,8,["id","model-value","onUpdate:modelValue","disabled"])],64)):a.type==="date"?(o(),d(z,{key:4},[m(n(U),{for:`${r.id}-${a.id}`,class:"text-sm"},{default:v(()=>[x(p(a.title)+" ",1),a.required?(o(),d("span",jt,"*")):c("",!0)]),_:2},1032,["for"]),m(n(H),{id:`${r.id}-${a.id}`,type:"date","model-value":r.data[a.id]||"","onUpdate:modelValue":l=>D($,a.id,l),disabled:t.disabled},null,8,["id","model-value","onUpdate:modelValue","disabled"])],64)):a.type==="datepicker"?(o(),M(yt,{key:5,"model-value":r.data[a.id]||null,"onUpdate:modelValue":l=>D($,a.id,l),label:a.title,description:a.description,required:a.required,disabled:t.disabled,minDate:(g=a.datepickerConfig)==null?void 0:g.minDate,maxDate:(B=a.datepickerConfig)==null?void 0:B.maxDate,format:(R=a.datepickerConfig)==null?void 0:R.format,allowPastDates:(P=a.datepickerConfig)==null?void 0:P.allowPastDates,allowFutureDates:(O=a.datepickerConfig)==null?void 0:O.allowFutureDates},null,8,["model-value","onUpdate:modelValue","label","description","required","disabled","minDate","maxDate","format","allowPastDates","allowFutureDates"])):a.type==="select"?(o(),d(z,{key:6},[m(n(U),{for:`${r.id}-${a.id}`,class:"text-sm"},{default:v(()=>[x(p(a.title)+" ",1),a.required?(o(),d("span",Pt,"*")):c("",!0)]),_:2},1032,["for"]),m(n(be),{"model-value":r.data[a.id]||"","onUpdate:modelValue":l=>D($,a.id,l),disabled:t.disabled},{default:v(()=>[m(n(_e),null,{default:v(()=>[m(n(ke),{placeholder:`Seleccionar ${a.title.toLowerCase()}`},null,8,["placeholder"])]),_:2},1024),m(n($e),null,{default:v(()=>[(o(!0),d(z,null,N(a.options,l=>(o(),M(n(ge),{key:l,value:l},{default:v(()=>[x(p(l),1)]),_:2},1032,["value"]))),128))]),_:2},1024)]),_:2},1032,["model-value","onUpdate:modelValue","disabled"])],64)):a.type==="radio"?(o(),d(z,{key:7},[m(n(U),{class:"text-sm"},{default:v(()=>[x(p(a.title)+" ",1),a.required?(o(),d("span",Lt,"*")):c("",!0)]),_:2},1024),b("div",Rt,[(o(!0),d(z,null,N(a.options,l=>(o(),d("div",{key:l,class:"flex items-center space-x-2"},[b("input",{id:`${r.id}-${a.id}-${l}`,type:"radio",name:`${r.id}-${a.id}`,value:l,checked:r.data[a.id]===l,onChange:()=>D($,a.id,l),disabled:t.disabled,class:"h-4 w-4"},null,40,Yt),m(n(U),{for:`${r.id}-${a.id}-${l}`,class:"text-sm font-normal"},{default:v(()=>[x(p(l),1)]),_:2},1032,["for"])]))),128))])],64)):a.type==="checkbox"?(o(),d(z,{key:8},[m(n(U),{class:"text-sm"},{default:v(()=>[x(p(a.title)+" ",1),a.required?(o(),d("span",Nt,"*")):c("",!0)]),_:2},1024),b("div",Ht,[(o(!0),d(z,null,N(a.options,l=>(o(),d("div",{key:l,class:"flex items-center space-x-2"},[m(n(le),{id:`${r.id}-${a.id}-${l}`,checked:(r.data[a.id]||[]).includes(l),"onUpdate:checked":w=>q($,a.id,l,w),disabled:t.disabled},null,8,["id","checked","onUpdate:checked","disabled"]),m(n(U),{for:`${r.id}-${a.id}-${l}`,class:"text-sm font-normal"},{default:v(()=>[x(p(l),1)]),_:2},1032,["for"])]))),128))])],64)):c("",!0)])}),128))]),_:2},1024)]),_:2},1032,["class"]))),128))]),f.value?(o(),M(n(j),{key:0,type:"button",variant:"outline",onClick:E,disabled:t.disabled,class:"w-full"},{default:v(()=>[m(n(we),{class:"h-4 w-4 mr-2"}),x(" "+p(t.addButtonText),1)]),_:1},8,["disabled"])):c("",!0),f.value?c("",!0):(o(),d("p",Ot," Has alcanzado el límite máximo de "+p(t.maxItems)+" elementos ",1)),t.error?(o(),d("p",Gt,p(t.error),1)):c("",!0)]))}});function da(F,C){const u=T(new Map);X(C,()=>{u.value.clear()},{deep:!0});const y=(e,s,t)=>{const i=r=>r==null?"":typeof r=="boolean"?r?"true":"false":String(r);switch(s){case"equals":return Array.isArray(e)&&Array.isArray(t)?e.length===t.length&&e.every(r=>t.includes(r)):i(e)===i(t);case"not_equals":return Array.isArray(e)&&Array.isArray(t)?e.length!==t.length||!e.every(r=>t.includes(r)):i(e)!==i(t);case"contains":return Array.isArray(e)?Array.isArray(t)?t.some(r=>e.includes(r)):e.includes(t):i(e).includes(i(t));case"not_contains":return Array.isArray(e)?Array.isArray(t)?!t.some(r=>e.includes(r)):!e.includes(t):!i(e).includes(i(t));case"is_empty":return Array.isArray(e)?e.length===0:!e||i(e)==="";case"is_not_empty":return Array.isArray(e)?e.length>0:!!e&&i(e)!=="";default:return console.warn(`Operador condicional no soportado: ${s}`),!0}},h=e=>{var a;if(!((a=e.conditionalConfig)!=null&&a.enabled))return!0;const s=e.id;if(u.value.has(s))return u.value.get(s);const{showWhen:t,conditions:i}=e.conditionalConfig;if(!i||i.length===0)return!0;const r=i.map(g=>{const B=C.value[g.fieldId];return y(B,g.operator,g.value)}),$=t==="all"?r.every(g=>g):r.some(g=>g);return u.value.set(s,$),$},k=I(()=>F.value.filter(e=>h(e)));return{evaluateCondition:y,shouldShowField:h,visibleFields:k,getDependentFields:e=>F.value.filter(s=>{var t;return(t=s.conditionalConfig)!=null&&t.enabled?s.conditionalConfig.conditions.some(i=>i.fieldId===e):!1}),validateConditionalRules:e=>{var $;const s=[];if(!(($=e.conditionalConfig)!=null&&$.enabled))return s;e.conditionalConfig.conditions.some(a=>a.fieldId===e.id)&&s.push(`El campo "${e.title}" no puede depender de sí mismo`),e.conditionalConfig.conditions.forEach(a=>{const g=F.value.find(B=>B.id===a.fieldId);g?["select","radio","checkbox"].includes(g.type)||s.push(`El campo "${e.title}" depende de "${g.title}" que no es de tipo select, radio o checkbox`):s.push(`El campo "${e.title}" hace referencia a un campo inexistente: ${a.fieldId}`)});const i=new Set,r=(a,g=[])=>{var R;if(g.includes(a))return s.push(`Referencia circular detectada: ${[...g,a].join(" → ")}`),!0;if(i.has(a))return!1;i.add(a);const B=F.value.find(P=>P.id===a);if(!((R=B==null?void 0:B.conditionalConfig)!=null&&R.enabled))return!1;for(const P of B.conditionalConfig.conditions)r(P.fieldId,[...g,a]);return!1};return r(e.id),s},getAvailableSourceFields:e=>F.value.filter(s=>s.id===e?!1:["select","radio","checkbox"].includes(s.type)),getFieldOptions:e=>{const s=F.value.find(t=>t.id===e);return s?s.options&&s.options.length>0?s.options:s.type==="checkbox"?["checked","unchecked"]:[]:[]},clearHiddenFieldValues:()=>{F.value.forEach(e=>{h(e)||(e.type==="checkbox"?C.value[e.id]=[]:e.type==="repeater"?C.value[e.id]=[]:e.type==="disclaimer"?C.value[e.id]=null:C.value[e.id]="")})},evaluationCache:I(()=>u.value)}}export{ra as _,da as a,yt as b,na as c,ia as d,Ce as u};
