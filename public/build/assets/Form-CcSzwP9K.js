import{d as Pe,k as F,c as w,w as se,p as Le,a as m,o,j as C,i as x,f as l,e as c,b as s,u as e,g as y,t as p,F as S,r as B,q as He,n as A,C as Ke,y as Je,m as Qe,W as Xe,h as Ze,ae as ea,_ as aa,bI as ta,aa as ra,ad as sa}from"./app-C-ljWtfy.js";import{_ as W}from"./createLucideIcon-_oXcxsH_.js";import{_ as H,a as K,c as J,t as $,b as Ue,d as ia}from"./index-C1n5YpSv.js";import{_ as da}from"./Checkbox.vue_vue_type_script_setup_true_lang-D7tWp4m1.js";import{_ as T,a as te}from"./Label.vue_vue_type_script_setup_true_lang-BUmVMQfq.js";import{_ as la}from"./Progress.vue_vue_type_script_setup_true_lang-J3R3u8eg.js";import{l as j,e as qe,C as Fe,U as oa,_ as na,a as ua,b as ca,c as fa,d as ma}from"./DialogTitle.vue_vue_type_script_setup_true_lang-Cap5hEl3.js";import{_ as _a}from"./Textarea.vue_vue_type_script_setup_true_lang-Dq6pp1kI.js";import{u as pa,a as ga,_ as ba,b as va,c as ya,d as xa}from"./useConditionalFields-Ca9-bdBL.js";import{_ as Be}from"./CardDescription.vue_vue_type_script_setup_true_lang-Dy74ld2R.js";import{_ as ha,a as Ne}from"./RadioGroupItem.vue_vue_type_script_setup_true_lang-xsTj8dRk.js";import{a as De,_ as Te}from"./index-Dnb-LG-z.js";import{_ as je}from"./AlertTitle.vue_vue_type_script_setup_true_lang-qYNbsm3O.js";import{M as Y,s as ka,_ as Ca}from"./AppLayout.vue_vue_type_script_setup_true_lang-DrR_52Cc.js";import{u as $a}from"./useAutoSave-5mDKneid.js";import{A as wa}from"./arrow-left-CpNmfABz.js";import{C as re}from"./clock-Cb6qrYV_.js";import{C as ze}from"./circle-check-big-R1DwQvLv.js";import{U as Va}from"./user-Q-m993Fk.js";import{S as Sa}from"./save-DnW2Ecqm.js";import"./index-BfIyhi4o.js";import"./VisuallyHidden-SZsN-sM_.js";import"./upload-DEXAboJi.js";import"./eye-C1Tj_mCC.js";import"./download-D_7q6ctc.js";import"./plus-CEd_Yrfl.js";import"./grip-vertical-DfJmJyer.js";import"./trash-2-BEi92pnC.js";import"./RovingFocusItem-CaM9lr2a.js";import"./VisuallyHiddenInput-BrgKv1qv.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-DK8M-y8i.js";const Aa={class:"space-y-4"},Ea={key:0,class:"text-center py-8"},Ua={key:2,class:"space-y-6"},qa={key:0},Fa={class:"text-sm font-medium text-muted-foreground mb-3"},Ba={class:"space-y-3"},Na={class:"flex items-start gap-3"},Da={class:"flex-1"},Ta={class:"flex items-center justify-between"},ja={class:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm"},za={class:"flex items-center gap-2 text-muted-foreground"},Pa={class:"flex items-center gap-2 text-muted-foreground"},La={class:"flex items-center gap-2 text-muted-foreground"},Ma={key:0,class:"flex items-center gap-2 text-muted-foreground"},Oa={class:"mt-3 text-xs text-muted-foreground"},Ga={key:1},Ra={class:"text-sm font-medium text-muted-foreground mb-3"},Ia={class:"space-y-3"},Wa={class:"flex items-start gap-3"},Ya={class:"flex-1"},Ha={class:"flex items-center justify-between"},Ka={class:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm"},Ja={class:"flex items-center gap-2 text-muted-foreground"},Qa={class:"flex items-center gap-2 text-muted-foreground"},Xa={class:"flex items-center gap-2 text-muted-foreground"},Za={class:"mt-3 text-xs text-muted-foreground"},et={key:4,class:"mt-4 p-3 bg-muted/50 rounded-lg"},at={class:"text-sm text-muted-foreground"},tt=Pe({__name:"ConvocatoriaSelector",props:{modelValue:{},required:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},filtrarPorUbicacion:{type:Boolean,default:!0},showPostulacionWarning:{type:Boolean,default:!0}},emits:["update:modelValue"],setup(Q,{emit:u}){var q;const N=Q,z=u,h=F([]),P=F(!1),d=F(null),k=F((q=N.modelValue)==null?void 0:q.toString()),L=async()=>{P.value=!0,d.value=null;try{const b=await He.get("/api/convocatorias/disponibles",{params:{filtrar_ubicacion:N.filtrarPorUbicacion,incluir_futuras:!0}});h.value=b.data}catch(b){d.value="Error al cargar las convocatorias disponibles",console.error("Error cargando convocatorias:",b)}finally{P.value=!1}},V=w(()=>{const b={abiertas:[],futuras:[]};return h.value.forEach(v=>{v.estado_temporal==="abierta"?b.abiertas.push(v):v.estado_temporal==="futura"&&b.futuras.push(v)}),b}),M=w(()=>h.value.find(b=>b.id===Number(k.value)));se(k,b=>{z("update:modelValue",b?Number(b):void 0)}),se(()=>N.modelValue,b=>{k.value=b==null?void 0:b.toString()});const O=b=>new Date(b).toLocaleDateString("es-CO",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),E=b=>{switch(b){case"abierta":return"bg-green-100 text-green-800";case"futura":return"bg-blue-100 text-blue-800";case"cerrada":return"bg-gray-100 text-gray-800";default:return"bg-yellow-100 text-yellow-800"}},G=b=>{switch(b){case"abierta":return"Abierta";case"futura":return"Próxima";case"cerrada":return"Cerrada";default:return"Borrador"}};return Le(()=>{L()}),(b,v)=>(o(),m("div",Aa,[P.value?(o(),m("div",Ea,v[1]||(v[1]=[l("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"},null,-1),l("p",{class:"mt-2 text-sm text-muted-foreground"},"Cargando convocatorias disponibles...",-1)]))):d.value?(o(),C(e(Te),{key:1,variant:"destructive"},{default:c(()=>[s(e(j),{class:"h-4 w-4"}),s(e(je),null,{default:c(()=>v[2]||(v[2]=[y("Error")])),_:1}),s(e(De),null,{default:c(()=>[y(p(d.value),1)]),_:1})]),_:1})):h.value.length>0?(o(),m("div",Ua,[s(e(ha),{modelValue:k.value,"onUpdate:modelValue":v[0]||(v[0]=_=>k.value=_),disabled:b.disabled},{default:c(()=>[V.value.abiertas.length>0?(o(),m("div",qa,[l("h4",Fa," Convocatorias Abiertas ("+p(V.value.abiertas.length)+") ",1),l("div",Ba,[(o(!0),m(S,null,B(V.value.abiertas,_=>(o(),C(e(H),{key:_.id,class:A(["cursor-pointer hover:shadow-md transition-all duration-200",{"ring-2 ring-primary bg-primary/5 dark:bg-primary/10":k.value===_.id.toString(),"hover:bg-muted/50":k.value!==_.id.toString()}]),onClick:X=>k.value=_.id.toString()},{default:c(()=>[s(e(K),{class:"pb-3"},{default:c(()=>[l("div",Na,[s(e(Ne),{value:_.id.toString(),id:`conv-${_.id}`},null,8,["value","id"]),l("div",Da,[l("div",Ta,[s(e(T),{for:`conv-${_.id}`,class:"text-base font-semibold cursor-pointer"},{default:c(()=>[y(p(_.nombre),1)]),_:2},1032,["for"]),s(e(qe),{class:A(E(_.estado_temporal))},{default:c(()=>[y(p(G(_.estado_temporal)),1)]),_:2},1032,["class"])]),s(e(Be),{class:"mt-1"},{default:c(()=>[y(p(_.descripcion),1)]),_:2},1024)])])]),_:2},1024),s(e(J),{class:"pt-0"},{default:c(()=>[l("div",ja,[l("div",za,[s(e(Y),{class:"h-4 w-4"}),l("span",null,p(_.cargo.nombre),1)]),l("div",Pa,[s(e(Fe),{class:"h-4 w-4"}),l("span",null,p(_.periodo_electoral.nombre),1)]),l("div",La,[s(e(Y),{class:"h-4 w-4"}),l("span",null,p(_.ubicacion),1)]),_.numero_postulaciones!==void 0?(o(),m("div",Ma,[s(e(oa),{class:"h-4 w-4"}),l("span",null,p(_.numero_postulaciones)+" postulaciones",1)])):x("",!0)]),l("div",Oa,[v[3]||(v[3]=l("span",{class:"font-medium"},"Cierre:",-1)),y(" "+p(O(_.fecha_cierre)),1)])]),_:2},1024)]),_:2},1032,["class","onClick"]))),128))])])):x("",!0),V.value.futuras.length>0?(o(),m("div",Ga,[l("h4",Ra," Próximas Convocatorias ("+p(V.value.futuras.length)+") ",1),l("div",Ia,[(o(!0),m(S,null,B(V.value.futuras,_=>(o(),C(e(H),{key:_.id,class:A(["cursor-pointer hover:shadow-md transition-all duration-200 opacity-90",{"ring-2 ring-primary bg-primary/5 dark:bg-primary/10":k.value===_.id.toString(),"hover:bg-muted/50":k.value!==_.id.toString()}]),onClick:X=>k.value=_.id.toString()},{default:c(()=>[s(e(K),{class:"pb-3"},{default:c(()=>[l("div",Wa,[s(e(Ne),{value:_.id.toString(),id:`conv-${_.id}`},null,8,["value","id"]),l("div",Ya,[l("div",Ha,[s(e(T),{for:`conv-${_.id}`,class:"text-base font-semibold cursor-pointer"},{default:c(()=>[y(p(_.nombre),1)]),_:2},1032,["for"]),s(e(qe),{class:A(E(_.estado_temporal))},{default:c(()=>[y(p(G(_.estado_temporal)),1)]),_:2},1032,["class"])]),s(e(Be),{class:"mt-1"},{default:c(()=>[y(p(_.descripcion),1)]),_:2},1024)])])]),_:2},1024),s(e(J),{class:"pt-0"},{default:c(()=>[l("div",Ka,[l("div",Ja,[s(e(Y),{class:"h-4 w-4"}),l("span",null,p(_.cargo.nombre),1)]),l("div",Qa,[s(e(Fe),{class:"h-4 w-4"}),l("span",null,p(_.periodo_electoral.nombre),1)]),l("div",Xa,[s(e(Y),{class:"h-4 w-4"}),l("span",null,p(_.ubicacion),1)])]),l("div",Za,[v[4]||(v[4]=l("span",{class:"font-medium"},"Apertura:",-1)),y(" "+p(O(_.fecha_apertura)),1)])]),_:2},1024)]),_:2},1032,["class","onClick"]))),128))])])):x("",!0)]),_:1},8,["modelValue","disabled"])])):(o(),C(e(Te),{key:3},{default:c(()=>[s(e(j),{class:"h-4 w-4"}),s(e(je),null,{default:c(()=>v[5]||(v[5]=[y("Sin convocatorias disponibles")])),_:1}),s(e(De),null,{default:c(()=>v[6]||(v[6]=[y(" No hay convocatorias disponibles en este momento para tu ubicación. Por favor, intenta más tarde o contacta al administrador. ")])),_:1})]),_:1})),M.value&&!b.disabled?(o(),m("div",et,[v[7]||(v[7]=l("p",{class:"text-sm font-medium"},"Convocatoria seleccionada:",-1)),l("p",at,p(M.value.nombre),1)])):x("",!0)]))}}),rt={class:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4 pb-24"},st={class:"flex items-center justify-between"},it={class:"text-3xl font-bold"},dt={class:"text-muted-foreground"},lt={key:0,class:"flex items-center justify-end gap-2 text-sm text-muted-foreground"},ot={key:0,class:"flex items-center gap-1.5"},nt={key:1,class:"flex items-center gap-1.5"},ut={key:2,class:"flex items-center gap-1.5 text-amber-600"},ct={key:3,class:"flex items-center gap-1.5"},ft={class:"text-blue-700 dark:text-blue-300"},mt={key:0,class:"p-4 bg-blue-50 border border-blue-200 rounded-lg"},_t={class:"flex items-start gap-3"},pt={class:"text-sm text-blue-800"},gt={key:0,class:"mt-1 text-blue-600"},bt={key:0,class:"text-red-500"},vt={key:0,class:"text-sm text-muted-foreground"},yt={key:6,class:"space-y-2"},xt=["id","name","value","onUpdate:modelValue"],ht={key:7,class:"space-y-2"},kt={key:8},Ct={key:9},$t={key:0,class:"text-red-500 text-sm mt-1"},wt={key:10},Vt={key:11},St={key:12},At={key:13,class:"text-sm text-destructive"},Et={key:1,class:"p-3 bg-red-50 border border-red-200 rounded-lg"},Ut={class:"text-red-800 text-sm"},qt={key:0,class:"fixed bottom-0 left-0 right-0 z-50 px-2 sm:px-4 pb-2 sm:pb-4"},Ft={class:"mx-auto max-w-7xl"},Bt={class:"backdrop-blur-lg bg-tertiary-60 dark:bg-gray-900/80 border border-gray-200/50 dark:border-gray-700/50 rounded-xl sm:rounded-2xl shadow-2xl p-3 sm:p-4"},Nt={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 sm:gap-4"},Dt={class:"hidden sm:flex items-center"},Tt={class:"flex-1 sm:max-w-xs lg:max-w-sm mx-0 sm:mx-4"},jt={class:"flex items-center gap-3"},zt={class:"text-xs sm:text-sm text-muted-foreground whitespace-nowrap font-medium"},Pt={class:"flex items-center gap-2 sm:gap-3"},Lt={class:"ml-2 whitespace-nowrap"},Mt=Pe({__name:"Form",props:{candidatura:{},configuracion_campos:{},is_editing:{type:Boolean}},setup(Q){var le,oe;const u=Q,N=[{title:"Dashboard",href:"/dashboard"},{title:"Mi Candidatura",href:"/candidaturas"},{title:u.is_editing?"Editar":"Crear",href:"#"}],{uploadFiles:z}=pa(),h=F({});w(()=>{var g;if(!u.is_editing||!((g=u.candidatura)!=null&&g.formulario_data))return!1;const i=Object.keys(u.candidatura.formulario_data),r=u.configuracion_campos.map(a=>a.id),t=i.some(a=>!r.includes(a)),n=u.configuracion_campos.some(a=>a.required&&!u.candidatura.formulario_data[a.id]);return t||n});const d=Ke((()=>{var r;const i={};return u.configuracion_campos.forEach(t=>{t.type==="checkbox"?i[t.id]=[]:t.type==="file"?i[t.id]=[]:t.type==="convocatoria"?i[t.id]=void 0:t.type==="disclaimer"?i[t.id]=null:t.type==="repeater"?i[t.id]=[]:t.type==="datepicker"?i[t.id]=null:i[t.id]=""}),(r=u.candidatura)!=null&&r.formulario_data&&(Object.assign(i,u.candidatura.formulario_data),u.configuracion_campos.forEach(t=>{t.type==="file"&&i[t.id]&&(Array.isArray(i[t.id])||(i[t.id]=[i[t.id]]))})),{formulario_data:i}})()),k=F(u.configuracion_campos),L=w(()=>d.formulario_data),{visibleFields:V,clearHiddenFieldValues:M}=ga(k,L);se(V,()=>{M()});const{state:O,isSaving:E,hasSaved:G,hasError:q,saveNow:b,startWatching:v,stopAutoSave:_,restoreDraft:X,clearLocalStorage:Z}=$a(L,{url:"/candidaturas/autosave",resourceId:((le=u.candidatura)==null?void 0:le.id)||null,resourceIdField:"candidatura_id",debounceTime:3e3,showNotifications:!0,useLocalStorage:!0,localStorageKey:`candidatura_draft_${((oe=u.candidatura)==null?void 0:oe.id)||"new"}`});let D=null;Le(()=>{const i=["borrador","rechazado"];if(!u.candidatura||i.includes(u.candidatura.estado)){if(!u.is_editing){const t=X();t&&t.formulario_data&&($.info("Borrador recuperado",{description:"Se encontró un borrador guardado localmente. Se ha restaurado automáticamente.",action:{label:"Descartar",onClick:()=>{Z(),d.reset(),$.success("Borrador descartado")}},duration:5e3}),Object.assign(d.formulario_data,t.formulario_data))}D=v()}}),Je(()=>{D&&D(),_()});const Me=async()=>{if(E.value){$.warning("Ya se está guardando...");return}await b(),q.value||$.success("Borrador guardado manualmente")},Oe=w(()=>R.value.map(t=>{var a;if(!t.required)return{campo:t.id,valid:!0};const n=d.formulario_data[t.id];let g=!1;if(t.type==="checkbox")g=Array.isArray(n)&&n.length>0;else if(t.type==="file")(Array.isArray(n)&&n.length>0||h.value[t.id]&&h.value[t.id].length>0)&&(g=!0);else if(t.type==="convocatoria")g=n!=null&&n!=="";else if(t.type==="disclaimer")g=n&&n.accepted===!0;else if(t.type==="repeater"){const I=((a=t.repeaterConfig)==null?void 0:a.minItems)||0;g=Array.isArray(n)&&n.length>=I}else t.type==="datepicker"?g=n!=null&&n!=="":g=n&&n.toString().trim()!=="";return!g&&t.required,{campo:t.id,valid:g}}).every(t=>t.valid)),ee=w(()=>{const i=R.value.length;let r=0;return R.value.forEach(t=>{const n=d.formulario_data[t.id];let g=!1;t.type==="checkbox"?g=Array.isArray(n)&&n.length>0:t.type==="file"?g=Array.isArray(n)&&n.length>0||h.value[t.id]&&h.value[t.id].length>0:t.type==="convocatoria"?g=n!=null&&n!=="":t.type==="disclaimer"?g=n&&n.accepted===!0:t.type==="repeater"?g=Array.isArray(n)&&n.length>0:t.type==="datepicker"?g=n!=null&&n!=="":g=n&&n.toString().trim()!=="",g&&r++}),{llenos:r,total:i,porcentaje:i>0?Math.round(r/i*100):0}}),ie=w(()=>u.is_editing?"Editar Candidatura":"Crear Candidatura"),Ge=w(()=>{var i,r;return d.processing?"Guardando...":u.is_editing?((i=u.candidatura)==null?void 0:i.estado)==="rechazado"?"Reenviar Candidatura":((r=u.candidatura)==null?void 0:r.estado)==="aprobado"?"Solicitar Revisión":"Enviar Candidatura":"Crear Candidatura"}),R=w(()=>{var r;let i=[...V.value];return u.is_editing&&u.candidatura&&["pendiente","aprobado"].includes(u.candidatura.estado)&&(i=i.filter(n=>n.type!=="convocatoria")),u.is_editing&&((r=u.candidatura)==null?void 0:r.estado)==="aprobado"&&(i=i.filter(t=>t.editable===!0)),i}),Re=w(()=>{var t;if(!u.is_editing||!u.candidatura)return!1;let i=!1;if(["pendiente","aprobado"].includes(u.candidatura.estado)&&(i=u.configuracion_campos.some(n=>n.type==="convocatoria")),((t=u.candidatura)==null?void 0:t.estado)==="aprobado"){const n=u.configuracion_campos.some(g=>!g.editable&&g.type!=="convocatoria");return i||n}return i}),Ie=async(i,r)=>{if(h.value[i]=r,r&&r.length>0)try{$.info("Subiendo archivos...",{duration:2e3});const n=(await z(r,{module:"candidaturas",fieldId:i})).map(g=>g.path);Array.isArray(d.formulario_data[i]),d.formulario_data[i]=n,h.value[i]=[],$.success("Archivos subidos correctamente",{duration:2e3})}catch(t){console.error("Error al subir archivos:",t),$.error("Error al subir archivos",{description:"Por favor, intente nuevamente",duration:3e3})}else d.formulario_data[i]=[]},de=async()=>{for(const[r,t]of Object.entries(h.value))if(t&&t.length>0)try{$.info("Subiendo archivos pendientes...",{duration:2e3});const n=await z(t,{module:"candidaturas",fieldId:r});d.formulario_data[r]=n.map(g=>g.path),h.value[r]=[]}catch(n){console.error("Error al subir archivos:",n),$.error("Error al subir archivos pendientes",{description:"No se pudo completar el envío",duration:3e3});return}const i={...d.formulario_data};u.configuracion_campos.forEach(r=>{const t=i[r.id];r.required||(t===""||t===void 0||Array.isArray(t)&&t.length===0&&r.type!=="checkbox"&&r.type!=="file")&&(i[r.id]=null)}),d.formulario_data=i,_(),u.is_editing?d.put(`/candidaturas/${u.candidatura.id}`,{onSuccess:()=>{Z(),$.success("Candidatura actualizada exitosamente")},onError:r=>{console.error("Errores de validación:",r),(!u.candidatura||["borrador","rechazado"].includes(u.candidatura.estado))&&(D=v())}}):d.post("/candidaturas",{onSuccess:()=>{Z(),$.success("Candidatura creada exitosamente")},onError:r=>{console.error("Errores de validación:",r),D=v()}})},U=i=>!!d.errors[`formulario_data.${i}`],We=w(()=>!u.candidatura||["borrador","rechazado"].includes(u.candidatura.estado)),Ye=()=>{const i=document.querySelector('[data-sidebar="trigger"]');i&&i.click()};return(i,r)=>(o(),m(S,null,[s(e(Qe),{title:ie.value},null,8,["title"]),s(Ca,{breadcrumbs:N},{default:c(()=>{var t,n;return[l("div",rt,[l("div",st,[l("div",null,[l("h1",it,p(ie.value),1),l("p",dt,p(i.is_editing?"Actualiza la información de tu candidatura":"Completa tu perfil de candidatura para participar en convocatorias"),1)]),s(e(W),{variant:"outline",onClick:r[0]||(r[0]=g=>e(Xe).visit("/candidaturas"))},{default:c(()=>[s(e(wa),{class:"mr-2 h-4 w-4"}),r[1]||(r[1]=y(" Volver "))]),_:1})]),!i.candidatura||["borrador","rechazado"].includes(i.candidatura.estado)?(o(),m("div",lt,[e(E)?(o(),m("div",ot,[s(e(re),{class:"h-4 w-4 animate-spin"}),r[2]||(r[2]=l("span",null,"Guardando automáticamente...",-1))])):e(G)&&!e(q)?(o(),m("div",nt,[s(e(ze),{class:"h-4 w-4 text-green-600"}),l("span",null,"Guardado automáticamente a las "+p((t=e(O).lastSaved)==null?void 0:t.toLocaleTimeString()),1)])):e(q)?(o(),m("div",ut,[s(e(j),{class:"h-4 w-4"}),r[3]||(r[3]=l("span",null,"Guardado localmente (sin conexión)",-1))])):(o(),m("div",ct,[s(e(re),{class:"h-4 w-4"}),r[4]||(r[4]=l("span",null,"Autoguardado activado",-1))]))])):x("",!0),i.is_editing&&((n=i.candidatura)!=null&&n.comentarios_admin)?(o(),C(e(H),{key:1,class:"border-blue-200 dark:border-blue-800 bg-blue-50 dark:bg-blue-950/20"},{default:c(()=>[s(e(K),null,{default:c(()=>[s(e(Ue),{class:"text-blue-800 dark:text-blue-200 flex items-center gap-2"},{default:c(()=>[s(e(j),{class:"h-5 w-5"}),r[5]||(r[5]=y(" Comentarios de la comisión "))]),_:1})]),_:1}),s(e(J),null,{default:c(()=>[l("p",ft,p(i.candidatura.comentarios_admin),1)]),_:1})]),_:1})):x("",!0),s(e(H),null,{default:c(()=>[s(e(K),null,{default:c(()=>[s(e(Ue),{class:"flex items-center gap-2"},{default:c(()=>[s(e(Va),{class:"h-5 w-5"}),r[6]||(r[6]=y(" Información de Candidatura "))]),_:1})]),_:1}),s(e(J),null,{default:c(()=>{var g;return[l("form",{onSubmit:Ze(de,["prevent"]),class:"space-y-6"},[i.is_editing&&((g=i.candidatura)==null?void 0:g.estado)==="aprobado"?(o(),m("div",mt,[l("div",_t,[s(e(j),{class:"h-5 w-5 text-blue-600 mt-0.5"}),l("div",pt,[r[7]||(r[7]=l("p",{class:"font-medium"},"Candidatura Aprobada - Edición Limitada",-1)),r[8]||(r[8]=l("p",{class:"mt-1"},"Solo puedes editar los campos marcados como editables. Al hacer cambios, tu candidatura volverá a revisión administrativa.",-1)),Re.value?(o(),m("p",gt," Algunos campos están ocultos porque no son editables en candidaturas aprobadas o no pueden modificarse después del envío. ")):x("",!0)])])])):x("",!0),s(ea,{name:"fade-field",tag:"div",class:"space-y-6"},{default:c(()=>[(o(!0),m(S,null,B(R.value,a=>{var I,ne,ue,ce,fe,me,_e,pe,ge,be,ve,ye,xe,he,ke,Ce,$e,we,Ve,Se,Ae;return o(),m("div",{key:a.id,class:"space-y-2"},[s(e(T),{for:a.id,class:"flex items-center gap-1"},{default:c(()=>[y(p(a.title)+" ",1),a.required?(o(),m("span",bt,"*")):x("",!0)]),_:2},1032,["for"]),a.description?(o(),m("p",vt,p(a.description),1)):x("",!0),a.type==="text"||a.type==="email"?(o(),C(e(te),{key:1,id:a.id,type:a.type,modelValue:e(d).formulario_data[a.id],"onUpdate:modelValue":f=>e(d).formulario_data[a.id]=f,placeholder:a.placeholder||"",class:A({"border-destructive":U(a.id)})},null,8,["id","type","modelValue","onUpdate:modelValue","placeholder","class"])):a.type==="textarea"?(o(),C(e(_a),{key:2,id:a.id,modelValue:e(d).formulario_data[a.id],"onUpdate:modelValue":f=>e(d).formulario_data[a.id]=f,placeholder:a.placeholder||"",rows:4,class:A({"border-destructive":U(a.id)})},null,8,["id","modelValue","onUpdate:modelValue","placeholder","class"])):a.type==="number"?(o(),C(e(te),{key:3,id:a.id,type:"number",modelValue:e(d).formulario_data[a.id],"onUpdate:modelValue":f=>e(d).formulario_data[a.id]=f,placeholder:a.placeholder||"",class:A({"border-destructive":U(a.id)})},null,8,["id","modelValue","onUpdate:modelValue","placeholder","class"])):a.type==="date"?(o(),C(e(te),{key:4,id:a.id,type:"date",modelValue:e(d).formulario_data[a.id],"onUpdate:modelValue":f=>e(d).formulario_data[a.id]=f,class:A({"border-destructive":U(a.id)})},null,8,["id","modelValue","onUpdate:modelValue","class"])):a.type==="select"?(o(),C(e(na),{key:5,modelValue:e(d).formulario_data[a.id],"onUpdate:modelValue":f=>e(d).formulario_data[a.id]=f},{default:c(()=>[s(e(ua),{class:A({"border-destructive":U(a.id)})},{default:c(()=>[s(e(ca),{placeholder:a.placeholder||"Seleccionar..."},null,8,["placeholder"])]),_:2},1032,["class"]),s(e(fa),null,{default:c(()=>[(o(!0),m(S,null,B(a.options,f=>(o(),C(e(ma),{key:f,value:f},{default:c(()=>[y(p(f),1)]),_:2},1032,["value"]))),128))]),_:2},1024)]),_:2},1032,["modelValue","onUpdate:modelValue"])):a.type==="radio"?(o(),m("div",yt,[(o(!0),m(S,null,B(a.options,f=>(o(),m("div",{key:f,class:"flex items-center space-x-2"},[aa(l("input",{id:`${a.id}_${f}`,name:a.id,type:"radio",value:f,"onUpdate:modelValue":ae=>e(d).formulario_data[a.id]=ae,class:"h-4 w-4 text-primary focus:ring-primary border-gray-300"},null,8,xt),[[ta,e(d).formulario_data[a.id]]]),s(e(T),{for:`${a.id}_${f}`,class:"text-sm font-normal"},{default:c(()=>[y(p(f),1)]),_:2},1032,["for"])]))),128))])):a.type==="checkbox"?(o(),m("div",ht,[(o(!0),m(S,null,B(a.options,f=>(o(),m("div",{key:f,class:"flex items-center space-x-2"},[s(e(da),{id:`${a.id}_${f}`,checked:e(d).formulario_data[a.id].includes(f),"onUpdate:checked":ae=>{if(ae)e(d).formulario_data[a.id].includes(f)||e(d).formulario_data[a.id].push(f);else{const Ee=e(d).formulario_data[a.id].indexOf(f);Ee>-1&&e(d).formulario_data[a.id].splice(Ee,1)}}},null,8,["id","checked","onUpdate:checked"]),s(e(T),{for:`${a.id}_${f}`,class:"text-sm font-normal"},{default:c(()=>[y(p(f),1)]),_:2},1032,["for"])]))),128))])):a.type==="file"?(o(),m("div",kt,[s(ba,{modelValue:e(d).formulario_data[a.id],"onUpdate:modelValue":f=>e(d).formulario_data[a.id]=f,onFilesSelected:f=>Ie(a.id,f),label:"",description:"",required:a.required,multiple:((I=a.fileConfig)==null?void 0:I.multiple)||!1,"max-files":((ne=a.fileConfig)==null?void 0:ne.maxFiles)||5,"max-file-size":((ue=a.fileConfig)==null?void 0:ue.maxFileSize)||10,accept:((ce=a.fileConfig)==null?void 0:ce.accept)||".pdf,.doc,.docx,.xls,.xlsx,.jpg,.jpeg,.png,.gif",error:e(d).errors[`formulario_data.${a.id}`],disabled:e(d).processing,module:"candidaturas","field-id":a.id,"auto-upload":!1},null,8,["modelValue","onUpdate:modelValue","onFilesSelected","required","multiple","max-files","max-file-size","accept","error","disabled","field-id"])])):a.type==="convocatoria"?(o(),m("div",Ct,[s(tt,{modelValue:e(d).formulario_data[a.id],"onUpdate:modelValue":f=>e(d).formulario_data[a.id]=f,required:a.required,disabled:e(d).processing||i.is_editing&&((fe=i.candidatura)==null?void 0:fe.estado)!=="borrador","filtrar-por-ubicacion":((me=a.convocatoriaConfig)==null?void 0:me.filtrarPorUbicacion)??!0,"show-postulacion-warning":!0},null,8,["modelValue","onUpdate:modelValue","required","disabled","filtrar-por-ubicacion"]),U(a.id)?(o(),m("div",$t,p(e(d).errors[`formulario_data.${a.id}`]),1)):x("",!0)])):a.type==="datepicker"?(o(),m("div",wt,[s(va,{"model-value":e(d).formulario_data[a.id]||null,"onUpdate:modelValue":f=>e(d).formulario_data[a.id]=f,label:"",description:"",required:a.required,disabled:e(d).processing,error:e(d).errors[`formulario_data.${a.id}`],"min-date":(_e=a.datepickerConfig)==null?void 0:_e.minDate,"max-date":(pe=a.datepickerConfig)==null?void 0:pe.maxDate,format:((ge=a.datepickerConfig)==null?void 0:ge.format)||"DD/MM/YYYY","allow-past-dates":((be=a.datepickerConfig)==null?void 0:be.allowPastDates)??!0,"allow-future-dates":((ve=a.datepickerConfig)==null?void 0:ve.allowFutureDates)??!0},null,8,["model-value","onUpdate:modelValue","required","disabled","error","min-date","max-date","format","allow-past-dates","allow-future-dates"])])):a.type==="disclaimer"?(o(),m("div",Vt,[s(ya,{"model-value":e(d).formulario_data[a.id]||null,"onUpdate:modelValue":f=>e(d).formulario_data[a.id]=f,label:"",description:"",required:a.required,disabled:e(d).processing,error:e(d).errors[`formulario_data.${a.id}`],"disclaimer-text":((ye=a.disclaimerConfig)==null?void 0:ye.disclaimerText)||"","modal-title":((xe=a.disclaimerConfig)==null?void 0:xe.modalTitle)||"Términos y Condiciones","accept-button-text":((he=a.disclaimerConfig)==null?void 0:he.acceptButtonText)||"Acepto","decline-button-text":((ke=a.disclaimerConfig)==null?void 0:ke.declineButtonText)||"No acepto"},null,8,["model-value","onUpdate:modelValue","required","disabled","error","disclaimer-text","modal-title","accept-button-text","decline-button-text"])])):a.type==="repeater"?(o(),m("div",St,[s(xa,{"model-value":e(d).formulario_data[a.id]||[],"onUpdate:modelValue":f=>e(d).formulario_data[a.id]=f,label:"",description:"",required:a.required,disabled:e(d).processing,error:e(d).errors[`formulario_data.${a.id}`],"min-items":((Ce=a.repeaterConfig)==null?void 0:Ce.minItems)||0,"max-items":(($e=a.repeaterConfig)==null?void 0:$e.maxItems)||10,"item-name":((we=a.repeaterConfig)==null?void 0:we.itemName)||"Elemento","add-button-text":((Ve=a.repeaterConfig)==null?void 0:Ve.addButtonText)||"Agregar elemento","remove-button-text":((Se=a.repeaterConfig)==null?void 0:Se.removeButtonText)||"Eliminar",fields:((Ae=a.repeaterConfig)==null?void 0:Ae.fields)||[]},null,8,["model-value","onUpdate:modelValue","required","disabled","error","min-items","max-items","item-name","add-button-text","remove-button-text","fields"])])):x("",!0),U(a.id)?(o(),m("p",At,p(e(d).errors[`formulario_data.${a.id}`]),1)):x("",!0)])}),128))]),_:1}),e(d).errors.general?(o(),m("div",Et,[l("p",Ut,p(e(d).errors.general),1)])):x("",!0),r[9]||(r[9]=l("div",{class:"h-4"},null,-1))],32)]}),_:1})]),_:1})]),(o(),C(ra,{to:"body"},[s(sa,{"enter-active-class":"transition ease-out duration-300","enter-from-class":"translate-y-4 opacity-0","enter-to-class":"translate-y-0 opacity-100","leave-active-class":"transition ease-in duration-200","leave-from-class":"translate-y-0 opacity-100","leave-to-class":"translate-y-4 opacity-0"},{default:c(()=>[(o(),m("div",qt,[l("div",Ft,[l("div",Bt,[l("div",Nt,[l("div",Dt,[s(e(W),{variant:"outline",type:"button",onClick:Ye,class:"backdrop-blur-sm flex-shrink-0 text-xs sm:text-sm py-2 px-3"},{default:c(()=>[s(e(ka),{class:"h-4 w-4"}),r[10]||(r[10]=l("span",{class:"ml-2"},"Ocultar sidebar",-1))]),_:1})]),l("div",Tt,[l("div",jt,[s(e(la),{modelValue:ee.value.porcentaje,class:"flex-1"},null,8,["modelValue"]),l("span",zt,p(ee.value.llenos)+" / "+p(ee.value.total),1)]),r[11]||(r[11]=l("p",{class:"text-xs text-muted-foreground mt-1 text-center hidden sm:block"}," Campos completados ",-1))]),l("div",Pt,[We.value?(o(),C(e(W),{key:0,onClick:Me,disabled:e(E),variant:"outline",class:"backdrop-blur-sm flex-1 sm:flex-none text-xs sm:text-sm py-2 px-3"},{default:c(()=>[e(E)?(o(),m(S,{key:0},[s(e(re),{class:"mr-2 h-4 w-4 animate-spin"}),r[12]||(r[12]=y(" Guardando... "))],64)):(o(),m(S,{key:1},[s(e(Sa),{class:"mr-2 h-4 w-4"}),r[13]||(r[13]=y(" Guardar borrador "))],64))]),_:1},8,["disabled"])):x("",!0),s(e(W),{onClick:de,disabled:!Oe.value||e(d).processing,class:"bg-green-600 hover:bg-green-700 text-white border-green-600 hover:border-green-700 disabled:bg-gray-400 disabled:border-gray-400 flex-1 sm:flex-none text-xs sm:text-sm py-2 px-3"},{default:c(()=>[s(e(ze),{class:"h-4 w-4"}),l("span",Lt,p(Ge.value),1)]),_:1},8,["disabled"])])])])])]))]),_:1})]))]}),_:1})],64))}}),yr=ia(Mt,[["__scopeId","data-v-3d4bd424"]]);export{yr as default};
