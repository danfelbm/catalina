import{e as q,l as qe,_ as G,a as L,b as Y,c as W,d as P,X as Ue}from"./DialogTitle.vue_vue_type_script_setup_true_lang-BJmCMDA5.js";import{c as Pe,_ as w}from"./createLucideIcon-BvZ_hvef.js";import{_ as de,a as se,b as re,c as ue}from"./index-d0hLCKZ5.js";import{_ as K}from"./Checkbox.vue_vue_type_script_setup_true_lang-ig47s7C3.js";import{_ as b,a as $}from"./Label.vue_vue_type_script_setup_true_lang-DWSITdM-.js";import{_ as ee}from"./Textarea.vue_vue_type_script_setup_true_lang-B7yoDa-3.js";import{k as ae,s as ze,d as Ne,c as ie,j as T,o as c,u as e,e as l,b as o,f as r,i as x,g as u,t as k,a as v,F as h,r as M,l as Ge,w as le,p as Le,x as je}from"./app-Bb-Y6LhL.js";import{_ as Ye}from"./CardDescription.vue_vue_type_script_setup_true_lang-BVdVxGnh.js";import{P as oe}from"./plus-CifEDcVu.js";import{E as Ie}from"./eye-BWZ8xxBI.js";import{T as te}from"./trash-2-Cn2t1uX8.js";import{G as We}from"./git-branch-DQY7mf4x.js";/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Re=Pe("EyeOffIcon",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);function He(R=[]){const D=ae([...R]),y=ae(!1),E=ae(null),a=ze({id:"",type:"text",title:"",description:"",required:!1,options:[],editable:!1,category:void 0,perfilCandidaturaConfig:void 0,convocatoriaConfig:{convocatoria_id:void 0,multiple:!1,mostrarVotoBlanco:!0},fileConfig:{multiple:!1,maxFiles:5,maxFileSize:10,accept:".pdf,.doc,.docx,.xls,.xlsx,.jpg,.jpeg,.png,.gif"},datepickerConfig:{minDate:void 0,maxDate:void 0,format:"DD/MM/YYYY",allowPastDates:!0,allowFutureDates:!0},disclaimerConfig:{disclaimerText:"",modalTitle:"Términos y Condiciones",acceptButtonText:"Acepto",declineButtonText:"No acepto"},repeaterConfig:{minItems:0,maxItems:10,itemName:"Elemento",addButtonText:"Agregar elemento",removeButtonText:"Eliminar",fields:[]},numberConfig:{min:void 0,max:void 0,step:1,decimals:0},conditionalConfig:{enabled:!1,showWhen:"all",conditions:[]}}),t=()=>{a.id="",a.type="text",a.title="",a.description="",a.required=!1,a.options=[],a.editable=!1,a.category=void 0,a.perfilCandidaturaConfig=void 0,a.convocatoriaConfig={convocatoria_id:void 0,multiple:!1,mostrarVotoBlanco:!0},a.fileConfig={multiple:!1,maxFiles:5,maxFileSize:10,accept:".pdf,.doc,.docx,.xls,.xlsx,.jpg,.jpeg,.png,.gif"},a.datepickerConfig={minDate:void 0,maxDate:void 0,format:"DD/MM/YYYY",allowPastDates:!0,allowFutureDates:!0},a.disclaimerConfig={disclaimerText:"",modalTitle:"Términos y Condiciones",acceptButtonText:"Acepto",declineButtonText:"No acepto"},a.repeaterConfig={minItems:0,maxItems:10,itemName:"Elemento",addButtonText:"Agregar elemento",removeButtonText:"Eliminar",fields:[]},a.numberConfig={min:void 0,max:void 0,step:1,decimals:0},a.conditionalConfig={enabled:!1,showWhen:"all",conditions:[]},y.value=!1,E.value=null},O=()=>{var d;const p={id:a.id||`field_${Date.now()}`,type:a.type,title:a.title,description:a.description,required:a.required,editable:a.editable,category:a.category,options:((d=a.options)==null?void 0:d.filter(A=>typeof A=="string"?A.trim()!=="":A.label&&A.label.trim()!==""))||[]};a.type==="perfil_candidatura"&&a.perfilCandidaturaConfig&&(p.perfilCandidaturaConfig={...a.perfilCandidaturaConfig,cargo_id:a.perfilCandidaturaConfig.cargo_id&&a.perfilCandidaturaConfig.cargo_id!=="all"?Number(a.perfilCandidaturaConfig.cargo_id):void 0,periodo_electoral_id:a.perfilCandidaturaConfig.periodo_electoral_id&&a.perfilCandidaturaConfig.periodo_electoral_id!=="all"?Number(a.perfilCandidaturaConfig.periodo_electoral_id):void 0,territorios_ids:a.perfilCandidaturaConfig.territorios_ids||[],departamentos_ids:a.perfilCandidaturaConfig.departamentos_ids||[],municipios_ids:a.perfilCandidaturaConfig.municipios_ids||[],localidades_ids:a.perfilCandidaturaConfig.localidades_ids||[]}),a.type==="convocatoria"&&a.convocatoriaConfig&&(p.convocatoriaConfig={...a.convocatoriaConfig,convocatoria_id:a.convocatoriaConfig.convocatoria_id?Number(a.convocatoriaConfig.convocatoria_id):void 0}),a.type==="file"&&a.fileConfig&&(p.fileConfig={...a.fileConfig}),a.type==="datepicker"&&a.datepickerConfig&&(p.datepickerConfig={...a.datepickerConfig}),a.type==="disclaimer"&&a.disclaimerConfig&&(p.disclaimerConfig={...a.disclaimerConfig}),a.type==="repeater"&&a.repeaterConfig&&(p.repeaterConfig={...a.repeaterConfig,fields:[...a.repeaterConfig.fields]}),a.type==="number"&&a.numberConfig&&(p.numberConfig={...a.numberConfig}),a.conditionalConfig&&a.conditionalConfig.enabled&&(p.conditionalConfig={enabled:a.conditionalConfig.enabled,showWhen:a.conditionalConfig.showWhen,conditions:[...a.conditionalConfig.conditions]}),console.log("Adding field:",{required:a.required,editable:a.editable,fieldToAdd:p}),E.value!==null?(D.value[E.value]=p,E.value=null):D.value.push(p),t()},N=p=>{var A,f,s,n,i,m,V,B,g,_,F,Z,C,j,S,ce,me,fe,pe,ve,ge,Ce,_e,be,ye,xe,ke,Ve,we,Ae,Te,Fe,he,De,Be,Ee,$e,Me;const d=D.value[p];console.log("Editing field:",{originalField:d,required:d.required,editable:d.editable}),a.id=d.id,a.type=d.type,a.title=d.title,a.description=d.description||"",a.required=d.required??!1,a.options=(d.options||[]).map(Se=>U(Se)),a.editable=d.editable??!1,a.category=d.category||void 0,d.type==="perfil_candidatura"&&(a.perfilCandidaturaConfig={cargo_id:((A=d.perfilCandidaturaConfig)==null?void 0:A.cargo_id)||void 0,periodo_electoral_id:((f=d.perfilCandidaturaConfig)==null?void 0:f.periodo_electoral_id)||void 0,territorio_id:((s=d.perfilCandidaturaConfig)==null?void 0:s.territorio_id)||void 0,departamento_id:((n=d.perfilCandidaturaConfig)==null?void 0:n.departamento_id)||void 0,municipio_id:((i=d.perfilCandidaturaConfig)==null?void 0:i.municipio_id)||void 0,localidad_id:((m=d.perfilCandidaturaConfig)==null?void 0:m.localidad_id)||void 0,territorios_ids:((V=d.perfilCandidaturaConfig)==null?void 0:V.territorios_ids)||[],departamentos_ids:((B=d.perfilCandidaturaConfig)==null?void 0:B.departamentos_ids)||[],municipios_ids:((g=d.perfilCandidaturaConfig)==null?void 0:g.municipios_ids)||[],localidades_ids:((_=d.perfilCandidaturaConfig)==null?void 0:_.localidades_ids)||[],multiple:((F=d.perfilCandidaturaConfig)==null?void 0:F.multiple)||!1,mostrarVotoBlanco:((Z=d.perfilCandidaturaConfig)==null?void 0:Z.mostrarVotoBlanco)??!0}),d.type==="convocatoria"&&(a.convocatoriaConfig={convocatoria_id:((C=d.convocatoriaConfig)==null?void 0:C.convocatoria_id)||void 0,multiple:((j=d.convocatoriaConfig)==null?void 0:j.multiple)||!1,mostrarVotoBlanco:((S=d.convocatoriaConfig)==null?void 0:S.mostrarVotoBlanco)??!0}),d.type==="file"&&(a.fileConfig={multiple:((ce=d.fileConfig)==null?void 0:ce.multiple)||!1,maxFiles:((me=d.fileConfig)==null?void 0:me.maxFiles)||5,maxFileSize:((fe=d.fileConfig)==null?void 0:fe.maxFileSize)||10,accept:((pe=d.fileConfig)==null?void 0:pe.accept)||".pdf,.doc,.docx,.xls,.xlsx,.jpg,.jpeg,.png,.gif"}),d.type==="datepicker"&&(a.datepickerConfig={minDate:((ve=d.datepickerConfig)==null?void 0:ve.minDate)||void 0,maxDate:((ge=d.datepickerConfig)==null?void 0:ge.maxDate)||void 0,format:((Ce=d.datepickerConfig)==null?void 0:Ce.format)||"DD/MM/YYYY",allowPastDates:((_e=d.datepickerConfig)==null?void 0:_e.allowPastDates)??!0,allowFutureDates:((be=d.datepickerConfig)==null?void 0:be.allowFutureDates)??!0}),d.type==="disclaimer"&&(a.disclaimerConfig={disclaimerText:((ye=d.disclaimerConfig)==null?void 0:ye.disclaimerText)||"",modalTitle:((xe=d.disclaimerConfig)==null?void 0:xe.modalTitle)||"Términos y Condiciones",acceptButtonText:((ke=d.disclaimerConfig)==null?void 0:ke.acceptButtonText)||"Acepto",declineButtonText:((Ve=d.disclaimerConfig)==null?void 0:Ve.declineButtonText)||"No acepto"}),d.type==="repeater"&&(a.repeaterConfig={minItems:((we=d.repeaterConfig)==null?void 0:we.minItems)||0,maxItems:((Ae=d.repeaterConfig)==null?void 0:Ae.maxItems)||10,itemName:((Te=d.repeaterConfig)==null?void 0:Te.itemName)||"Elemento",addButtonText:((Fe=d.repeaterConfig)==null?void 0:Fe.addButtonText)||"Agregar elemento",removeButtonText:((he=d.repeaterConfig)==null?void 0:he.removeButtonText)||"Eliminar",fields:(De=d.repeaterConfig)!=null&&De.fields?[...d.repeaterConfig.fields]:[]}),d.type==="number"&&(a.numberConfig={min:((Be=d.numberConfig)==null?void 0:Be.min)||void 0,max:((Ee=d.numberConfig)==null?void 0:Ee.max)||void 0,step:(($e=d.numberConfig)==null?void 0:$e.step)||1,decimals:((Me=d.numberConfig)==null?void 0:Me.decimals)||0}),d.conditionalConfig&&(a.conditionalConfig={enabled:d.conditionalConfig.enabled||!1,showWhen:d.conditionalConfig.showWhen||"all",conditions:d.conditionalConfig.conditions?[...d.conditionalConfig.conditions]:[]}),console.log("After assignment:",{newFieldRequired:a.required,newFieldEditable:a.editable}),E.value=p,y.value=!0},H=p=>{D.value.splice(p,1)},J=()=>{a.options||(a.options=[]),a.options.push({label:"",value:void 0})},z=p=>{var d;(d=a.options)==null||d.splice(p,1)},U=p=>typeof p=="string"?{label:p,value:void 0}:p;return{fields:D,newField:a,showFieldForm:y,editingFieldIndex:E,addField:O,editField:N,removeField:H,resetFieldForm:t,addOption:J,removeOption:z,setFields:p=>{D.value=[...p]},canSave:()=>D.value.length>0,normalizeOptionForEditing:U,ensureCategoryObject:()=>{a.category||(a.category={id:"",name:"",description:""})}}}const Je={class:"flex items-center space-x-2"},Qe={key:0,class:"space-y-4"},Xe={key:0,class:"p-4 bg-amber-100 border border-amber-300 rounded-lg"},Ze={class:"flex items-start gap-2"},Ke={class:"space-y-3"},ea={key:0},aa={key:1,class:"text-xs text-muted-foreground mt-1"},ia={class:"flex justify-end"},oa={key:0,class:"mt-4"},ta={class:"flex items-center justify-between mb-2"},la={key:0,class:"p-3 bg-gray-100 rounded-lg"},na={class:"text-sm font-medium text-gray-900 mt-1"},Oe=Ne({__name:"ConditionalFieldConfig",props:{modelValue:{default:()=>({enabled:!1,showWhen:"all",conditions:[]})},fields:{},currentFieldId:{}},emits:["update:modelValue"],setup(R,{emit:D}){const y=R,E=D,a=ie({get(){var f,s,n;return{enabled:((f=y.modelValue)==null?void 0:f.enabled)||!1,showWhen:((s=y.modelValue)==null?void 0:s.showWhen)||"all",conditions:((n=y.modelValue)==null?void 0:n.conditions)||[]}},set(f){E("update:modelValue",f)}}),t=f=>{a.value={...a.value,...f}},O=ie(()=>y.fields.filter(f=>f.id===y.currentFieldId?!1:["select","radio","checkbox"].includes(f.type))),N=[{value:"equals",label:"Es igual a"},{value:"not_equals",label:"No es igual a"},{value:"contains",label:"Contiene"},{value:"not_contains",label:"No contiene"},{value:"is_empty",label:"Está vacío"},{value:"is_not_empty",label:"No está vacío"}],H=()=>{const f={fieldId:"",operator:"equals",value:""},s=[...a.value.conditions,f];t({conditions:s})},J=f=>{const s=a.value.conditions.filter((n,i)=>i!==f);t({conditions:s})},z=f=>{const s=y.fields.find(n=>n.id===f);return s?s.options||[]:[]},U=f=>{const s=y.fields.find(n=>n.id===f);return(s==null?void 0:s.title)||f},I=f=>!["is_empty","is_not_empty"].includes(f),Q=(f,s)=>{const n=[...a.value.conditions];n[f]={...n[f],value:s},t({conditions:n})},X=(f,s)=>{const n=[...a.value.conditions];n[f]={...n[f],fieldId:s,value:""},t({conditions:n})},p=(f,s)=>{const n=[...a.value.conditions];n[f]={...n[f],operator:s,value:I(s)?n[f].value:void 0},t({conditions:n})},d=ie(()=>{if(!a.value.enabled||a.value.conditions.length===0)return"Sin condiciones configuradas";const f=a.value.showWhen==="all"?" Y ":" O ";return a.value.conditions.map(n=>{var B;const i=U(n.fieldId),m=((B=N.find(g=>g.value===n.operator))==null?void 0:B.label)||n.operator;if(!I(n.operator))return`"${i}" ${m}`;const V=Array.isArray(n.value)?n.value.join(", "):n.value||"[valor]";return`"${i}" ${m} "${V}"`}).join(f)}),A=ae(!1);return(f,s)=>(c(),T(e(de),{class:"border-orange-200 bg-orange-50"},{default:l(()=>[o(e(se),null,{default:l(()=>[o(e(re),{class:"text-orange-900 flex items-center justify-between"},{default:l(()=>[s[3]||(s[3]=r("span",null,"Configuración Condicional",-1)),a.value.enabled?(c(),T(e(q),{key:0,variant:"secondary",class:"bg-orange-100"},{default:l(()=>[u(k(a.value.conditions.length)+" condicion"+k(a.value.conditions.length!==1?"es":""),1)]),_:1})):x("",!0)]),_:1}),o(e(Ye),{class:"text-orange-700"},{default:l(()=>s[4]||(s[4]=[u(" Define cuándo debe mostrarse este campo basándose en valores de otros campos ")])),_:1})]),_:1}),o(e(ue),{class:"space-y-4"},{default:l(()=>[r("div",Je,[o(e(K),{id:"enable_conditions",checked:a.value.enabled,"onUpdate:checked":s[0]||(s[0]=n=>t({enabled:n}))},null,8,["checked"]),o(e(b),{for:"enable_conditions",class:"text-sm font-medium"},{default:l(()=>s[5]||(s[5]=[u(" Hacer este campo condicional "),r("span",{class:"text-muted-foreground block text-xs"}," El campo solo se mostrará cuando se cumplan las condiciones definidas ",-1)])),_:1})]),a.value.enabled?(c(),v("div",Qe,[O.value.length===0?(c(),v("div",Xe,[r("div",Ze,[o(e(qe),{class:"h-5 w-5 text-amber-600 mt-0.5"}),s[6]||(s[6]=r("div",{class:"text-sm text-amber-800"},[r("p",{class:"font-medium"},"No hay campos disponibles para condiciones"),r("p",{class:"mt-1"},'Agrega campos de tipo "Lista desplegable", "Opción múltiple" o "Casillas de verificación" antes de configurar condiciones.')],-1))])])):(c(),v(h,{key:1},[r("div",null,[o(e(b),null,{default:l(()=>s[7]||(s[7]=[u("Mostrar este campo cuando:")])),_:1}),o(e(G),{"model-value":a.value.showWhen,"onUpdate:modelValue":s[1]||(s[1]=n=>t({showWhen:n}))},{default:l(()=>[o(e(L),{class:"w-full"},{default:l(()=>[o(e(Y))]),_:1}),o(e(W),null,{default:l(()=>[o(e(P),{value:"all"},{default:l(()=>s[8]||(s[8]=[u(" Se cumplan TODAS las condiciones (AND) ")])),_:1}),o(e(P),{value:"any"},{default:l(()=>s[9]||(s[9]=[u(" Se cumpla ALGUNA condición (OR) ")])),_:1})]),_:1})]),_:1},8,["model-value"])]),r("div",Ke,[(c(!0),v(h,null,M(a.value.conditions,(n,i)=>(c(),v("div",{key:i,class:"p-3 bg-white border rounded-lg space-y-3"},[r("div",null,[o(e(b),{class:"text-xs"},{default:l(()=>s[10]||(s[10]=[u("Campo a evaluar")])),_:1}),o(e(G),{"model-value":n.fieldId,"onUpdate:modelValue":m=>X(i,m)},{default:l(()=>[o(e(L),null,{default:l(()=>[o(e(Y),{placeholder:"Selecciona un campo"})]),_:1}),o(e(W),null,{default:l(()=>[(c(!0),v(h,null,M(O.value,m=>(c(),T(e(P),{key:m.id,value:m.id},{default:l(()=>[u(k(m.title)+" ",1),o(e(q),{variant:"outline",class:"ml-2 text-xs"},{default:l(()=>[u(k(m.type),1)]),_:2},1024)]),_:2},1032,["value"]))),128))]),_:1})]),_:2},1032,["model-value","onUpdate:modelValue"])]),r("div",null,[o(e(b),{class:"text-xs"},{default:l(()=>s[11]||(s[11]=[u("Operador")])),_:1}),o(e(G),{"model-value":n.operator,"onUpdate:modelValue":m=>p(i,m)},{default:l(()=>[o(e(L),null,{default:l(()=>[o(e(Y))]),_:1}),o(e(W),null,{default:l(()=>[(c(),v(h,null,M(N,m=>o(e(P),{key:m.value,value:m.value},{default:l(()=>[u(k(m.label),1)]),_:2},1032,["value"])),64))]),_:1})]),_:2},1032,["model-value","onUpdate:modelValue"])]),I(n.operator)&&n.fieldId?(c(),v("div",ea,[o(e(b),{class:"text-xs"},{default:l(()=>s[12]||(s[12]=[u("Valor")])),_:1}),z(n.fieldId).length>0?(c(),T(e(G),{key:0,"model-value":n.value,"onUpdate:modelValue":m=>Q(i,m)},{default:l(()=>[o(e(L),null,{default:l(()=>[o(e(Y),{placeholder:"Selecciona un valor"})]),_:1}),o(e(W),null,{default:l(()=>[(c(!0),v(h,null,M(z(n.fieldId),m=>(c(),T(e(P),{key:m,value:m},{default:l(()=>[u(k(m),1)]),_:2},1032,["value"]))),128))]),_:2},1024)]),_:2},1032,["model-value","onUpdate:modelValue"])):(c(),v("p",aa," El campo seleccionado no tiene opciones definidas "))])):x("",!0),r("div",ia,[o(e(w),{type:"button",variant:"ghost",size:"sm",onClick:m=>J(i),class:"text-destructive"},{default:l(()=>[o(e(te),{class:"h-4 w-4 mr-1"}),s[13]||(s[13]=u(" Eliminar condición "))]),_:2},1032,["onClick"])])]))),128)),o(e(w),{type:"button",variant:"outline",size:"sm",onClick:H,class:"w-full"},{default:l(()=>[o(e(oe),{class:"h-4 w-4 mr-2"}),s[14]||(s[14]=u(" Agregar condición "))]),_:1})]),a.value.conditions.length>0?(c(),v("div",oa,[r("div",ta,[o(e(b),{class:"text-xs"},{default:l(()=>s[15]||(s[15]=[u("Vista previa de la regla:")])),_:1}),o(e(w),{type:"button",variant:"ghost",size:"sm",onClick:s[2]||(s[2]=n=>A.value=!A.value)},{default:l(()=>[(c(),T(Ge(A.value?e(Re):e(Ie)),{class:"h-4 w-4 mr-1"})),u(" "+k(A.value?"Ocultar":"Mostrar"),1)]),_:1})]),A.value?(c(),v("div",la,[s[16]||(s[16]=r("p",{class:"text-sm text-gray-700"}," Este campo se mostrará cuando: ",-1)),r("p",na,k(d.value),1)])):x("",!0)])):x("",!0)],64))])):x("",!0)]),_:1})]),_:1}))}}),ne=[{value:"text",label:"Texto corto"},{value:"textarea",label:"Texto largo"},{value:"number",label:"Campo numérico"},{value:"email",label:"Correo electrónico"},{value:"date",label:"Fecha (HTML5)"},{value:"select",label:"Lista desplegable"},{value:"radio",label:"Opción múltiple"},{value:"checkbox",label:"Casillas de verificación"},{value:"file",label:"Archivo"},{value:"datepicker",label:"Selector de fecha"},{value:"disclaimer",label:"Aceptar disclaimer"},{value:"repeater",label:"Repetidor"},{value:"perfil_candidatura",label:"Perfil de Candidatura"},{value:"convocatoria",label:"Elegir Convocatoria"}],ti=[{value:"America/Bogota",label:"Colombia (GMT-5) - America/Bogota"},{value:"America/Mexico_City",label:"México (GMT-6) - America/Mexico_City"},{value:"America/Buenos_Aires",label:"Argentina (GMT-3) - America/Buenos_Aires"},{value:"America/Sao_Paulo",label:"Brasil (GMT-3) - America/Sao_Paulo"},{value:"America/Santiago",label:"Chile (GMT-3) - America/Santiago"},{value:"America/Lima",label:"Perú (GMT-5) - America/Lima"},{value:"America/Caracas",label:"Venezuela (GMT-4) - America/Caracas"},{value:"America/La_Paz",label:"Bolivia (GMT-4) - America/La_Paz"},{value:"America/Quito",label:"Ecuador (GMT-5) - America/Quito"},{value:"America/Panama",label:"Panamá (GMT-5) - America/Panama"},{value:"America/Costa_Rica",label:"Costa Rica (GMT-6) - America/Costa_Rica"},{value:"America/Guatemala",label:"Guatemala (GMT-6) - America/Guatemala"},{value:"America/Montevideo",label:"Uruguay (GMT-3) - America/Montevideo"},{value:"America/Asuncion",label:"Paraguay (GMT-3) - America/Asuncion"}],da={class:"space-y-6"},sa={class:"flex items-center justify-between"},ra={class:"text-lg font-semibold"},ua={class:"text-sm text-muted-foreground"},ca={class:"grid gap-4 md:grid-cols-2"},ma={class:"space-y-3 mt-6"},fa={class:"flex items-center space-x-2"},pa={key:0,class:"flex items-center space-x-2"},va={class:"grid grid-cols-1 gap-2"},ga={key:0},Ca={class:"flex items-center justify-between"},_a={class:"space-y-2 mt-2"},ba={class:"flex-1"},ya={class:"w-24"},xa={key:1},ka={class:"flex justify-end gap-2"},Va={key:1,class:"space-y-4"},wa={class:"border rounded-lg p-4 flex items-center justify-between"},Aa={class:"flex-1"},Ta={class:"flex items-center gap-2"},Fa={key:0,class:"text-red-500"},ha={class:"font-medium"},Da={key:0,class:"text-sm text-muted-foreground"},Ba={key:1,class:"mt-2"},Ea={class:"flex flex-wrap gap-1 mt-1"},$a={class:"flex gap-2"},Ma={class:"grid gap-4 md:grid-cols-2"},Ua={class:"space-y-3 mt-6"},ja={class:"flex items-center space-x-2"},Oa={key:0,class:"flex items-center space-x-2"},Na={class:"grid grid-cols-1 gap-2"},Ia={key:0},Sa={class:"flex items-center justify-between"},qa={class:"space-y-2 mt-2"},Pa={class:"flex-1"},za={class:"w-24"},Ga={key:1},La={class:"flex justify-end gap-2"},Ya={key:2,class:"text-center py-8 text-muted-foreground border-2 border-dashed rounded-lg"},li=Ne({__name:"DynamicFormBuilder",props:{modelValue:{},disabled:{type:Boolean,default:!1},title:{default:"Constructor de Formulario"},description:{default:"Agrega los campos que aparecerán en el formulario"},showEditableOption:{type:Boolean,default:!1},showPerfilCandidaturaConfig:{type:Boolean,default:!1},cargos:{default:()=>[]},periodosElectorales:{default:()=>[]},showConvocatoriaConfig:{type:Boolean,default:!1},convocatorias:{default:()=>[]},context:{default:"convocatoria"}},emits:["update:modelValue"],setup(R,{emit:D}){const y=R,E=D,{fields:a,newField:t,showFieldForm:O,editingFieldIndex:N,addField:H,editField:J,removeField:z,resetFieldForm:U,addOption:I,removeOption:Q,setFields:X,ensureCategoryObject:p}=He(y.modelValue);le(()=>t.type,n=>{t.conditionalConfig||(t.conditionalConfig={enabled:!1,showWhen:"all",conditions:[]}),n==="perfil_candidatura"&&!t.perfilCandidaturaConfig&&(t.perfilCandidaturaConfig={cargo_id:void 0,periodo_electoral_id:void 0,territorio_id:void 0,departamento_id:void 0,municipio_id:void 0,localidad_id:void 0,territorios_ids:[],departamentos_ids:[],municipios_ids:[],localidades_ids:[],multiple:!1,mostrarVotoBlanco:!0}),n==="convocatoria"&&!t.convocatoriaConfig&&(t.convocatoriaConfig={convocatoria_id:void 0,multiple:!1,mostrarVotoBlanco:y.context==="votacion",filtrarPorUbicacion:y.context==="candidatura"}),n==="file"&&!t.fileConfig&&(t.fileConfig={multiple:!1,maxFiles:5,maxFileSize:10,accept:".pdf,.doc,.docx,.xls,.xlsx,.jpg,.jpeg,.png,.gif"}),n==="datepicker"&&!t.datepickerConfig&&(t.datepickerConfig={minDate:void 0,maxDate:void 0,format:"DD/MM/YYYY",allowPastDates:!0,allowFutureDates:!0}),n==="disclaimer"&&!t.disclaimerConfig&&(t.disclaimerConfig={disclaimerText:"",modalTitle:"Términos y Condiciones",acceptButtonText:"Acepto",declineButtonText:"No acepto"}),n==="repeater"&&!t.repeaterConfig&&(t.repeaterConfig={minItems:0,maxItems:10,itemName:"Elemento",addButtonText:"Agregar elemento",removeButtonText:"Eliminar",fields:[]})}),le(()=>y.modelValue,n=>{JSON.stringify(n)!==JSON.stringify(a.value)&&X(n)},{deep:!0}),le(a,n=>{E("update:modelValue",n)},{deep:!0});const d=()=>{t.title.trim()&&H()},A=()=>{N.value=null,O.value=!0,je(()=>{const n=document.getElementById("field-form-add");n&&n.scrollIntoView({behavior:"smooth",block:"center"})})},f=n=>{J(n),je(()=>{const i=document.getElementById(`field-form-edit-${n}`);i&&i.scrollIntoView({behavior:"smooth",block:"center"})})},s=ie(()=>y.context==="votacion"?ne.filter(n=>n.value!=="perfil_candidatura"):y.context==="candidatura"?ne.filter(n=>n.value!=="perfil_candidatura"):ne.filter(n=>n.value!=="convocatoria"));return Le(()=>{X(y.modelValue),t.conditionalConfig||(t.conditionalConfig={enabled:!1,showWhen:"all",conditions:[]})}),(n,i)=>(c(),v("div",da,[r("div",sa,[r("div",null,[r("h3",ra,k(n.title),1),r("p",ua,k(n.description),1)]),o(e(w),{type:"button",onClick:A,disabled:n.disabled},{default:l(()=>[o(e(oe),{class:"mr-2 h-4 w-4"}),i[18]||(i[18]=u(" Agregar Campo "))]),_:1},8,["disabled"])]),e(O)&&e(N)===null?(c(),T(e(de),{key:0,id:"field-form-add",class:"border-2 border-primary/50 shadow-lg"},{default:l(()=>[o(e(se),null,{default:l(()=>[o(e(re),{class:"flex items-center justify-between"},{default:l(()=>[i[19]||(i[19]=u(" Nuevo Campo ")),o(e(w),{type:"button",variant:"ghost",size:"sm",onClick:e(U)},{default:l(()=>[o(e(Ue),{class:"h-4 w-4"})]),_:1},8,["onClick"])]),_:1})]),_:1}),o(e(ue),{class:"space-y-4"},{default:l(()=>{var m,V,B;return[r("div",ca,[r("div",null,[o(e(b),null,{default:l(()=>i[20]||(i[20]=[u("Tipo de Campo")])),_:1}),o(e(G),{modelValue:e(t).type,"onUpdate:modelValue":i[0]||(i[0]=g=>e(t).type=g)},{default:l(()=>[o(e(L),null,{default:l(()=>[o(e(Y))]),_:1}),o(e(W),null,{default:l(()=>[(c(!0),v(h,null,M(s.value,g=>(c(),T(e(P),{key:g.value,value:g.value},{default:l(()=>[u(k(g.label),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"])]),r("div",ma,[r("div",fa,[o(e(K),{id:"field_required_add",checked:e(t).required,"onUpdate:checked":i[1]||(i[1]=g=>e(t).required=g)},null,8,["checked"]),o(e(b),null,{default:l(()=>i[21]||(i[21]=[u("Campo obligatorio")])),_:1})]),n.showEditableOption?(c(),v("div",pa,[o(e(K),{id:"field_editable_add",checked:e(t).editable,"onUpdate:checked":i[2]||(i[2]=g=>e(t).editable=g)},null,8,["checked"]),o(e(b),{class:"text-sm"},{default:l(()=>i[22]||(i[22]=[u(" Campo editable en candidaturas aprobadas "),r("span",{class:"text-muted-foreground block text-xs"}," Los usuarios podrán editar este campo incluso con candidatura aprobada ",-1)])),_:1})])):x("",!0)])]),r("div",null,[o(e(b),null,{default:l(()=>i[23]||(i[23]=[u("Título del Campo *")])),_:1}),o(e($),{id:"field_title_add",modelValue:e(t).title,"onUpdate:modelValue":i[3]||(i[3]=g=>e(t).title=g),placeholder:"Ej: ¿Cuál es tu candidato preferido?"},null,8,["modelValue"])]),r("div",null,[o(e(b),null,{default:l(()=>i[24]||(i[24]=[u("Descripción (opcional)")])),_:1}),o(e(ee),{id:"field_description_add",modelValue:e(t).description,"onUpdate:modelValue":i[4]||(i[4]=g=>e(t).description=g),placeholder:"Descripción adicional del campo",rows:"2"},null,8,["modelValue"])]),r("div",null,[o(e(b),null,{default:l(()=>i[25]||(i[25]=[u("Categoría/Dimensión (opcional)")])),_:1}),r("div",va,[o(e($),{"model-value":((m=e(t).category)==null?void 0:m.name)||"","onUpdate:modelValue":i[5]||(i[5]=g=>{e(p)(),e(t).category.name=g}),placeholder:"Ej: Dim1 - Prioridad y capacidad de gestión..."},null,8,["model-value"]),o(e($),{"model-value":((V=e(t).category)==null?void 0:V.id)||"","onUpdate:modelValue":i[6]||(i[6]=g=>{e(p)(),e(t).category.id=g}),placeholder:"ID de categoría (ej: dim1)"},null,8,["model-value"]),o(e(ee),{"model-value":((B=e(t).category)==null?void 0:B.description)||"","onUpdate:modelValue":i[7]||(i[7]=g=>{e(p)(),e(t).category.description=g}),placeholder:"Descripción de la categoría (opcional)",rows:"2"},null,8,["model-value"])]),i[26]||(i[26]=r("p",{class:"text-xs text-muted-foreground mt-1"}," La categoría permite agrupar preguntas para análisis estadístico por dimensiones. ",-1))]),["select","radio","checkbox"].includes(e(t).type)?(c(),v("div",ga,[r("div",Ca,[o(e(b),null,{default:l(()=>i[27]||(i[27]=[u("Opciones")])),_:1}),o(e(w),{type:"button",variant:"outline",size:"sm",onClick:e(I)},{default:l(()=>[o(e(oe),{class:"mr-2 h-3 w-3"}),i[28]||(i[28]=u(" Agregar Opción "))]),_:1},8,["onClick"])]),r("div",_a,[(c(!0),v(h,null,M(e(t).options,(g,_)=>(c(),v("div",{key:_,class:"flex gap-2 items-center"},[r("div",ba,[o(e($),{modelValue:e(t).options[_].label,"onUpdate:modelValue":F=>e(t).options[_].label=F,placeholder:"Texto de la opción"},null,8,["modelValue","onUpdate:modelValue"])]),r("div",ya,[o(e($),{modelValue:e(t).options[_].value,"onUpdate:modelValue":F=>e(t).options[_].value=F,modelModifiers:{number:!0},type:"number",placeholder:"Valor",class:"text-center"},null,8,["modelValue","onUpdate:modelValue"])]),o(e(w),{type:"button",variant:"outline",size:"sm",onClick:F=>e(Q)(_)},{default:l(()=>[o(e(te),{class:"h-4 w-4"})]),_:2},1032,["onClick"])]))),128)),i[29]||(i[29]=r("p",{class:"text-xs text-muted-foreground"}," El valor numérico es opcional y se usa para estadísticas y cálculos. ",-1))])])):x("",!0),["repeater","perfil_candidatura","convocatoria"].includes(e(t).type)?x("",!0):(c(),v("div",xa,[o(Oe,{modelValue:e(t).conditionalConfig,"onUpdate:modelValue":i[8]||(i[8]=g=>e(t).conditionalConfig=g),fields:e(a),"current-field-id":e(t).id||"new_field"},null,8,["modelValue","fields","current-field-id"])])),r("div",ka,[o(e(w),{type:"button",variant:"outline",onClick:e(U)},{default:l(()=>i[30]||(i[30]=[u(" Cancelar ")])),_:1},8,["onClick"]),o(e(w),{type:"button",onClick:d,disabled:!e(t).title.trim()},{default:l(()=>i[31]||(i[31]=[u(" Agregar Campo ")])),_:1},8,["disabled"])])]}),_:1})]),_:1})):x("",!0),e(a).length>0?(c(),v("div",Va,[(c(!0),v(h,null,M(e(a),(m,V)=>{var B,g;return c(),v(h,{key:m.id},[r("div",wa,[r("div",Aa,[r("div",Ta,[o(e(q),{variant:"outline"},{default:l(()=>{var _;return[u(k(((_=s.value.find(F=>F.value===m.type))==null?void 0:_.label)||m.type),1)]}),_:2},1024),m.required?(c(),v("span",Fa,"*")):x("",!0),n.showEditableOption&&m.editable?(c(),T(e(q),{key:1,variant:"secondary",class:"text-xs bg-green-100 text-green-800"},{default:l(()=>i[32]||(i[32]=[u(" Editable ")])),_:1})):x("",!0),(B=m.conditionalConfig)!=null&&B.enabled?(c(),T(e(q),{key:2,variant:"secondary",class:"text-xs bg-orange-100 text-orange-800"},{default:l(()=>[o(e(We),{class:"h-3 w-3 mr-1"}),i[33]||(i[33]=u(" Condicional "))]),_:1})):x("",!0),m.type==="convocatoria"&&((g=m.convocatoriaConfig)!=null&&g.convocatoria_id)?(c(),T(e(q),{key:3,variant:"secondary",class:"text-xs"},{default:l(()=>[u(" Conv. ID: "+k(m.convocatoriaConfig.convocatoria_id),1)]),_:2},1024)):x("",!0)]),r("h4",ha,k(m.title),1),m.description?(c(),v("p",Da,k(m.description),1)):x("",!0),m.options&&m.options.length>0?(c(),v("div",Ba,[i[34]||(i[34]=r("p",{class:"text-xs text-muted-foreground"},"Opciones:",-1)),r("div",Ea,[(c(!0),v(h,null,M(m.options,_=>(c(),T(e(q),{key:_,variant:"secondary",class:"text-xs"},{default:l(()=>[u(k(_),1)]),_:2},1024))),128))])])):x("",!0)]),r("div",$a,[o(e(w),{type:"button",variant:"ghost",size:"sm",onClick:_=>f(V),disabled:n.disabled},{default:l(()=>[o(e(Ie),{class:"h-4 w-4"})]),_:2},1032,["onClick","disabled"]),o(e(w),{type:"button",variant:"ghost",size:"sm",onClick:_=>e(z)(V),disabled:n.disabled},{default:l(()=>[o(e(te),{class:"h-4 w-4 text-destructive"})]),_:2},1032,["onClick","disabled"])])]),e(O)&&e(N)===V?(c(),T(e(de),{key:0,id:`field-form-edit-${V}`,class:"border-2 border-primary/50 shadow-lg ml-4"},{default:l(()=>[o(e(se),null,{default:l(()=>[o(e(re),{class:"flex items-center justify-between"},{default:l(()=>[i[35]||(i[35]=u(" Editar Campo ")),o(e(w),{type:"button",variant:"ghost",size:"sm",onClick:e(U)},{default:l(()=>[o(e(Ue),{class:"h-4 w-4"})]),_:1},8,["onClick"])]),_:1})]),_:1}),o(e(ue),{class:"space-y-4"},{default:l(()=>{var _,F,Z;return[r("div",Ma,[r("div",null,[o(e(b),null,{default:l(()=>i[36]||(i[36]=[u("Tipo de Campo")])),_:1}),o(e(G),{modelValue:e(t).type,"onUpdate:modelValue":i[9]||(i[9]=C=>e(t).type=C)},{default:l(()=>[o(e(L),null,{default:l(()=>[o(e(Y))]),_:1}),o(e(W),null,{default:l(()=>[(c(!0),v(h,null,M(s.value,C=>(c(),T(e(P),{key:C.value,value:C.value},{default:l(()=>[u(k(C.label),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"])]),r("div",Ua,[r("div",ja,[o(e(K),{id:`field_required_edit_${V}`,checked:e(t).required,"onUpdate:checked":i[10]||(i[10]=C=>e(t).required=C)},null,8,["id","checked"]),o(e(b),null,{default:l(()=>i[37]||(i[37]=[u("Campo obligatorio")])),_:1})]),n.showEditableOption?(c(),v("div",Oa,[o(e(K),{id:`field_editable_edit_${V}`,checked:e(t).editable,"onUpdate:checked":i[11]||(i[11]=C=>e(t).editable=C)},null,8,["id","checked"]),o(e(b),{class:"text-sm"},{default:l(()=>i[38]||(i[38]=[u(" Campo editable en candidaturas aprobadas "),r("span",{class:"text-muted-foreground block text-xs"}," Los usuarios podrán editar este campo incluso con candidatura aprobada ",-1)])),_:1})])):x("",!0)])]),r("div",null,[o(e(b),null,{default:l(()=>i[39]||(i[39]=[u("Título del Campo *")])),_:1}),o(e($),{id:`field_title_edit_${V}`,modelValue:e(t).title,"onUpdate:modelValue":i[12]||(i[12]=C=>e(t).title=C),placeholder:"Ej: ¿Cuál es tu candidato preferido?"},null,8,["id","modelValue"])]),r("div",null,[o(e(b),null,{default:l(()=>i[40]||(i[40]=[u("Descripción (opcional)")])),_:1}),o(e(ee),{id:`field_description_edit_${V}`,modelValue:e(t).description,"onUpdate:modelValue":i[13]||(i[13]=C=>e(t).description=C),placeholder:"Descripción adicional del campo",rows:"2"},null,8,["id","modelValue"])]),r("div",null,[o(e(b),null,{default:l(()=>i[41]||(i[41]=[u("Categoría/Dimensión (opcional)")])),_:1}),r("div",Na,[o(e($),{"model-value":((_=e(t).category)==null?void 0:_.name)||"","onUpdate:modelValue":i[14]||(i[14]=C=>{e(p)(),e(t).category.name=C}),placeholder:"Ej: Dim1 - Prioridad y capacidad de gestión..."},null,8,["model-value"]),o(e($),{"model-value":((F=e(t).category)==null?void 0:F.id)||"","onUpdate:modelValue":i[15]||(i[15]=C=>{e(p)(),e(t).category.id=C}),placeholder:"ID de categoría (ej: dim1)"},null,8,["model-value"]),o(e(ee),{"model-value":((Z=e(t).category)==null?void 0:Z.description)||"","onUpdate:modelValue":i[16]||(i[16]=C=>{e(p)(),e(t).category.description=C}),placeholder:"Descripción de la categoría (opcional)",rows:"2"},null,8,["model-value"])]),i[42]||(i[42]=r("p",{class:"text-xs text-muted-foreground mt-1"}," La categoría permite agrupar preguntas para análisis estadístico por dimensiones. ",-1))]),["select","radio","checkbox"].includes(e(t).type)?(c(),v("div",Ia,[r("div",Sa,[o(e(b),null,{default:l(()=>i[43]||(i[43]=[u("Opciones")])),_:1}),o(e(w),{type:"button",variant:"outline",size:"sm",onClick:e(I)},{default:l(()=>[o(e(oe),{class:"mr-2 h-3 w-3"}),i[44]||(i[44]=u(" Agregar Opción "))]),_:1},8,["onClick"])]),r("div",qa,[(c(!0),v(h,null,M(e(t).options,(C,j)=>(c(),v("div",{key:j,class:"flex gap-2 items-center"},[r("div",Pa,[o(e($),{modelValue:e(t).options[j].label,"onUpdate:modelValue":S=>e(t).options[j].label=S,placeholder:"Texto de la opción"},null,8,["modelValue","onUpdate:modelValue"])]),r("div",za,[o(e($),{modelValue:e(t).options[j].value,"onUpdate:modelValue":S=>e(t).options[j].value=S,modelModifiers:{number:!0},type:"number",placeholder:"Valor",class:"text-center"},null,8,["modelValue","onUpdate:modelValue"])]),o(e(w),{type:"button",variant:"outline",size:"sm",onClick:S=>e(Q)(j)},{default:l(()=>[o(e(te),{class:"h-4 w-4"})]),_:2},1032,["onClick"])]))),128)),i[45]||(i[45]=r("p",{class:"text-xs text-muted-foreground"}," El valor numérico es opcional y se usa para estadísticas y cálculos. ",-1))])])):x("",!0),["repeater","perfil_candidatura","convocatoria"].includes(e(t).type)?x("",!0):(c(),v("div",Ga,[o(Oe,{modelValue:e(t).conditionalConfig,"onUpdate:modelValue":i[17]||(i[17]=C=>e(t).conditionalConfig=C),fields:e(a),"current-field-id":e(t).id||"new_field"},null,8,["modelValue","fields","current-field-id"])])),r("div",La,[o(e(w),{type:"button",variant:"outline",onClick:e(U)},{default:l(()=>i[46]||(i[46]=[u(" Cancelar ")])),_:1},8,["onClick"]),o(e(w),{type:"button",onClick:d,disabled:!e(t).title.trim()},{default:l(()=>i[47]||(i[47]=[u(" Actualizar Campo ")])),_:1},8,["disabled"])])]}),_:2},1024)]),_:2},1032,["id"])):x("",!0)],64)}),128))])):(c(),v("div",Ya,i[48]||(i[48]=[r("p",null,"No hay campos configurados",-1),r("p",{class:"text-sm"},"Agrega al menos un campo para continuar",-1)])))]))}});export{ti as L,li as _};
