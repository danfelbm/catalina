import{d as J,k as T,c as Q,a as p,o as d,b as s,u as e,m as Y,e as o,f as t,g as i,z as Z,j as c,i as _,t as n,n as f,l as h,F as j,r as ee,W as H}from"./app-7LlKm78u.js";import{e as P}from"./DialogTitle.vue_vue_type_script_setup_true_lang-B5BWniUE.js";import{_ as D}from"./createLucideIcon-C3Ab61m5.js";import{_ as b,a as S,b as $,c as y}from"./index-Cmp74z6d.js";import{_ as m,a as te}from"./Label.vue_vue_type_script_setup_true_lang-CNdlZ2bU.js";import{_ as ae}from"./Separator.vue_vue_type_script_setup_true_lang-DC7xSSaX.js";import{_ as O,a as U}from"./index-DZhhYTq_.js";import{e as E,_ as se}from"./AppLayout.vue_vue_type_script_setup_true_lang-CyoQlVBv.js";import{C as g}from"./circle-check-big-Dd3mSF0w.js";import{C as w}from"./circle-x-CJJiMBFh.js";import{S as K}from"./search-CVZYmFcN.js";import{H as oe}from"./hash-uXoEw-4x.js";import{C as le}from"./copy-CNoi1FSp.js";import{C as ie}from"./clock-BnjXW5pn.js";import{T as ne}from"./triangle-alert-i3CMzRfx.js";import{E as re}from"./external-link-B-6KQw_T.js";import"./VisuallyHidden-BQiVCHMw.js";import"./index-BLTdg2QY.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-Cne8tvjX.js";const de={class:"flex h-full flex-1 flex-col gap-6 rounded-xl p-4"},ue={class:"text-center"},ce={class:"text-4xl font-bold flex items-center justify-center gap-3"},fe={class:"space-y-4"},me={class:"flex gap-2"},ve={key:0,class:"max-w-4xl mx-auto w-full space-y-6"},pe={class:"flex items-center gap-4"},_e={class:"flex-1"},ge={class:"space-y-4"},xe={class:"flex items-center gap-2"},ke={class:"text-xs font-mono bg-muted p-3 rounded flex-1 break-all"},he={class:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm"},be={class:"flex items-center gap-1"},ye={class:"flex items-center gap-1"},we={class:"flex items-center gap-1"},Ce={class:"flex items-center gap-1"},Ve={class:"space-y-4"},Te={key:0,class:"text-muted-foreground"},Se={class:"flex flex-wrap gap-4 text-sm"},$e={class:"flex items-center gap-2"},Ie={class:"flex items-center gap-2 text-muted-foreground"},De={class:"space-y-6"},Ee={class:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm mb-6"},qe={class:"font-medium"},Ae={class:"font-mono text-xs break-all bg-muted p-2 rounded"},Fe={class:"space-y-6"},Le={class:"flex items-start justify-between"},Ne={class:"flex-1"},ze={key:0,class:"text-red-500"},Be={key:0,class:"text-sm text-muted-foreground mt-1"},Re={class:"bg-muted/30 rounded-lg p-4"},je={class:"text-lg"},He={key:1,class:"max-w-2xl mx-auto text-center space-y-4"},Pe={class:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm"},Oe={class:"text-center p-4"},Ue={class:"text-center p-4"},Ke={class:"text-center p-4"},ct=J({__name:"VerificarToken",props:{token:{},verification:{}},setup(W){const q=W,x=T(q.token||""),C=T(!1),l=T(q.verification||null),v=Q(()=>{if(!l.value)return null;const u=l.value;return u.is_valid?{icon:g,color:"text-green-600",bgColor:"bg-green-50",borderColor:"border-green-200",label:"VÁLIDO",description:"Token verificado criptográficamente"}:{icon:w,color:"text-red-600",bgColor:"bg-red-50",borderColor:"border-red-200",label:"INVÁLIDO",description:u.error||"Token no válido o corrupto"}}),A=()=>{x.value.trim()&&(C.value=!0,H.get(`/verificar-token/${encodeURIComponent(x.value.trim())}`,{},{onFinish:()=>{C.value=!1}}))},I=u=>new Date(u).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"}),M=(u,a)=>!a&&a!==0?"Sin respuesta":u.type==="checkbox"?Array.isArray(a)&&a.length>0?a.join(", "):"Sin respuesta":a.toString(),V=T(!1),X=async()=>{var u;if((u=l.value)!=null&&u.token)try{await navigator.clipboard.writeText(l.value.token),V.value=!0,setTimeout(()=>{V.value=!1},2e3)}catch(a){console.error("Error al copiar token:",a)}},G=()=>{x.value="",l.value=null,H.get("/verificar-token")};return(u,a)=>(d(),p(j,null,[s(e(Y),{title:"Verificación de Tokens de Votación"}),s(se,null,{default:o(()=>{var F,L;return[t("div",de,[t("div",ue,[t("h1",ce,[s(e(E),{class:"h-10 w-10 text-blue-600"}),a[1]||(a[1]=i(" Verificación de Tokens "))]),a[2]||(a[2]=t("p",{class:"text-muted-foreground mt-2 max-w-2xl mx-auto"}," Verifica la autenticidad e integridad de cualquier token de votación de forma pública y anónima. Utiliza criptografía digital para garantizar que los votos no han sido alterados. ",-1))]),s(e(b),{class:"max-w-2xl mx-auto w-full"},{default:o(()=>[s(e(S),null,{default:o(()=>[s(e($),{class:"flex items-center gap-2"},{default:o(()=>[s(e(K),{class:"h-5 w-5"}),a[3]||(a[3]=i(" Buscar Token "))]),_:1})]),_:1}),s(e(y),null,{default:o(()=>[t("div",fe,[t("div",null,[s(e(m),{for:"token-input"},{default:o(()=>a[4]||(a[4]=[i("Token de Votación")])),_:1}),s(e(te),{id:"token-input",modelValue:x.value,"onUpdate:modelValue":a[0]||(a[0]=r=>x.value=r),placeholder:"Pega aquí tu token de votación para verificar...",onKeyup:Z(A,["enter"]),class:"font-mono text-sm"},null,8,["modelValue"])]),t("div",me,[s(e(D),{onClick:A,disabled:!x.value.trim()||C.value,class:"flex-1"},{default:o(()=>[s(e(K),{class:"mr-2 h-4 w-4"}),i(" "+n(C.value?"Verificando...":"Verificar Token"),1)]),_:1},8,["disabled"]),l.value?(d(),c(e(D),{key:0,onClick:G,variant:"outline"},{default:o(()=>a[5]||(a[5]=[i(" Limpiar ")])),_:1})):_("",!0)])])]),_:1})]),_:1}),l.value?(d(),p("div",ve,[s(e(b),{class:f([(F=v.value)==null?void 0:F.borderColor,(L=v.value)==null?void 0:L.bgColor])},{default:o(()=>[s(e(y),{class:"pt-6"},{default:o(()=>{var r,k,N,z,B,R;return[t("div",pe,[(d(),c(h((r=v.value)==null?void 0:r.icon),{class:f(["h-12 w-12",(k=v.value)==null?void 0:k.color])},null,8,["class"])),t("div",_e,[t("h2",{class:f(["text-2xl font-bold",(N=v.value)==null?void 0:N.color])},n((z=v.value)==null?void 0:z.label),3),t("p",{class:f(["text-sm",(B=v.value)==null?void 0:B.color])},n((R=v.value)==null?void 0:R.description),3)])])]}),_:1})]),_:1},8,["class"]),s(e(b),null,{default:o(()=>[s(e(S),null,{default:o(()=>[s(e($),{class:"flex items-center gap-2"},{default:o(()=>[s(e(oe),{class:"h-5 w-5"}),a[6]||(a[6]=i(" Información del Token "))]),_:1})]),_:1}),s(e(y),null,{default:o(()=>[t("div",ge,[t("div",null,[s(e(m),{class:"text-sm font-medium text-muted-foreground"},{default:o(()=>a[7]||(a[7]=[i("Token")])),_:1}),t("div",xe,[t("p",ke,n(l.value.token),1),s(e(D),{variant:"outline",size:"sm",onClick:X,class:f({"bg-green-50 border-green-200":V.value})},{default:o(()=>[s(e(le),{class:"h-4 w-4"}),i(" "+n(V.value?"Copiado!":"Copiar"),1)]),_:1},8,["class"])])]),t("div",he,[t("div",null,[s(e(m),{class:"text-muted-foreground"},{default:o(()=>a[8]||(a[8]=[i("Formato")])),_:1}),t("div",be,[(d(),c(h(l.value.verification_details.format_valid?e(g):e(w)),{class:f(["h-4 w-4",l.value.verification_details.format_valid?"text-green-600":"text-red-600"])},null,8,["class"])),t("span",null,n(l.value.verification_details.format_valid?"Válido":"Inválido"),1)])]),t("div",null,[s(e(m),{class:"text-muted-foreground"},{default:o(()=>a[9]||(a[9]=[i("Firma Digital")])),_:1}),t("div",ye,[(d(),c(h(l.value.verification_details.signature_valid?e(g):e(w)),{class:f(["h-4 w-4",l.value.verification_details.signature_valid?"text-green-600":"text-red-600"])},null,8,["class"])),t("span",null,n(l.value.verification_details.signature_valid?"Válida":"Inválida"),1)])]),t("div",null,[s(e(m),{class:"text-muted-foreground"},{default:o(()=>a[10]||(a[10]=[i("Integridad")])),_:1}),t("div",we,[(d(),c(h(l.value.verification_details.hash_valid?e(g):e(w)),{class:f(["h-4 w-4",l.value.verification_details.hash_valid?"text-green-600":"text-red-600"])},null,8,["class"])),t("span",null,n(l.value.verification_details.hash_valid?"Íntegro":"Alterado"),1)])]),t("div",null,[s(e(m),{class:"text-muted-foreground"},{default:o(()=>a[11]||(a[11]=[i("Votación")])),_:1}),t("div",Ce,[(d(),c(h(l.value.verification_details.votacion_exists?e(g):e(w)),{class:f(["h-4 w-4",l.value.verification_details.votacion_exists?"text-green-600":"text-red-600"])},null,8,["class"])),t("span",null,n(l.value.verification_details.votacion_exists?"Existe":"No existe"),1)])])])])]),_:1})]),_:1}),l.value.votacion?(d(),c(e(b),{key:0},{default:o(()=>[s(e(S),null,{default:o(()=>[s(e($),null,{default:o(()=>[i(n(l.value.votacion.titulo),1)]),_:1})]),_:1}),s(e(y),null,{default:o(()=>[t("div",Ve,[l.value.votacion.descripcion?(d(),p("p",Te,n(l.value.votacion.descripcion),1)):_("",!0),t("div",Se,[t("div",$e,[s(e(P),{variant:"outline"},{default:o(()=>[i(n(l.value.votacion.categoria),1)]),_:1})]),t("div",Ie,[s(e(ie),{class:"h-4 w-4"}),i(" "+n(I(l.value.votacion.fecha_inicio))+" - "+n(I(l.value.votacion.fecha_fin)),1)])])])]),_:1})]),_:1})):_("",!0),l.value.vote_data&&l.value.votacion?(d(),c(e(b),{key:1},{default:o(()=>[s(e(S),null,{default:o(()=>[s(e($),{class:"flex items-center gap-2"},{default:o(()=>[s(e(g),{class:"h-5 w-5"}),a[12]||(a[12]=i(" Respuestas del Voto "))]),_:1})]),_:1}),s(e(y),null,{default:o(()=>[t("div",De,[t("div",Ee,[t("div",null,[s(e(m),{class:"text-muted-foreground"},{default:o(()=>a[13]||(a[13]=[i("Fecha del Voto")])),_:1}),t("p",qe,n(I(l.value.vote_data.timestamp)),1)]),t("div",null,[s(e(m),{class:"text-muted-foreground"},{default:o(()=>a[14]||(a[14]=[i("Hash de Verificación")])),_:1}),t("p",Ae,n(l.value.vote_data.vote_hash),1)])]),t("div",Fe,[(d(!0),p(j,null,ee(l.value.votacion.formulario_config,(r,k)=>(d(),p("div",{key:r.id,class:"space-y-2"},[t("div",Le,[t("div",Ne,[s(e(m),{class:"text-base font-medium"},{default:o(()=>[i(n(k+1)+". "+n(r.title)+" ",1),r.required?(d(),p("span",ze,"*")):_("",!0)]),_:2},1024),r.description?(d(),p("p",Be,n(r.description),1)):_("",!0)]),s(e(P),{variant:"secondary",class:"ml-4"},{default:o(()=>[i(n(r.type==="text"?"Texto":r.type==="textarea"?"Texto largo":r.type==="select"?"Selección":r.type==="radio"?"Opción única":r.type==="checkbox"?"Múltiple":r.type),1)]),_:2},1024)]),t("div",Re,[t("p",je,n(M(r,l.value.vote_data.respuestas[r.id])),1)]),k<l.value.votacion.formulario_config.length-1?(d(),c(e(ae),{key:0,class:"mt-6"})):_("",!0)]))),128))])])]),_:1})]),_:1})):_("",!0),s(e(O),null,{default:o(()=>[s(e(E),{class:"h-4 w-4"}),s(e(U),null,{default:o(()=>a[15]||(a[15]=[t("strong",null,"Verificación criptográfica:",-1),i(" Este token ha sido verificado usando criptografía digital RSA-2048 con SHA-256. La verificación confirma que el voto proviene del sistema oficial y no ha sido alterado. "),t("br",null,null,-1),t("br",null,null,-1),t("strong",null,"Privacidad:",-1),i(" Esta verificación es completamente anónima. No se puede determinar la identidad del votante a partir de este token. ")])),_:1})]),_:1})])):(d(),p("div",He,[s(e(O),null,{default:o(()=>[s(e(ne),{class:"h-4 w-4"}),s(e(U),null,{default:o(()=>a[16]||(a[16]=[t("strong",null,"¿Cómo funciona?",-1),t("br",null,null,-1),i(" Cada voto genera un token firmado digitalmente que contiene las respuestas del formulario. Puedes verificar públicamente que tu voto fue procesado correctamente sin revelar tu identidad. ")])),_:1})]),_:1}),t("div",Pe,[t("div",Oe,[s(e(E),{class:"h-8 w-8 text-blue-600 mx-auto mb-2"}),a[17]||(a[17]=t("h3",{class:"font-medium"},"Seguridad",-1)),a[18]||(a[18]=t("p",{class:"text-muted-foreground"},"Criptografía RSA-2048",-1))]),t("div",Ue,[s(e(g),{class:"h-8 w-8 text-green-600 mx-auto mb-2"}),a[19]||(a[19]=t("h3",{class:"font-medium"},"Verificable",-1)),a[20]||(a[20]=t("p",{class:"text-muted-foreground"},"Integridad garantizada",-1))]),t("div",Ke,[s(e(re),{class:"h-8 w-8 text-purple-600 mx-auto mb-2"}),a[21]||(a[21]=t("h3",{class:"font-medium"},"Público",-1)),a[22]||(a[22]=t("p",{class:"text-muted-foreground"},"Sin autenticación",-1))])])]))])]}),_:1})],64))}});export{ct as default};
