import{w as $,m as z,e as y,l as N}from"./DialogTitle.vue_vue_type_script_setup_true_lang-D_nilgK0.js";import{_ as h}from"./createLucideIcon-CjSnWMAs.js";import{_ as O,c as Q}from"./index-11KoE7K9.js";import{_ as Y}from"./Switch.vue_vue_type_script_setup_true_lang--zaGdFmE.js";import{_ as K,a as X,b as S,c as b,d as Z,e as g}from"./TableHeader.vue_vue_type_script_setup_true_lang-D-8H6Bdo.js";import{V as ee,b as te,_ as se}from"./AppLayout.vue_vue_type_script_setup_true_lang-DGUFgy7V.js";import{d as ae,k as D,c as le,a as k,o,b as a,u as t,m as ie,e as l,f as r,i as v,g as n,n as x,j as c,t as _,F,r as B,l as re,W as w}from"./app-DaeX7cdw.js";import{_ as oe}from"./AdvancedFilters.vue_vue_type_script_setup_true_lang-DU48liqG.js";import{C as L}from"./clock-DeWG7NZQ.js";import{C as A}from"./circle-check-big-_OEhV1Vs.js";import"./VisuallyHidden-Dq3uFg-l.js";import"./Label.vue_vue_type_script_setup_true_lang-CMHm9R99.js";import"./index-D0dABG5H.js";import"./VisuallyHiddenInput-B3mveJf9.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-Cwg8ppLD.js";import"./CardDescription.vue_vue_type_script_setup_true_lang-D2c5TVWn.js";import"./DialogTrigger.vue_vue_type_script_setup_true_lang-BlODKxj6.js";import"./es-DfN3vIXC.js";import"./DateTimePicker.vue_vue_type_script_setup_true_lang-CuN1rDYL.js";import"./loader-circle-BUiClZo0.js";import"./trash-2-EKkXpNpQ.js";import"./plus-BJOEnpvP.js";import"./search-BEvrLSqB.js";import"./filter-slYbXTkk.js";import"./history-CLBzjG_8.js";import"./save-DZF9BgZ1.js";const ne={class:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4"},de={class:"flex items-center gap-4 mb-4"},ue={class:"flex items-center space-x-2"},ce={class:"relative min-h-[50vh] flex-1 overflow-hidden rounded-xl border border-sidebar-border/70 dark:border-sidebar-border"},fe={class:"rounded-md border"},me={class:"flex items-center gap-1"},_e={class:"flex flex-col"},pe={class:"flex items-center gap-1"},ve={class:"flex flex-col"},xe={class:"flex items-center gap-1"},ge={class:"flex flex-col"},he={class:"flex items-center gap-2 mb-1"},be={class:"font-medium"},ye={key:0,class:"text-sm text-muted-foreground"},ke={class:"text-sm"},we={class:"text-sm"},Ce={class:"flex items-center gap-2"},Ve={class:"flex justify-end gap-2"},$e={key:0,class:"flex items-center justify-between mt-4"},ze={class:"text-sm text-muted-foreground"},Se={class:"flex gap-2"},tt=ae({__name:"Index",props:{votaciones:{},categorias:{},filters:{},mostrar_pasadas:{type:Boolean},filterFieldsConfig:{}},setup(T){const d=T,P=[{title:"Dashboard",href:"/dashboard"},{title:"Mis Votaciones",href:"/votaciones"}],C=D(d.mostrar_pasadas||!1),{route:j}=window,E={fields:d.filterFieldsConfig||[],showQuickSearch:!0,quickSearchPlaceholder:"Buscar por título o descripción...",quickSearchFields:["titulo","descripcion"],maxNestingLevel:2,allowSaveFilters:!0,debounceTime:500,autoApply:!1},f=D("fecha_inicio"),m=D("asc"),V=i=>{f.value===i?m.value=m.value==="asc"?"desc":"asc":(f.value=i,m.value="asc")},q=le(()=>[...d.votaciones.data].sort((s,e)=>{let u,p;switch(f.value){case"fecha_inicio":u=new Date(s.fecha_inicio),p=new Date(e.fecha_inicio);break;case"fecha_fin":u=new Date(s.fecha_fin),p=new Date(e.fecha_fin);break;case"titulo":u=s.titulo.toLowerCase(),p=e.titulo.toLowerCase();break;default:u=s[f.value],p=e[f.value]}return u<p?m.value==="asc"?-1:1:u>p?m.value==="asc"?1:-1:0})),H=()=>{w.get("/votaciones",{...d.filters,mostrar_pasadas:C.value||void 0},{preserveState:!0,replace:!0})},I=i=>{w.get(`/votaciones/${i}/votar`)},R=i=>{w.get(`/votaciones/${i}/mi-voto`)},U=i=>{w.get(`/votaciones/${i}/resultados`)},W=i=>i.ya_voto?A:i.ha_finalizado?N:L,G=i=>i.ya_voto?"default":i.ha_finalizado?"destructive":"secondary",J=i=>i.ya_voto?i.ha_finalizado?"Voté (Finalizada)":"Ya voté":i.ha_finalizado?"Expirada":"Disponible",M=i=>new Date(i).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return(i,s)=>(o(),k(F,null,[a(t(ie),{title:"Mis Votaciones"}),a(se,{breadcrumbs:P},{default:l(()=>[r("div",ne,[s[19]||(s[19]=r("div",{class:"flex items-center justify-between"},[r("div",null,[r("h1",{class:"text-3xl font-bold"},"Mis Votaciones"),r("p",{class:"text-muted-foreground"}," Votaciones disponibles para mi participación ")])],-1)),r("div",de,[a(oe,{config:E,route:t(j)("votaciones.index"),"initial-filters":{quickSearch:i.filters.search,rootGroup:i.filters.advanced_filters?JSON.parse(i.filters.advanced_filters):void 0},class:"flex-1"},null,8,["route","initial-filters"]),r("div",ue,[a(t(Y),{id:"mostrar-pasadas",modelValue:C.value,"onUpdate:modelValue":[s[0]||(s[0]=e=>C.value=e),H]},null,8,["modelValue"]),s[4]||(s[4]=r("label",{for:"mostrar-pasadas",class:"text-sm font-medium whitespace-nowrap"}," Ver historial ",-1))])]),r("div",ce,[a(t(O),{class:"border-0 shadow-none h-full"},{default:l(()=>[a(t(Q),{class:"pt-6"},{default:l(()=>[r("div",fe,[a(t(K),null,{default:l(()=>[a(t(X),null,{default:l(()=>[a(t(S),null,{default:l(()=>[a(t(b),{class:"cursor-pointer select-none hover:bg-muted/50",onClick:s[1]||(s[1]=e=>V("titulo"))},{default:l(()=>[r("div",me,[s[5]||(s[5]=n(" Título ")),r("div",_e,[a(t($),{class:x(["h-3 w-3",{"text-primary":f.value==="titulo"&&m.value==="asc"}])},null,8,["class"]),a(t(z),{class:x(["h-3 w-3 -mt-1",{"text-primary":f.value==="titulo"&&m.value==="desc"}])},null,8,["class"])])])]),_:1}),a(t(b),null,{default:l(()=>s[6]||(s[6]=[n("Categoría")])),_:1}),a(t(b),{class:"cursor-pointer select-none hover:bg-muted/50",onClick:s[2]||(s[2]=e=>V("fecha_inicio"))},{default:l(()=>[r("div",pe,[s[7]||(s[7]=n(" Fecha de Apertura ")),r("div",ve,[a(t($),{class:x(["h-3 w-3",{"text-primary":f.value==="fecha_inicio"&&m.value==="asc"}])},null,8,["class"]),a(t(z),{class:x(["h-3 w-3 -mt-1",{"text-primary":f.value==="fecha_inicio"&&m.value==="desc"}])},null,8,["class"])])])]),_:1}),a(t(b),{class:"cursor-pointer select-none hover:bg-muted/50",onClick:s[3]||(s[3]=e=>V("fecha_fin"))},{default:l(()=>[r("div",xe,[s[8]||(s[8]=n(" Fecha Límite ")),r("div",ge,[a(t($),{class:x(["h-3 w-3",{"text-primary":f.value==="fecha_fin"&&m.value==="asc"}])},null,8,["class"]),a(t(z),{class:x(["h-3 w-3 -mt-1",{"text-primary":f.value==="fecha_fin"&&m.value==="desc"}])},null,8,["class"])])])]),_:1}),a(t(b),null,{default:l(()=>s[9]||(s[9]=[n("Mi Estado")])),_:1}),a(t(b),{class:"text-right"},{default:l(()=>s[10]||(s[10]=[n("Acción")])),_:1})]),_:1})]),_:1}),a(t(Z),null,{default:l(()=>[d.votaciones.data.length===0?(o(),c(t(S),{key:0},{default:l(()=>[a(t(g),{colspan:6,class:"text-center py-8 text-muted-foreground"},{default:l(()=>[n(_(C.value?"No tienes historial de votaciones":"No tienes votaciones disponibles en este momento"),1)]),_:1})]),_:1})):v("",!0),(o(!0),k(F,null,B(q.value,e=>(o(),c(t(S),{key:e.id,class:x({"opacity-75":e.ha_finalizado,"bg-green-50/50 dark:bg-green-950/10":e.ya_voto&&!e.ha_finalizado,"bg-blue-50/50 dark:bg-blue-950/10":e.puede_votar})},{default:l(()=>[a(t(g),null,{default:l(()=>{var u,p;return[r("div",null,[r("div",he,[r("p",be,_(e.titulo),1),e.estado_visual==="finalizada"?(o(),c(t(y),{key:0,variant:"secondary",class:"text-xs"},{default:l(()=>s[11]||(s[11]=[n(" Finalizada ")])),_:1})):e.estado_visual==="activa"?(o(),c(t(y),{key:1,variant:"default",class:"text-xs"},{default:l(()=>s[12]||(s[12]=[n(" Activa ")])),_:1})):e.estado_visual==="pendiente"?(o(),c(t(y),{key:2,variant:"outline",class:"text-xs"},{default:l(()=>s[13]||(s[13]=[n(" Pendiente ")])),_:1})):v("",!0)]),e.descripcion?(o(),k("p",ye,_((u=e.descripcion)==null?void 0:u.substring(0,80))+_(((p=e.descripcion)==null?void 0:p.length)>80?"...":""),1)):v("",!0)])]}),_:2},1024),a(t(g),null,{default:l(()=>[a(t(y),{variant:"outline"},{default:l(()=>[n(_(e.categoria.nombre),1)]),_:2},1024)]),_:2},1024),a(t(g),null,{default:l(()=>[r("div",ke,_(M(e.fecha_inicio)),1)]),_:2},1024),a(t(g),null,{default:l(()=>[r("div",we,_(M(e.fecha_fin)),1)]),_:2},1024),a(t(g),null,{default:l(()=>[r("div",Ce,[(o(),c(re(W(e)),{class:x(["h-4 w-4",{"text-green-600":e.ya_voto,"text-orange-600":e.puede_votar,"text-red-600":!e.puede_votar&&!e.ya_voto}])},null,8,["class"])),a(t(y),{variant:G(e)},{default:l(()=>[n(_(J(e)),1)]),_:2},1032,["variant"])])]),_:2},1024),a(t(g),{class:"text-right"},{default:l(()=>[r("div",Ve,[e.puede_votar?(o(),c(t(h),{key:0,onClick:u=>I(e.id),size:"sm"},{default:l(()=>[a(t(ee),{class:"mr-2 h-4 w-4"}),s[14]||(s[14]=n(" Votar "))]),_:2},1032,["onClick"])):v("",!0),e.estado_visual==="pendiente"?(o(),c(t(h),{key:1,variant:"outline",size:"sm",disabled:"",class:"cursor-not-allowed"},{default:l(()=>[a(t(L),{class:"mr-2 h-4 w-4"}),s[15]||(s[15]=n(" Próximamente "))]),_:1})):v("",!0),e.puede_ver_voto?(o(),c(t(h),{key:2,onClick:u=>R(e.id),variant:"outline",size:"sm"},{default:l(()=>[a(t(A),{class:"mr-2 h-4 w-4"}),s[16]||(s[16]=n(" Ver mi voto "))]),_:2},1032,["onClick"])):v("",!0),e.resultados_visibles?(o(),c(t(h),{key:3,onClick:u=>U(e.id),variant:"default",size:"sm",class:"bg-blue-600 hover:bg-blue-700 text-white"},{default:l(()=>[a(t(te),{class:"mr-2 h-4 w-4"}),s[17]||(s[17]=n(" Ver Resultados "))]),_:2},1032,["onClick"])):v("",!0),e.ha_finalizado&&!e.ya_voto?(o(),c(t(h),{key:4,variant:"outline",size:"sm",disabled:""},{default:l(()=>[a(t(N),{class:"mr-2 h-4 w-4"}),s[18]||(s[18]=n(" No participé "))]),_:1})):v("",!0)])]),_:2},1024)]),_:2},1032,["class"]))),128))]),_:1})]),_:1})]),d.votaciones.last_page>1?(o(),k("div",$e,[r("p",ze," Mostrando "+_((d.votaciones.current_page-1)*d.votaciones.per_page+1)+" a "+_(Math.min(d.votaciones.current_page*d.votaciones.per_page,d.votaciones.total))+" de "+_(d.votaciones.total)+" resultados ",1),r("div",Se,[(o(!0),k(F,null,B(d.votaciones.links,e=>(o(),c(t(h),{key:e.label,variant:e.active?"default":"outline",disabled:!e.url,size:"sm",onClick:u=>e.url&&t(w).get(e.url),innerHTML:e.label},null,8,["variant","disabled","onClick","innerHTML"]))),128))])])):v("",!0)]),_:1})]),_:1})])])]),_:1})],64))}});export{tt as default};
