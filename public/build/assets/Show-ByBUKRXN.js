import{e as W,U as he,C as pe,f as se,g as oe,h as le,i as ne,j as ie,k as de}from"./DialogTitle.vue_vue_type_script_setup_true_lang-BJmCMDA5.js";import{c as fe,_ as x}from"./createLucideIcon-BvZ_hvef.js";import{c as F,F as ve,_ as E,a as D,b as B}from"./index-d0hLCKZ5.js";import{_ as A}from"./Label.vue_vue_type_script_setup_true_lang-DWSITdM-.js";import{_ as M}from"./Textarea.vue_vue_type_script_setup_true_lang-B7yoDa-3.js";import{_ as xe}from"./HistorialCandidatura.vue_vue_type_script_setup_true_lang-CmZy53wM.js";import{E as ke}from"./eye-BWZ8xxBI.js";import{D as $e}from"./download-Ce72Hv22.js";import{E as we}from"./external-link-BUUfXrcR.js";import{d as Q,c as S,a as p,o as n,i as y,f as r,t as i,F as U,r as J,j as $,e as s,b as a,u as e,n as O,g as c,l as be,k as R,s as Ce,C as ee,m as Ae,W as ue,v as ze}from"./app-Bb-Y6LhL.js";import{U as G}from"./user-I1Skp-X3.js";import{P as je,B as Se,_ as Ve}from"./AppLayout.vue_vue_type_script_setup_true_lang-DTYZkdXV.js";import{M as Fe}from"./mail-D3JOP93c.js";import{H as Ee}from"./hash-BqbCx9nU.js";import{C as ge}from"./clock-BQZ0xLwo.js";import{C as q}from"./circle-check-big-BdmmfsEy.js";import{C as H}from"./circle-x-D63I-OC3.js";import{M as _e}from"./message-square-DALD-B-k.js";import{A as Ne}from"./arrow-left-IP-hC6Jt.js";import{T as ce}from"./triangle-alert-Tu4NnIlX.js";import"./VisuallyHidden-L7TC28di.js";import"./index-DWJW35C-.js";import"./Skeleton.vue_vue_type_script_setup_true_lang-CBTWwTaL.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-8zVYKdCX.js";/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const De=fe("SquareCheckBigIcon",[["path",{d:"M21 10.5V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.5",key:"1uzm8b"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=fe("Undo2Icon",[["path",{d:"M9 14 4 9l5-5",key:"102s5s"}],["path",{d:"M4 9h10.5a5.5 5.5 0 0 1 5.5 5.5a5.5 5.5 0 0 1-5.5 5.5H11",key:"f3b9sd"}]]),Re={class:"space-y-2"},Le={key:0},Te={class:"text-sm font-medium text-gray-700 dark:text-gray-300"},Be={key:1,class:"text-sm text-muted-foreground italic"},Ue={key:2,class:"space-y-2"},Oe={class:"flex items-center justify-between"},Pe={class:"flex items-center space-x-3 flex-1 min-w-0"},Ie={class:"flex-shrink-0"},Me={class:"flex-1 min-w-0"},qe={class:"text-sm font-medium text-gray-900 dark:text-gray-100 truncate"},He={class:"flex items-center space-x-1 flex-shrink-0"},X=Q({__name:"FileFieldDisplay",props:{value:{},label:{},showLabel:{type:Boolean,default:!1}},setup(L){const _=L,v=S(()=>{if(!_.value)return[];if(Array.isArray(_.value))return _.value.map((o,b)=>{const f=N(o);return{id:`file_${b}`,name:f,path:o,url:o.startsWith("http")?o:`/storage/${o}`,extension:w(f)}});if(typeof _.value=="string"){const o=N(_.value);return[{id:"file_0",name:o,path:_.value,url:_.value.startsWith("http")?_.value:`/storage/${_.value}`,extension:w(o)}]}return[]}),N=o=>{if(!o)return"archivo";const b=o.split("/");return b[b.length-1]||"archivo"},w=o=>{const b=o.split(".");return b.length>1?b[b.length-1].toLowerCase():""},z=o=>{switch(o){case"pdf":return"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200";case"doc":case"docx":return"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200";case"xls":case"xlsx":return"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200";case"jpg":case"jpeg":case"png":case"gif":return"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200";default:return"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200"}},h=o=>{window.open(o,"_blank")},d=(o,b)=>{const f=document.createElement("a");f.href=o+"?download=true",f.download=b,f.target="_blank",document.body.appendChild(f),f.click(),document.body.removeChild(f)};return(o,b)=>(n(),p("div",Re,[o.showLabel&&o.label?(n(),p("div",Le,[r("label",Te,i(o.label),1)])):y("",!0),v.value.length===0?(n(),p("div",Be," No hay archivos adjuntos ")):(n(),p("div",Ue,[(n(!0),p(U,null,J(v.value,f=>(n(),$(e(E),{key:f.id,class:"hover:shadow-md transition-shadow duration-200"},{default:s(()=>[a(e(F),{class:"p-3"},{default:s(()=>[r("div",Oe,[r("div",Pe,[r("div",Ie,[a(e(ve),{class:"h-8 w-8 text-red-500"})]),r("div",Me,[r("p",qe,i(f.name),1),a(e(W),{class:O([z(f.extension),"mt-1"])},{default:s(()=>[c(i(f.extension.toUpperCase()),1)]),_:2},1032,["class"])])]),r("div",He,[a(e(x),{variant:"ghost",size:"sm",onClick:k=>h(f.url),class:"hover:bg-blue-50 dark:hover:bg-blue-900",title:"Ver archivo"},{default:s(()=>[a(e(ke),{class:"h-4 w-4"}),b[0]||(b[0]=r("span",{class:"ml-1 hidden sm:inline"},"Ver",-1))]),_:2},1032,["onClick"]),a(e(x),{variant:"ghost",size:"sm",onClick:k=>d(f.url,f.name),class:"hover:bg-green-50 dark:hover:bg-green-900",title:"Descargar archivo"},{default:s(()=>[a(e($e),{class:"h-4 w-4"}),b[1]||(b[1]=r("span",{class:"ml-1 hidden sm:inline"},"Descargar",-1))]),_:2},1032,["onClick"]),a(e(x),{variant:"ghost",size:"sm",onClick:k=>h(f.url),class:"hover:bg-purple-50 dark:hover:bg-purple-900",title:"Abrir en nueva pestaña"},{default:s(()=>[a(e(we),{class:"h-4 w-4"})]),_:2},1032,["onClick"])])])]),_:2},1024)]),_:2},1024))),128))]))]))}}),We={class:"space-y-2"},Je={key:0,class:"flex items-center gap-2"},Xe={class:"text-sm font-medium text-gray-700 dark:text-gray-300"},Ke={key:1,class:"text-sm text-muted-foreground italic"},Ge={key:2,class:"space-y-3"},Qe={class:"flex items-center justify-between"},Ye={class:"flex items-center gap-2"},Ze={class:"flex items-center gap-2 min-w-[140px]"},ea={class:"flex-1"},aa={key:0,class:"text-sm text-muted-foreground italic"},K=Q({__name:"RepeaterFieldDisplay",props:{value:{},label:{},showLabel:{type:Boolean,default:!1},fields:{},itemName:{default:"Elemento"}},setup(L){const _=L,v=S(()=>_.value?Array.isArray(_.value)?_.value.map((d,o)=>d.id&&d.data?d:{id:`item_${o}`,data:d}):[]:[]),N=(d,o)=>{if(d==null||d==="")return"No especificado";if(Array.isArray(d))return d.join(", ");if(o&&(o.includes("fecha")||o.includes("date")))try{return new Date(d).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric"})}catch{return d.toString()}return typeof d=="boolean"?d?"Sí":"No":d.toString()},w=d=>{if(_.fields&&_.fields.length>0){const o=_.fields.find(b=>b.id===d);if(o)return o.title}return d.replace(/_/g," ").replace(/\b\w/g,o=>o.toUpperCase()).replace(/Id$/i,"").replace(/Contacto$/i,"").trim()},z=d=>{const o=d.toLowerCase();return o.includes("nombre")||o.includes("name")?G:o.includes("telefono")||o.includes("phone")||o.includes("celular")?je:o.includes("email")||o.includes("correo")?Fe:o.includes("fecha")||o.includes("date")?pe:o.includes("numero")||o.includes("cantidad")?Ee:o.includes("documento")||o.includes("cedula")?ve:o.includes("cargo")||o.includes("empresa")||o.includes("trabajo")?Se:null},h=d=>["nombre","name","titulo","title","cargo","empresa"].some(b=>d.toLowerCase().includes(b));return(d,o)=>(n(),p("div",We,[d.showLabel&&d.label?(n(),p("div",Je,[a(e(he),{class:"h-4 w-4 text-muted-foreground"}),r("label",Xe,i(d.label),1),a(e(W),{variant:"secondary",class:"ml-2"},{default:s(()=>[c(i(v.value.length)+" "+i(v.value.length===1?d.itemName:`${d.itemName}s`),1)]),_:1})])):y("",!0),v.value.length===0?(n(),p("div",Ke," No hay "+i(d.itemName.toLowerCase())+"s registrados ",1)):(n(),p("div",Ge,[(n(!0),p(U,null,J(v.value,(b,f)=>(n(),$(e(E),{key:b.id,class:"hover:shadow-md transition-all duration-200"},{default:s(()=>[a(e(D),{class:"pb-3"},{default:s(()=>[r("div",Qe,[r("div",Ye,[a(e(W),{variant:"outline",class:"font-normal"},{default:s(()=>[c(i(d.itemName)+" "+i(f+1),1)]),_:2},1024)])])]),_:2},1024),a(e(F),{class:"space-y-3"},{default:s(()=>[(n(!0),p(U,null,J(b.data,(k,V)=>(n(),p("div",{key:V,class:"flex flex-col sm:flex-row sm:items-start gap-2"},[r("div",Ze,[z(String(V))?(n(),$(be(z(String(V))),{key:0,class:"h-4 w-4 text-muted-foreground flex-shrink-0"})):y("",!0),a(e(A),{class:O(["text-sm",h(String(V))?"font-semibold":"font-medium text-muted-foreground"])},{default:s(()=>[c(i(w(String(V)))+": ",1)]),_:2},1032,["class"])]),r("div",ea,[r("p",{class:O(["text-sm",h(String(V))?"font-medium text-gray-900 dark:text-gray-100":"text-gray-700 dark:text-gray-300"])},i(N(k,String(V))),3)])]))),128)),Object.keys(b.data).length===0?(n(),p("div",aa," Sin información disponible ")):y("",!0)]),_:2},1024)]),_:2},1024))),128))]))]))}}),ta={class:"border rounded-lg p-4 space-y-3"},ra={class:"flex items-start justify-between"},sa={class:"flex-1"},oa={class:"font-medium text-sm"},la={key:0,class:"mt-2"},na={key:1,class:"mt-2"},ia={key:2,class:"text-sm text-muted-foreground mt-1"},da={class:"flex items-center gap-2"},ua={key:0,class:"pt-2 border-t"},ca={class:"flex items-start gap-2 text-xs text-muted-foreground"},ma={class:"flex-1"},pa={class:"font-medium"},fa={key:0,class:"flex items-center gap-1 mt-0.5"},va={key:0,class:"mt-2 p-2 bg-muted rounded text-xs"},ba={class:"flex items-start gap-1"},ga={class:"flex-1"},_a={key:1,class:"flex gap-2 pt-2"},ya={class:"space-y-4 py-4"},ha={key:0,class:"mt-2 p-2 bg-muted rounded"},xa={key:1,class:"mt-2 p-2 bg-muted rounded"},ka={key:2,class:"mt-1 p-2 bg-muted rounded text-sm"},$a={class:"space-y-4 py-4"},wa={key:0,class:"mt-2 p-2 bg-muted rounded"},Ca={key:1,class:"mt-2 p-2 bg-muted rounded"},Aa={key:2,class:"mt-1 p-2 bg-muted rounded text-sm"},za=Q({__name:"AprobacionCampo",props:{candidaturaId:{},campoId:{},campoTitle:{},valor:{},aprobacion:{},puedeAprobar:{type:Boolean},readonly:{type:Boolean}},emits:["campo-actualizado"],setup(L,{emit:_}){const v=L,N=_,w=R(!1),z=R(!1),h=R(""),d=R(!1),o=S(()=>v.aprobacion?v.aprobacion.aprobado?"aprobado":"rechazado":"pendiente"),b=S(()=>v.aprobacion?v.aprobacion.aprobado?"bg-green-100 text-green-800":"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"),f=S(()=>v.aprobacion?v.aprobacion.aprobado?"Aprobado":"Rechazado":"Pendiente"),k=S(()=>v.aprobacion?v.aprobacion.aprobado?q:H:ge),V=async()=>{var l;d.value=!0;try{const u=await fetch(`/admin/candidaturas/${v.candidaturaId}/campos/${v.campoId}/aprobar`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((l=document.querySelector('meta[name="csrf-token"]'))==null?void 0:l.getAttribute("content"))||""},body:JSON.stringify({comentario:h.value||null})}),j=await u.json();u.ok&&j.success?(N("campo-actualizado",j.aprobacion),w.value=!1,h.value=""):console.error("Error al aprobar campo:",j)}catch(u){console.error("Error al aprobar campo:",u)}finally{d.value=!1}},Y=async()=>{var l;if(h.value.trim()){d.value=!0;try{const u=await fetch(`/admin/candidaturas/${v.candidaturaId}/campos/${v.campoId}/rechazar`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((l=document.querySelector('meta[name="csrf-token"]'))==null?void 0:l.getAttribute("content"))||""},body:JSON.stringify({comentario:h.value})}),j=await u.json();u.ok&&j.success?(N("campo-actualizado",j.aprobacion),z.value=!1,h.value=""):console.error("Error al rechazar campo:",j)}catch(u){console.error("Error al rechazar campo:",u)}finally{d.value=!1}}},P=S(()=>{if(Array.isArray(v.valor)&&v.valor.length>0){const l=v.valor[0];if(typeof l=="string"&&(l.includes("uploads/")||l.includes(".pdf")||l.includes(".doc")||l.includes(".jpg")||l.includes(".png")))return!0}return!1}),T=S(()=>{if(Array.isArray(v.valor)&&v.valor.length>0){const l=v.valor[0];if(typeof l=="object"&&l!==null)return l.hasOwnProperty("id")&&l.hasOwnProperty("data")||typeof l=="object"&&!Array.isArray(l)}return!1}),Z=S(()=>typeof v.valor=="object"&&v.valor!==null&&!Array.isArray(v.valor)?v.valor.hasOwnProperty("accepted")&&v.valor.hasOwnProperty("timestamp"):!1),I=l=>{if(P.value||T.value)return"";if(Z.value&&typeof l=="object"&&l!==null)if(l.accepted===!0)try{return`✅ Aceptado el ${new Date(l.timestamp).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})}`}catch{return"✅ Aceptado"}else return"❌ No aceptado";return Array.isArray(l)?l.join(", "):typeof l=="object"&&l!==null?JSON.stringify(l):(l==null?void 0:l.toString())||"Sin valor"};return(l,u)=>{var j;return n(),p(U,null,[r("div",ta,[r("div",ra,[r("div",sa,[r("h4",oa,i(l.campoTitle),1),P.value?(n(),p("div",la,[a(X,{value:l.valor,label:l.campoTitle},null,8,["value","label"])])):T.value?(n(),p("div",na,[a(K,{value:l.valor,label:l.campoTitle},null,8,["value","label"])])):(n(),p("p",ia,i(I(l.valor)),1))]),r("div",da,[a(e(W),{class:O([b.value,"flex items-center gap-1"])},{default:s(()=>[(n(),$(be(k.value),{class:"h-3 w-3"})),c(" "+i(f.value),1)]),_:1},8,["class"])])]),(j=l.aprobacion)!=null&&j.aprobado_por?(n(),p("div",ua,[r("div",ca,[a(e(G),{class:"h-3 w-3 mt-0.5"}),r("div",ma,[r("p",null,[c(i(l.aprobacion.aprobado?"Aprobado":"Rechazado")+" por ",1),r("span",pa,i(l.aprobacion.aprobado_por.name),1)]),l.aprobacion.fecha_aprobacion?(n(),p("p",fa,[a(e(pe),{class:"h-3 w-3"}),c(" "+i(l.aprobacion.fecha_aprobacion),1)])):y("",!0)])]),l.aprobacion.comentario?(n(),p("div",va,[r("div",ba,[a(e(_e),{class:"h-3 w-3 mt-0.5 text-muted-foreground"}),r("p",ga,i(l.aprobacion.comentario),1)])])):y("",!0)])):y("",!0),l.puedeAprobar&&!l.readonly?(n(),p("div",_a,[o.value!=="aprobado"?(n(),$(e(x),{key:0,size:"sm",variant:"outline",class:"text-green-700 border-green-300 hover:bg-green-50",onClick:u[0]||(u[0]=C=>w.value=!0)},{default:s(()=>[a(e(q),{class:"h-3 w-3 mr-1"}),u[8]||(u[8]=c(" Aprobar "))]),_:1})):y("",!0),o.value!=="rechazado"?(n(),$(e(x),{key:1,size:"sm",variant:"outline",class:"text-red-700 border-red-300 hover:bg-red-50",onClick:u[1]||(u[1]=C=>z.value=!0)},{default:s(()=>[a(e(H),{class:"h-3 w-3 mr-1"}),u[9]||(u[9]=c(" Rechazar "))]),_:1})):y("",!0)])):y("",!0)]),a(e(se),{open:w.value,"onUpdate:open":u[4]||(u[4]=C=>w.value=C)},{default:s(()=>[a(e(oe),null,{default:s(()=>[a(e(le),null,{default:s(()=>[a(e(ne),null,{default:s(()=>u[10]||(u[10]=[c("Aprobar Campo")])),_:1}),a(e(ie),null,{default:s(()=>[c(' Estás aprobando el campo "'+i(l.campoTitle)+'". Puedes agregar un comentario opcional. ',1)]),_:1})]),_:1}),r("div",ya,[r("div",null,[a(e(A),null,{default:s(()=>u[11]||(u[11]=[c("Valor actual del campo")])),_:1}),P.value?(n(),p("div",ha,[a(X,{value:l.valor,label:l.campoTitle},null,8,["value","label"])])):T.value?(n(),p("div",xa,[a(K,{value:l.valor,label:l.campoTitle},null,8,["value","label"])])):(n(),p("p",ka,i(I(l.valor)),1))]),r("div",null,[a(e(A),{for:"comentario-aprobacion"},{default:s(()=>u[12]||(u[12]=[c(" Comentario (opcional) ")])),_:1}),a(e(M),{id:"comentario-aprobacion",modelValue:h.value,"onUpdate:modelValue":u[2]||(u[2]=C=>h.value=C),placeholder:"Agregar comentario...",rows:"3"},null,8,["modelValue"])])]),a(e(de),null,{default:s(()=>[a(e(x),{variant:"outline",onClick:u[3]||(u[3]=C=>w.value=!1),disabled:d.value},{default:s(()=>u[13]||(u[13]=[c(" Cancelar ")])),_:1},8,["disabled"]),a(e(x),{onClick:V,disabled:d.value,class:"bg-green-600 hover:bg-green-700"},{default:s(()=>[a(e(q),{class:"h-4 w-4 mr-2"}),c(" "+i(d.value?"Aprobando...":"Aprobar Campo"),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"]),a(e(se),{open:z.value,"onUpdate:open":u[7]||(u[7]=C=>z.value=C)},{default:s(()=>[a(e(oe),null,{default:s(()=>[a(e(le),null,{default:s(()=>[a(e(ne),null,{default:s(()=>u[14]||(u[14]=[c("Rechazar Campo")])),_:1}),a(e(ie),null,{default:s(()=>[c(' Estás rechazando el campo "'+i(l.campoTitle)+'". Por favor, indica el motivo del rechazo. ',1)]),_:1})]),_:1}),r("div",$a,[r("div",null,[a(e(A),null,{default:s(()=>u[15]||(u[15]=[c("Valor actual del campo")])),_:1}),P.value?(n(),p("div",wa,[a(X,{value:l.valor,label:l.campoTitle},null,8,["value","label"])])):T.value?(n(),p("div",Ca,[a(K,{value:l.valor,label:l.campoTitle},null,8,["value","label"])])):(n(),p("p",Aa,i(I(l.valor)),1))]),r("div",null,[a(e(A),{for:"comentario-rechazo"},{default:s(()=>u[16]||(u[16]=[c(" Motivo del rechazo * ")])),_:1}),a(e(M),{id:"comentario-rechazo",modelValue:h.value,"onUpdate:modelValue":u[5]||(u[5]=C=>h.value=C),placeholder:"Explica qué debe corregir el usuario...",rows:"4",required:""},null,8,["modelValue"])])]),a(e(de),null,{default:s(()=>[a(e(x),{variant:"outline",onClick:u[6]||(u[6]=C=>z.value=!1),disabled:d.value},{default:s(()=>u[17]||(u[17]=[c(" Cancelar ")])),_:1},8,["disabled"]),a(e(x),{variant:"destructive",onClick:Y,disabled:!h.value.trim()||d.value},{default:s(()=>[a(e(H),{class:"h-4 w-4 mr-2"}),c(" "+i(d.value?"Rechazando...":"Rechazar Campo"),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"])],64)}}}),ja={class:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4"},Sa={class:"flex items-center justify-between"},Va={class:"text-3xl font-bold"},Fa={class:"text-muted-foreground"},Ea={class:"flex items-center justify-between"},Na={class:"flex items-center gap-4"},Da={class:"flex items-center gap-2"},Ra={class:"text-sm text-muted-foreground"},La={key:0,class:"flex items-center gap-2 text-sm"},Ta={class:"text-muted-foreground"},Ba={key:0,class:"flex gap-2"},Ua={class:"flex justify-end gap-2"},Oa={key:0,class:"text-sm text-destructive mt-1"},Pa={class:"flex justify-end gap-2"},Ia={class:"p-4 bg-orange-100 dark:bg-orange-900/30 rounded-lg"},Ma={class:"flex items-start gap-3"},qa={key:0,class:"text-sm text-destructive mt-1"},Ha={class:"flex justify-end gap-2"},Wa={class:"grid gap-4 md:grid-cols-2"},Ja={class:"text-muted-foreground"},Xa={class:"text-muted-foreground"},Ka={class:"text-muted-foreground"},Ga={class:"text-muted-foreground"},Qa={class:"flex items-center gap-2"},Ya={class:"grid grid-cols-2 md:grid-cols-4 gap-4"},Za={class:"text-center"},et={class:"text-2xl font-bold"},at={class:"text-center"},tt={class:"text-2xl font-bold text-green-600"},rt={class:"text-center"},st={class:"text-2xl font-bold text-red-600"},ot={class:"text-center"},lt={class:"text-2xl font-bold text-yellow-600"},nt={class:"mt-4"},it={class:"flex justify-between text-sm mb-1"},dt={class:"w-full bg-gray-200 rounded-full h-2"},ut={class:"text-blue-700 dark:text-blue-300"},ct={key:0,class:"text-center py-8"},mt={key:1,class:"space-y-6"},pt={key:0},ft={key:0,class:"text-red-500"},vt={key:0,class:"text-xs text-muted-foreground mb-2"},bt={class:"mt-2"},gt={key:2,class:"text-muted-foreground"},_t={key:1,class:"space-y-4"},Mt=Q({__name:"Show",props:{candidatura:{},configuracion_campos:{},campo_aprobaciones:{},resumen_aprobaciones:{},puede_aprobar_campos:{type:Boolean}},setup(L){const _=L,v=Ce(_.campo_aprobaciones||{}),N=m=>{v[m.campo_id]=m,ue.reload({only:["resumen_aprobaciones"]})},w=R(!1),z=[{title:"Admin",href:"/admin/dashboard"},{title:"Candidaturas",href:"/admin/candidaturas"},{title:_.candidatura.usuario.name,href:"#"}],h=R(!1),d=R(!1),o=R(!1),b=ee({comentarios:""}),f=ee({comentarios:""}),k=ee({motivo:""}),V=S(()=>_.candidatura.estado==="pendiente"&&!T(_.candidatura.formulario_data)),Y=S(()=>_.candidatura.estado==="pendiente"),P=S(()=>_.candidatura.estado==="aprobado"||_.candidatura.estado==="rechazado"),T=m=>!m||Object.keys(m).length===0,Z=()=>{b.post(`/admin/candidaturas/${_.candidatura.id}/aprobar`,{onSuccess:()=>{h.value=!1}})},I=()=>{f.comentarios.trim()&&f.post(`/admin/candidaturas/${_.candidatura.id}/rechazar`,{onSuccess:()=>{d.value=!1}})},l=()=>{b.reset(),h.value=!1},u=()=>{f.reset(),d.value=!1},j=()=>{k.post(`/admin/candidaturas/${_.candidatura.id}/volver-borrador`,{onSuccess:()=>{o.value=!1}})},C=()=>{k.reset(),o.value=!1},ye=(m,t)=>{if(!t)return"No especificado";switch(m.type){case"checkbox":return Array.isArray(t)?t.join(", "):t;case"date":case"datepicker":try{return new Date(t).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric"})}catch{return t}case"disclaimer":if(typeof t=="object"&&t!==null)if(t.accepted===!0)try{return`✅ Aceptado el ${new Date(t.timestamp).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})}`}catch{return"✅ Aceptado"}else return"❌ No aceptado";return t;case"file":return null;case"repeater":return null;case"textarea":return t;default:return t}},ae=m=>new Date(m).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"});return(m,t)=>(n(),p(U,null,[a(e(Ae),{title:`Candidatura - ${m.candidatura.usuario.name}`},null,8,["title"]),a(Ve,{breadcrumbs:z},{default:s(()=>[r("div",ja,[r("div",Sa,[r("div",null,[r("h1",Va,i(m.candidatura.usuario.name),1),r("p",Fa," Candidatura "+i(m.candidatura.estado_label)+" - Versión "+i(m.candidatura.version),1)]),a(e(x),{variant:"outline",onClick:t[0]||(t[0]=g=>e(ue).visit("/admin/candidaturas"))},{default:s(()=>[a(e(Ne),{class:"mr-2 h-4 w-4"}),t[8]||(t[8]=c(" Volver a Lista "))]),_:1})]),a(e(E),null,{default:s(()=>[a(e(F),{class:"p-6"},{default:s(()=>[r("div",Ea,[r("div",Na,[r("div",Da,[a(e(W),{class:O([m.candidatura.estado_color,"text-sm"])},{default:s(()=>[c(i(m.candidatura.estado_label),1)]),_:1},8,["class"]),r("span",Ra," Versión "+i(m.candidatura.version),1)]),m.candidatura.aprobado_por?(n(),p("div",La,[a(e(G),{class:"h-4 w-4"}),r("span",null,i(m.candidatura.aprobado_por.name),1),r("span",Ta,"- "+i(m.candidatura.fecha_aprobacion),1)])):y("",!0)]),!h.value&&!d.value&&!o.value?(n(),p("div",Ba,[V.value?(n(),$(e(x),{key:0,onClick:t[1]||(t[1]=g=>h.value=!0),class:"bg-green-600 hover:bg-green-700"},{default:s(()=>[a(e(q),{class:"mr-2 h-4 w-4"}),t[9]||(t[9]=c(" Aprobar "))]),_:1})):y("",!0),Y.value?(n(),$(e(x),{key:1,variant:"destructive",onClick:t[2]||(t[2]=g=>d.value=!0)},{default:s(()=>[a(e(H),{class:"mr-2 h-4 w-4"}),t[10]||(t[10]=c(" Rechazar "))]),_:1})):y("",!0),P.value?(n(),$(e(x),{key:2,variant:"outline",onClick:t[3]||(t[3]=g=>o.value=!0),class:"border-orange-300 text-orange-700 hover:bg-orange-50"},{default:s(()=>[a(e(me),{class:"mr-2 h-4 w-4"}),t[11]||(t[11]=c(" Volver a Borrador "))]),_:1})):y("",!0)])):y("",!0)])]),_:1})]),_:1}),h.value?(n(),$(e(E),{key:0,class:"border-green-200 dark:border-green-800 bg-green-50 dark:bg-green-950/20"},{default:s(()=>[a(e(D),null,{default:s(()=>[a(e(B),{class:"text-green-800 dark:text-green-200 flex items-center gap-2"},{default:s(()=>[a(e(q),{class:"h-5 w-5"}),t[12]||(t[12]=c(" Aprobar Candidatura "))]),_:1})]),_:1}),a(e(F),{class:"space-y-4"},{default:s(()=>[r("div",null,[a(e(A),{for:"approval_comments"},{default:s(()=>t[13]||(t[13]=[c("Comentarios (opcional)")])),_:1}),a(e(M),{id:"approval_comments",modelValue:e(b).comentarios,"onUpdate:modelValue":t[4]||(t[4]=g=>e(b).comentarios=g),placeholder:"Comentarios adicionales para el usuario...",rows:"3"},null,8,["modelValue"])]),r("div",Ua,[a(e(x),{variant:"outline",onClick:l,disabled:e(b).processing},{default:s(()=>t[14]||(t[14]=[c(" Cancelar ")])),_:1},8,["disabled"]),a(e(x),{onClick:Z,disabled:e(b).processing,class:"bg-green-600 hover:bg-green-700"},{default:s(()=>[c(i(e(b).processing?"Aprobando...":"Confirmar Aprobación"),1)]),_:1},8,["disabled"])])]),_:1})]),_:1})):y("",!0),d.value?(n(),$(e(E),{key:1,class:"border-red-200 dark:border-red-800 bg-red-50 dark:bg-red-950/20"},{default:s(()=>[a(e(D),null,{default:s(()=>[a(e(B),{class:"text-red-800 dark:text-red-200 flex items-center gap-2"},{default:s(()=>[a(e(H),{class:"h-5 w-5"}),t[15]||(t[15]=c(" Rechazar Candidatura "))]),_:1})]),_:1}),a(e(F),{class:"space-y-4"},{default:s(()=>[r("div",null,[a(e(A),{for:"rejection_comments"},{default:s(()=>t[16]||(t[16]=[c("Motivo del rechazo *")])),_:1}),a(e(M),{id:"rejection_comments",modelValue:e(f).comentarios,"onUpdate:modelValue":t[5]||(t[5]=g=>e(f).comentarios=g),placeholder:"Explica al usuario qué debe corregir...",rows:"4",class:O({"border-destructive":e(f).errors.comentarios})},null,8,["modelValue","class"]),e(f).errors.comentarios?(n(),p("p",Oa,i(e(f).errors.comentarios),1)):y("",!0)]),r("div",Pa,[a(e(x),{variant:"outline",onClick:u,disabled:e(f).processing},{default:s(()=>t[17]||(t[17]=[c(" Cancelar ")])),_:1},8,["disabled"]),a(e(x),{variant:"destructive",onClick:I,disabled:!e(f).comentarios.trim()||e(f).processing},{default:s(()=>[c(i(e(f).processing?"Rechazando...":"Confirmar Rechazo"),1)]),_:1},8,["disabled"])])]),_:1})]),_:1})):y("",!0),o.value?(n(),$(e(E),{key:2,class:"border-orange-200 dark:border-orange-800 bg-orange-50 dark:bg-orange-950/20"},{default:s(()=>[a(e(D),null,{default:s(()=>[a(e(B),{class:"text-orange-800 dark:text-orange-200 flex items-center gap-2"},{default:s(()=>[a(e(me),{class:"h-5 w-5"}),t[18]||(t[18]=c(" Volver Candidatura a Borrador "))]),_:1})]),_:1}),a(e(F),{class:"space-y-4"},{default:s(()=>[r("div",Ia,[r("div",Ma,[a(e(ce),{class:"h-5 w-5 text-orange-600 dark:text-orange-400 mt-0.5"}),t[19]||(t[19]=r("div",{class:"text-sm text-orange-800 dark:text-orange-200"},[r("p",{class:"font-medium"},'Esta acción volverá la candidatura al estado "Borrador"'),r("p",{class:"mt-1"},"El usuario podrá editar su candidatura nuevamente y deberá ser revisada otra vez.")],-1))])]),r("div",null,[a(e(A),{for:"revert_reason"},{default:s(()=>t[20]||(t[20]=[c("Motivo (opcional)")])),_:1}),a(e(M),{id:"revert_reason",modelValue:e(k).motivo,"onUpdate:modelValue":t[6]||(t[6]=g=>e(k).motivo=g),placeholder:"Explica al usuario por qué su candidatura volvió a borrador...",rows:"3",class:O({"border-destructive":e(k).errors.motivo})},null,8,["modelValue","class"]),e(k).errors.motivo?(n(),p("p",qa,i(e(k).errors.motivo),1)):y("",!0)]),r("div",Ha,[a(e(x),{variant:"outline",onClick:C,disabled:e(k).processing},{default:s(()=>t[21]||(t[21]=[c(" Cancelar ")])),_:1},8,["disabled"]),a(e(x),{onClick:j,disabled:e(k).processing,class:"bg-orange-600 hover:bg-orange-700"},{default:s(()=>[c(i(e(k).processing?"Procesando...":"Confirmar"),1)]),_:1},8,["disabled"])])]),_:1})]),_:1})):y("",!0),a(e(E),null,{default:s(()=>[a(e(D),null,{default:s(()=>[a(e(B),{class:"flex items-center gap-2"},{default:s(()=>[a(e(G),{class:"h-5 w-5"}),t[22]||(t[22]=c(" Información del Usuario "))]),_:1})]),_:1}),a(e(F),null,{default:s(()=>[r("div",Wa,[r("div",null,[a(e(A),{class:"text-sm font-medium"},{default:s(()=>t[23]||(t[23]=[c("Nombre")])),_:1}),r("p",Ja,i(m.candidatura.usuario.name),1)]),r("div",null,[a(e(A),{class:"text-sm font-medium"},{default:s(()=>t[24]||(t[24]=[c("Email")])),_:1}),r("p",Xa,i(m.candidatura.usuario.email),1)]),r("div",null,[a(e(A),{class:"text-sm font-medium"},{default:s(()=>t[25]||(t[25]=[c("Fecha de creación")])),_:1}),r("p",Ka,i(ae(m.candidatura.created_at)),1)]),r("div",null,[a(e(A),{class:"text-sm font-medium"},{default:s(()=>t[26]||(t[26]=[c("Última actualización")])),_:1}),r("p",Ga,i(ae(m.candidatura.updated_at)),1)])])]),_:1})]),_:1}),m.resumen_aprobaciones&&m.puede_aprobar_campos?(n(),$(e(E),{key:3,class:"border-indigo-200 dark:border-indigo-800"},{default:s(()=>[a(e(D),null,{default:s(()=>[a(e(B),{class:"flex items-center justify-between"},{default:s(()=>[r("span",Qa,[a(e(De),{class:"h-5 w-5"}),t[27]||(t[27]=c(" Aprobación de Campos "))]),a(e(x),{variant:"outline",size:"sm",onClick:t[7]||(t[7]=g=>w.value=!w.value)},{default:s(()=>[c(i(w.value?"Ocultar Aprobaciones":"Mostrar Aprobaciones"),1)]),_:1})]),_:1})]),_:1}),a(e(F),null,{default:s(()=>[r("div",Ya,[r("div",Za,[r("p",et,i(m.resumen_aprobaciones.total),1),t[28]||(t[28]=r("p",{class:"text-xs text-muted-foreground"},"Total Campos",-1))]),r("div",at,[r("p",tt,i(m.resumen_aprobaciones.aprobados),1),t[29]||(t[29]=r("p",{class:"text-xs text-muted-foreground"},"Aprobados",-1))]),r("div",rt,[r("p",st,i(m.resumen_aprobaciones.rechazados),1),t[30]||(t[30]=r("p",{class:"text-xs text-muted-foreground"},"Rechazados",-1))]),r("div",ot,[r("p",lt,i(m.resumen_aprobaciones.pendientes),1),t[31]||(t[31]=r("p",{class:"text-xs text-muted-foreground"},"Pendientes",-1))])]),r("div",nt,[r("div",it,[t[32]||(t[32]=r("span",null,"Progreso de Aprobación",-1)),r("span",null,i(m.resumen_aprobaciones.porcentaje_aprobado)+"%",1)]),r("div",dt,[r("div",{class:"bg-green-600 h-2 rounded-full transition-all",style:ze({width:`${m.resumen_aprobaciones.porcentaje_aprobado}%`})},null,4)])])]),_:1})]),_:1})):y("",!0),m.candidatura.comentarios_admin?(n(),$(e(E),{key:4,class:"border-blue-200 dark:border-blue-800 bg-blue-50 dark:bg-blue-950/20"},{default:s(()=>[a(e(D),null,{default:s(()=>[a(e(B),{class:"text-blue-800 dark:text-blue-200 flex items-center gap-2"},{default:s(()=>[a(e(_e),{class:"h-5 w-5"}),t[33]||(t[33]=c(" Comentarios de la comisión "))]),_:1})]),_:1}),a(e(F),null,{default:s(()=>[r("p",ut,i(m.candidatura.comentarios_admin),1)]),_:1})]),_:1})):y("",!0),a(e(E),null,{default:s(()=>[a(e(D),null,{default:s(()=>[a(e(B),{class:"flex items-center gap-2"},{default:s(()=>[a(e(ge),{class:"h-5 w-5"}),t[34]||(t[34]=c(" Datos de la Candidatura "))]),_:1})]),_:1}),a(e(F),null,{default:s(()=>[T(m.candidatura.formulario_data)?(n(),p("div",ct,[a(e(ce),{class:"mx-auto h-12 w-12 text-yellow-500"}),t[35]||(t[35]=r("h3",{class:"mt-4 text-lg font-medium"},"Candidatura vacía",-1)),t[36]||(t[36]=r("p",{class:"text-muted-foreground"},"El usuario aún no ha completado su perfil de candidatura.",-1))])):(n(),p("div",mt,[w.value?(n(),p("div",_t,[(n(!0),p(U,null,J(m.configuracion_campos,g=>(n(),$(za,{key:g.id,"candidatura-id":m.candidatura.id,"campo-id":g.id,"campo-title":g.title,valor:m.candidatura.formulario_data[g.id],aprobacion:v[g.id],"puede-aprobar":m.puede_aprobar_campos,readonly:m.candidatura.estado==="aprobado",onCampoActualizado:N},null,8,["candidatura-id","campo-id","campo-title","valor","aprobacion","puede-aprobar","readonly"]))),128))])):(n(),p("div",pt,[(n(!0),p(U,null,J(m.configuracion_campos,g=>{var te,re;return n(),p("div",{key:g.id,class:"border-b pb-4 last:border-b-0"},[a(e(A),{class:"text-sm font-medium flex items-center gap-1"},{default:s(()=>[c(i(g.title)+" ",1),g.required?(n(),p("span",ft,"*")):y("",!0)]),_:2},1024),g.description?(n(),p("p",vt,i(g.description),1)):y("",!0),r("div",bt,[g.type==="file"?(n(),$(X,{key:0,value:m.candidatura.formulario_data[g.id],label:g.title},null,8,["value","label"])):g.type==="repeater"?(n(),$(K,{key:1,value:m.candidatura.formulario_data[g.id],label:g.title,fields:(te=g.repeaterConfig)==null?void 0:te.fields,"item-name":((re=g.repeaterConfig)==null?void 0:re.itemName)||"Elemento"},null,8,["value","label","fields","item-name"])):(n(),p("p",gt,i(ye(g,m.candidatura.formulario_data[g.id])),1))])])}),128))]))]))]),_:1})]),_:1}),a(xe,{"candidatura-id":m.candidatura.id,"version-actual":m.candidatura.version,"is-admin":!0},null,8,["candidatura-id","version-actual"])])]),_:1})],64))}});export{Mt as default};
