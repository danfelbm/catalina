import{a as H,b as J,c as K,_ as P}from"./index-d0hLCKZ5.js";import{_ as $}from"./Label.vue_vue_type_script_setup_true_lang-DWSITdM-.js";import{_ as k,a as j,b as B,c as N,d as E}from"./DialogTitle.vue_vue_type_script_setup_true_lang-BJmCMDA5.js";import{d as Q,k as y,p as W,j as b,o as n,e as o,b as i,u as l,f as g,g as c,t as m,a as f,i as A,F as U,r as T,x as C}from"./app-Bb-Y6LhL.js";const X={class:"text-sm text-muted-foreground"},Y={class:"text-xs text-muted-foreground mt-1"},Z={key:0},I={class:"text-xs text-muted-foreground mt-1"},ee={key:1},ae={class:"text-xs text-muted-foreground mt-1"},le={key:2},se={class:"text-xs text-muted-foreground mt-1"},re=Q({__name:"GeographicRestrictions",props:{modelValue:{default:()=>({territorios_ids:[],departamentos_ids:[],municipios_ids:[],localidades_ids:[]})},disabled:{type:Boolean,default:!1},title:{default:"Restricciones Geográficas (Opcional)"},description:{default:"Selecciona las regiones donde estará disponible. Si no seleccionas nada, estará disponible para todos."}},emits:["update:modelValue"],setup(G,{emit:O}){const t=G,q=O,D=y([]),h=y([]),x=y([]),S=y([]),r=y(!1),z=async()=>{try{r.value=!0;const s=await fetch("/admin/geographic/territorios");D.value=await s.json()}catch(s){console.error("Error loading territorios:",s)}finally{r.value=!1}},L=async s=>{if(!s.length){h.value=[];return}try{r.value=!0;const e=await fetch(`/admin/geographic/departamentos?territorio_ids=${s.join(",")}`);h.value=await e.json()}catch(e){console.error("Error loading departamentos:",e)}finally{r.value=!1}},M=async s=>{if(!s.length){x.value=[];return}try{r.value=!0;const e=await fetch(`/admin/geographic/municipios?departamento_ids=${s.join(",")}`);x.value=await e.json()}catch(e){console.error("Error loading municipios:",e)}finally{r.value=!1}},R=async s=>{if(!s.length){S.value=[];return}try{r.value=!0;const e=await fetch(`/admin/geographic/localidades?municipio_ids=${s.join(",")}`);S.value=await e.json()}catch(e){console.error("Error loading localidades:",e)}finally{r.value=!1}},w=(s,e)=>{var _,p,v,V;const u=Array.isArray(s)?s.map(Number).filter(Boolean):s?[Number(s)].filter(Boolean):[],d={territorios_ids:((_=t.modelValue)==null?void 0:_.territorios_ids)||[],departamentos_ids:((p=t.modelValue)==null?void 0:p.departamentos_ids)||[],municipios_ids:((v=t.modelValue)==null?void 0:v.municipios_ids)||[],localidades_ids:((V=t.modelValue)==null?void 0:V.localidades_ids)||[],...t.modelValue};d[e]=u,e==="territorios_ids"?(d.departamentos_ids=[],d.municipios_ids=[],d.localidades_ids=[],C(()=>L(u))):e==="departamentos_ids"?(d.municipios_ids=[],d.localidades_ids=[],C(()=>M(u))):e==="municipios_ids"&&(d.localidades_ids=[],C(()=>R(u))),q("update:modelValue",d)};return W(async()=>{var s,e,u,d,_,p;await z(),(e=(s=t.modelValue)==null?void 0:s.territorios_ids)!=null&&e.length&&await L(t.modelValue.territorios_ids),(d=(u=t.modelValue)==null?void 0:u.departamentos_ids)!=null&&d.length&&await M(t.modelValue.departamentos_ids),(p=(_=t.modelValue)==null?void 0:_.municipios_ids)!=null&&p.length&&await R(t.modelValue.municipios_ids)}),(s,e)=>(n(),b(l(P),{class:"border-dashed"},{default:o(()=>[i(l(H),null,{default:o(()=>[i(l(J),{class:"text-base"},{default:o(()=>[c(m(s.title),1)]),_:1}),g("p",X,m(s.description),1)]),_:1}),i(l(K),{class:"space-y-4"},{default:o(()=>{var u,d,_,p,v,V,F;return[g("div",null,[i(l($),null,{default:o(()=>e[4]||(e[4]=[c("Territorios")])),_:1}),i(l(k),{"model-value":(((u=t.modelValue)==null?void 0:u.territorios_ids)||[]).map(a=>a.toString()),"onUpdate:modelValue":e[0]||(e[0]=a=>w(a,"territorios_ids")),multiple:"",disabled:s.disabled||r.value},{default:o(()=>[i(l(j),null,{default:o(()=>[i(l(B),{placeholder:"Seleccionar territorios..."})]),_:1}),i(l(N),null,{default:o(()=>[(n(!0),f(U,null,T(D.value,a=>(n(),b(l(E),{key:a.id,value:a.id.toString()},{default:o(()=>[c(m(a.nombre),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["model-value","disabled"]),g("p",Y,m(t.modelValue.territorios_ids.length)+" territorio(s) seleccionado(s) ",1)]),h.value.length>0?(n(),f("div",Z,[i(l($),null,{default:o(()=>e[5]||(e[5]=[c("Departamentos")])),_:1}),i(l(k),{"model-value":(((d=t.modelValue)==null?void 0:d.departamentos_ids)||[]).map(a=>a.toString()),"onUpdate:modelValue":e[1]||(e[1]=a=>w(a,"departamentos_ids")),multiple:"",disabled:s.disabled||r.value},{default:o(()=>[i(l(j),null,{default:o(()=>[i(l(B),{placeholder:"Seleccionar departamentos..."})]),_:1}),i(l(N),null,{default:o(()=>[(n(!0),f(U,null,T(h.value,a=>(n(),b(l(E),{key:a.id,value:a.id.toString()},{default:o(()=>[c(m(a.nombre),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["model-value","disabled"]),g("p",I,m((((_=t.modelValue)==null?void 0:_.departamentos_ids)||[]).length)+" departamento(s) seleccionado(s) ",1)])):A("",!0),x.value.length>0?(n(),f("div",ee,[i(l($),null,{default:o(()=>e[6]||(e[6]=[c("Municipios")])),_:1}),i(l(k),{"model-value":(((p=t.modelValue)==null?void 0:p.municipios_ids)||[]).map(a=>a.toString()),"onUpdate:modelValue":e[2]||(e[2]=a=>w(a,"municipios_ids")),multiple:"",disabled:s.disabled||r.value},{default:o(()=>[i(l(j),null,{default:o(()=>[i(l(B),{placeholder:"Seleccionar municipios..."})]),_:1}),i(l(N),null,{default:o(()=>[(n(!0),f(U,null,T(x.value,a=>(n(),b(l(E),{key:a.id,value:a.id.toString()},{default:o(()=>[c(m(a.nombre),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["model-value","disabled"]),g("p",ae,m((((v=t.modelValue)==null?void 0:v.municipios_ids)||[]).length)+" municipio(s) seleccionado(s) ",1)])):A("",!0),S.value.length>0?(n(),f("div",le,[i(l($),null,{default:o(()=>e[7]||(e[7]=[c("Localidades")])),_:1}),i(l(k),{"model-value":(((V=t.modelValue)==null?void 0:V.localidades_ids)||[]).map(a=>a.toString()),"onUpdate:modelValue":e[3]||(e[3]=a=>w(a,"localidades_ids")),multiple:"",disabled:s.disabled||r.value},{default:o(()=>[i(l(j),null,{default:o(()=>[i(l(B),{placeholder:"Seleccionar localidades..."})]),_:1}),i(l(N),null,{default:o(()=>[(n(!0),f(U,null,T(S.value,a=>(n(),b(l(E),{key:a.id,value:a.id.toString()},{default:o(()=>[c(m(a.nombre),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["model-value","disabled"]),g("p",se,m((((F=t.modelValue)==null?void 0:F.localidades_ids)||[]).length)+" localidad(es) seleccionada(s) ",1)])):A("",!0)]}),_:1})]),_:1}))}});export{re as _};
