import{l as S,e as U,U as W}from"./DialogTitle.vue_vue_type_script_setup_true_lang-D_nilgK0.js";import{_ as g}from"./createLucideIcon-CjSnWMAs.js";import{F as h,_ as p,a as y,b as k,c as f}from"./index-11KoE7K9.js";import{_ as H}from"./Progress.vue_vue_type_script_setup_true_lang-Bkaeo_BW.js";import{_ as O,a as X}from"./index-yxdRVCHg.js";import{_ as q}from"./AppLayout.vue_vue_type_script_setup_true_lang-DGUFgy7V.js";import{d as G,k as $,c as E,p as J,y as K,a as i,o as n,b as l,u as o,m as Q,e as a,f as e,j as b,i as u,t as r,g as c,l as R,n as w,F as I,r as Y,W as V}from"./app-DaeX7cdw.js";import{C as A}from"./circle-x-x83OnP5H.js";import{C as P}from"./circle-check-big-_OEhV1Vs.js";import{C as L}from"./clock-DeWG7NZQ.js";import{A as Z}from"./arrow-left-CrKxkQJn.js";import{T as j}from"./triangle-alert-lLzAkebH.js";import"./VisuallyHidden-Dq3uFg-l.js";import"./Label.vue_vue_type_script_setup_true_lang-CMHm9R99.js";import"./index-D0dABG5H.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-Cwg8ppLD.js";const ee={class:"flex h-full flex-1 flex-col gap-6 rounded-xl p-4"},te={class:"flex items-center justify-between"},se={class:"text-muted-foreground"},oe={class:"flex gap-2"},le={class:"flex items-center justify-between"},ae={class:"text-sm text-muted-foreground mb-4"},re={key:0,class:"mb-4 p-3 bg-muted/50 rounded-lg"},ne={class:"text-sm text-muted-foreground"},ie={class:"space-y-2"},de={class:"flex justify-between text-sm"},ue={class:"text-center text-sm text-muted-foreground"},ce={key:1,class:"mt-4 pt-4 border-t"},me={class:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm"},pe={key:0},fe={class:"text-muted-foreground"},_e={key:1},ve={class:"text-muted-foreground"},xe={key:2},ge={class:"text-muted-foreground"},be={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},we={class:"flex items-center space-x-2"},Ce={class:"text-2xl font-bold"},he={class:"flex items-center space-x-2"},ye={class:"text-2xl font-bold text-green-600"},ke={class:"flex items-center space-x-2"},$e={class:"text-2xl font-bold text-red-600"},Ee={class:"flex items-center space-x-2"},Ie={class:"text-2xl font-bold text-blue-600"},Ve={class:"flex items-center gap-2"},Ae={class:"max-h-60 overflow-y-auto space-y-2"},Pe={key:1,class:"text-center"},Je=G({__name:"Show",props:{import:{}},setup(B){const t=$(B.import);let m=null;const F=[{title:"Admin",href:"/admin/dashboard"},{title:"Votaciones",href:"/admin/votaciones"},{title:t.value.votacion.titulo,href:`/admin/votaciones/${t.value.votacion_id}/edit`},{title:"Progreso de Importación",href:"#"}],d=E(()=>{switch(t.value.status){case"pending":return{icon:L,color:"bg-yellow-500",textColor:"text-yellow-700",bgColor:"bg-yellow-50",label:"Pendiente",description:"La importación está en cola para ser procesada"};case"processing":return{icon:L,color:"bg-blue-500",textColor:"text-blue-700",bgColor:"bg-blue-50",label:"Procesando",description:"La importación está siendo procesada en lotes"};case"completed":return{icon:P,color:"bg-green-500",textColor:"text-green-700",bgColor:"bg-green-50",label:"Completada",description:"La importación se completó exitosamente"};case"failed":return{icon:A,color:"bg-red-500",textColor:"text-red-700",bgColor:"bg-red-50",label:"Fallida",description:"La importación falló durante el procesamiento"};default:return{icon:S,color:"bg-gray-500",textColor:"text-gray-700",bgColor:"bg-gray-50",label:"Desconocido",description:"Estado desconocido"}}}),x=E(()=>["pending","processing"].includes(t.value.status)),v=$(!1),T=async()=>{try{const _=await fetch(`/admin/imports/${t.value.id}/status`);if(_.ok){const s=await _.json();t.value={...t.value,...s},!x.value&&m&&(clearInterval(m),m=null)}}catch(_){console.error("Error updating status:",_)}},D=()=>{x.value&&(m=setInterval(T,2e3))},N=()=>{V.get(`/admin/votaciones/${t.value.votacion_id}/edit`)},z=()=>{V.get(`/admin/votaciones/${t.value.votacion_id}/imports`)};return J(()=>{D()}),K(()=>{m&&clearInterval(m)}),(_,s)=>(n(),i(I,null,[l(o(Q),{title:"Progreso de Importación"}),l(q,{breadcrumbs:F},{default:a(()=>[e("div",ee,[e("div",te,[e("div",null,[s[1]||(s[1]=e("h1",{class:"text-3xl font-bold"},"Progreso de Importación",-1)),e("p",se,r(t.value.original_filename)+" - "+r(t.value.votacion.titulo),1)]),e("div",oe,[l(o(g),{variant:"outline",onClick:N},{default:a(()=>[l(o(Z),{class:"mr-2 h-4 w-4"}),s[2]||(s[2]=c(" Volver a Votación "))]),_:1}),l(o(g),{variant:"outline",onClick:z},{default:a(()=>[l(o(h),{class:"mr-2 h-4 w-4"}),s[3]||(s[3]=c(" Ver Historial "))]),_:1})])]),l(o(p),null,{default:a(()=>[l(o(y),null,{default:a(()=>[e("div",le,[l(o(k),{class:"flex items-center gap-2"},{default:a(()=>[(n(),b(R(d.value.icon),{class:w(["h-6 w-6",d.value.textColor])},null,8,["class"])),c(" "+r(d.value.label),1)]),_:1}),l(o(U),{class:w(d.value.bgColor+" "+d.value.textColor)},{default:a(()=>[c(r(d.value.label),1)]),_:1},8,["class"])])]),_:1}),l(o(f),null,{default:a(()=>[e("p",ae,r(d.value.description),1),t.value.motivo?(n(),i("div",re,[s[4]||(s[4]=e("h4",{class:"text-sm font-medium mb-2"},"Motivo de la importación:",-1)),e("p",ne,r(t.value.motivo),1)])):u("",!0),e("div",ie,[e("div",de,[s[5]||(s[5]=e("span",null,"Progreso",-1)),e("span",null,r(t.value.processed_rows)+" / "+r(t.value.total_rows||"?")+" filas",1)]),l(o(H),{value:t.value.progress_percentage,class:w(d.value.color)},null,8,["value","class"]),e("div",ue,r(t.value.progress_percentage)+"% completado ",1)]),t.value.started_at||t.value.completed_at?(n(),i("div",ce,[e("div",me,[t.value.started_at?(n(),i("div",pe,[s[6]||(s[6]=e("span",{class:"font-medium"},"Iniciado:",-1)),e("p",fe,r(t.value.started_at),1)])):u("",!0),t.value.completed_at?(n(),i("div",_e,[s[7]||(s[7]=e("span",{class:"font-medium"},"Completado:",-1)),e("p",ve,r(t.value.completed_at),1)])):u("",!0),t.value.duration?(n(),i("div",xe,[s[8]||(s[8]=e("span",{class:"font-medium"},"Duración:",-1)),e("p",ge,r(t.value.duration),1)])):u("",!0)])])):u("",!0)]),_:1})]),_:1}),e("div",be,[l(o(p),null,{default:a(()=>[l(o(f),{class:"pt-6"},{default:a(()=>[e("div",we,[l(o(h),{class:"h-5 w-5 text-muted-foreground"}),e("div",null,[e("p",Ce,r(t.value.total_rows||0),1),s[9]||(s[9]=e("p",{class:"text-xs text-muted-foreground"},"Total Filas",-1))])])]),_:1})]),_:1}),l(o(p),null,{default:a(()=>[l(o(f),{class:"pt-6"},{default:a(()=>[e("div",he,[l(o(P),{class:"h-5 w-5 text-green-600"}),e("div",null,[e("p",ye,r(t.value.successful_rows),1),s[10]||(s[10]=e("p",{class:"text-xs text-muted-foreground"},"Exitosos",-1))])])]),_:1})]),_:1}),l(o(p),null,{default:a(()=>[l(o(f),{class:"pt-6"},{default:a(()=>[e("div",ke,[l(o(A),{class:"h-5 w-5 text-red-600"}),e("div",null,[e("p",$e,r(t.value.failed_rows),1),s[11]||(s[11]=e("p",{class:"text-xs text-muted-foreground"},"Errores",-1))])])]),_:1})]),_:1}),l(o(p),null,{default:a(()=>[l(o(f),{class:"pt-6"},{default:a(()=>[e("div",Ee,[l(o(W),{class:"h-5 w-5 text-blue-600"}),e("div",null,[e("p",Ie,r(t.value.processed_rows),1),s[12]||(s[12]=e("p",{class:"text-xs text-muted-foreground"},"Procesados",-1))])])]),_:1})]),_:1})]),t.value.errors&&t.value.errors.length>0?(n(),b(o(p),{key:0},{default:a(()=>[l(o(y),null,{default:a(()=>[l(o(k),{class:"flex items-center justify-between"},{default:a(()=>[e("span",Ve,[l(o(j),{class:"h-5 w-5 text-orange-600"}),c(" Errores Encontrados ("+r(t.value.errors.length)+") ",1)]),l(o(g),{variant:"outline",size:"sm",onClick:s[0]||(s[0]=C=>v.value=!v.value)},{default:a(()=>[c(r(v.value?"Ocultar":"Mostrar")+" Errores ",1)]),_:1})]),_:1})]),_:1}),v.value?(n(),b(o(f),{key:0},{default:a(()=>[l(o(O),{class:"mb-4"},{default:a(()=>[l(o(j),{class:"h-4 w-4"}),l(o(X),null,{default:a(()=>s[13]||(s[13]=[c(" Los siguientes registros no pudieron ser procesados. El resto de usuarios fueron importados correctamente. ")])),_:1})]),_:1}),e("div",Ae,[(n(!0),i(I,null,Y(t.value.errors,(C,M)=>(n(),i("div",{key:M,class:"p-3 bg-red-50 border border-red-200 rounded text-sm text-red-800"},r(C),1))),128))])]),_:1})):u("",!0)]),_:1})):u("",!0),x.value?(n(),i("div",Pe,s[14]||(s[14]=[e("div",{class:"inline-flex items-center gap-2 text-sm text-muted-foreground"},[e("div",{class:"animate-pulse h-2 w-2 bg-blue-500 rounded-full"}),c(" Actualizando automáticamente cada 2 segundos ")],-1)]))):u("",!0)])]),_:1})],64))}});export{Je as default};
