import{_ as ro}from"./AppLayout.vue_vue_type_script_setup_true_lang-DGUFgy7V.js";import{e as V,l as uo}from"./DialogTitle.vue_vue_type_script_setup_true_lang-D_nilgK0.js";import{_ as C}from"./createLucideIcon-CjSnWMAs.js";import{_ as g,a as k,b as w,c as y,F}from"./index-11KoE7K9.js";import{_ as R}from"./CardDescription.vue_vue_type_script_setup_true_lang-D2c5TVWn.js";import{_ as m}from"./Label.vue_vue_type_script_setup_true_lang-CMHm9R99.js";import{_ as mo,a as co,b as T,c as W}from"./TabsTrigger.vue_vue_type_script_setup_true_lang-D23NyGV_.js";import{_ as fo}from"./Textarea.vue_vue_type_script_setup_true_lang-Cnx2cgaS.js";import{d as po,C as _o,k as X,c as x,a as u,o as r,b as e,u as a,m as vo,e as s,f as t,j as b,i as f,W as bo,g as n,t as d,n as h,l as G,F as j,r as P}from"./app-DaeX7cdw.js";import{A as go}from"./arrow-left-CrKxkQJn.js";import{U as B}from"./user-Doll1slk.js";import{S as M}from"./send-iK3_R00P.js";import{C as U}from"./clock-DeWG7NZQ.js";import{C as q}from"./circle-check-big-_OEhV1Vs.js";import{C as I}from"./circle-x-x83OnP5H.js";import{S as D}from"./square-pen-CVhqDomP.js";import{M as yo}from"./message-square-LWfwZMI2.js";import{H as xo}from"./history-CLBzjG_8.js";import"./index-D0dABG5H.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-Cwg8ppLD.js";import"./VisuallyHidden-Dq3uFg-l.js";import"./RovingFocusItem-DEx9p9eK.js";const Co={class:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4"},ko={class:"space-y-6"},wo={class:"flex items-center justify-between"},$o={class:"space-y-1"},ho={class:"flex items-center gap-2"},Ao={class:"text-3xl font-bold tracking-tight"},Eo={class:"text-muted-foreground"},Fo={class:"grid gap-6 md:grid-cols-2"},zo={class:"font-medium"},No={class:"font-medium"},So={class:"font-medium"},Vo={class:"font-medium"},Ro={class:"font-medium"},jo={class:"font-medium"},Po={class:"font-medium"},Bo={class:"font-medium"},Mo={key:0,class:"text-center py-8 text-muted-foreground"},Uo={key:1,class:"space-y-4"},qo={key:0,class:"font-medium mt-1"},Io={key:1,class:"font-medium mt-1"},Do={key:1,class:"space-y-4"},Ho={class:"grid grid-cols-2 gap-4"},Lo={class:"font-medium"},Oo={class:"font-medium"},To={class:"font-medium"},Wo={class:"font-medium"},Xo={class:"space-y-4"},Go={class:"font-medium mt-1"},Jo={key:0,class:"flex flex-wrap gap-2"},Ko={key:1,class:"space-y-4"},Qo={class:"flex items-center gap-2 p-3 bg-muted rounded-lg"},Yo={class:"text-sm"},Zo={key:0,class:"text-sm text-red-600 mt-1"},oa={class:"flex gap-2"},aa={key:0},ea={class:"font-medium"},sa={class:"text-sm text-muted-foreground"},ta={key:1},la={class:"font-medium"},na={class:"space-y-4"},ia={key:0,class:"absolute left-6 top-12 w-px h-full bg-border"},da={class:"flex-1 min-w-0"},ra={class:"flex items-center gap-2 mb-1"},ua={class:"flex items-center justify-between mb-2"},ma={class:"text-sm font-medium"},ca={class:"text-xs text-muted-foreground"},fa={class:"space-y-2"},pa={class:"flex items-center gap-2 text-sm"},_a={class:"font-medium"},va={class:"text-muted-foreground"},ba={key:0,class:"text-sm"},ga={class:"mt-1 p-2 bg-muted rounded text-sm"},Da=po({__name:"Show",props:{postulacion:{}},setup(J){const p=J,K=[{title:"Admin",href:"/admin/dashboard"},{title:"Postulaciones",href:"/admin/postulaciones"},{title:`${p.postulacion.usuario.name}`,href:`/admin/postulaciones/${p.postulacion.id}`}],_=_o({estado:"",comentarios:""}),z=X(!1),N=X(""),Q=l=>{switch(l){case"borrador":return D;case"enviada":return M;case"en_revision":return U;case"aceptada":return q;case"rechazada":return I;default:return F}},H=x(()=>{const l={};for(const[o,i]of Object.entries(p.postulacion.formulario_data)){const c=p.postulacion.convocatoria.formulario_postulacion.find(v=>v.id===o);c&&(l[c.title]=Array.isArray(i)?i.join(", "):i)}return l}),$=x(()=>{var o,i,c,v,E,S,O;if(!p.postulacion.candidatura_snapshot)return null;const l=p.postulacion.candidatura_snapshot;return{usuario:((o=l.usuario)==null?void 0:o.name)||"N/A",version:((i=l.candidatura)==null?void 0:i.version_original)||"N/A",fecha_aprobacion:((c=l.candidatura)==null?void 0:c.fecha_aprobacion)||"N/A",aprobado_por:((E=(v=l.candidatura)==null?void 0:v.aprobado_por)==null?void 0:E.name)||"N/A",formulario_data:((S=l.candidatura)==null?void 0:S.formulario_data)||{},configuracion_campos:((O=l.configuracion_en_momento)==null?void 0:O.campos)||[]}}),Y=x(()=>{if(!$.value)return{};const l={},{formulario_data:o,configuracion_campos:i}=$.value;for(const[c,v]of Object.entries(o)){const E=i.find(S=>S.id===c);E&&(l[E.title]=Array.isArray(v)?v.join(", "):v)}return l}),A=l=>{N.value=l,_.estado=l,_.comentarios="",z.value=!0},Z=()=>{_.post(`/admin/postulaciones/${p.postulacion.id}/cambiar-estado`,{onSuccess:()=>{z.value=!1}})},oo=()=>{z.value=!1,N.value="",_.reset()},ao=x(()=>["borrador","enviada","rechazada"].includes(p.postulacion.estado)),eo=x(()=>["enviada","en_revision"].includes(p.postulacion.estado)),so=x(()=>["enviada","en_revision"].includes(p.postulacion.estado)),to=x(()=>["enviada","en_revision","aceptada","rechazada"].includes(p.postulacion.estado)),lo=x(()=>p.postulacion.estado==="borrador"),no=l=>({enviada:"Enviada",en_revision:"En Revisión",aceptada:"Aceptada",rechazada:"Rechazada",borrador:"Borrador"})[l]||l,L=x(()=>["rechazada"].includes(N.value)),io=l=>({CheckCircle:q,XCircle:I,Clock:U,Send:M,Edit:D,FileText:F})[l]||F;return(l,o)=>(r(),u(j,null,[e(a(vo),{title:`Postulación de ${l.postulacion.usuario.name}`},null,8,["title"]),e(ro,{breadcrumbs:K},{default:s(()=>[t("div",Co,[t("div",ko,[t("div",wo,[t("div",$o,[t("div",ho,[e(a(C),{variant:"ghost",size:"sm",onClick:o[0]||(o[0]=i=>a(bo).get("/admin/postulaciones"))},{default:s(()=>[e(a(go),{class:"h-4 w-4 mr-2"}),o[7]||(o[7]=n(" Volver "))]),_:1})]),t("h1",Ao," Postulación de "+d(l.postulacion.usuario.name),1),t("p",Eo,d(l.postulacion.convocatoria.nombre),1)]),e(a(V),{class:h([l.postulacion.estado_color,"text-base px-3 py-1"])},{default:s(()=>[(r(),b(G(Q(l.postulacion.estado)),{class:"mr-2 h-4 w-4"})),n(" "+d(l.postulacion.estado_label),1)]),_:1},8,["class"])]),t("div",Fo,[e(a(g),null,{default:s(()=>[e(a(k),null,{default:s(()=>[e(a(w),{class:"flex items-center gap-2"},{default:s(()=>[e(a(B),{class:"h-5 w-5"}),o[8]||(o[8]=n(" Información del Usuario "))]),_:1})]),_:1}),e(a(y),{class:"space-y-3"},{default:s(()=>[t("div",null,[e(a(m),{class:"text-muted-foreground"},{default:s(()=>o[9]||(o[9]=[n("Nombre:")])),_:1}),t("p",zo,d(l.postulacion.usuario.name),1)]),t("div",null,[e(a(m),{class:"text-muted-foreground"},{default:s(()=>o[10]||(o[10]=[n("Email:")])),_:1}),t("p",No,d(l.postulacion.usuario.email),1)]),t("div",null,[e(a(m),{class:"text-muted-foreground"},{default:s(()=>o[11]||(o[11]=[n("Fecha postulación:")])),_:1}),t("p",So,d(l.postulacion.fecha_postulacion||"Borrador"),1)]),t("div",null,[e(a(m),{class:"text-muted-foreground"},{default:s(()=>o[12]||(o[12]=[n("Fecha creación:")])),_:1}),t("p",Vo,d(l.postulacion.created_at),1)])]),_:1})]),_:1}),e(a(g),null,{default:s(()=>[e(a(k),null,{default:s(()=>[e(a(w),{class:"flex items-center gap-2"},{default:s(()=>[e(a(F),{class:"h-5 w-5"}),o[13]||(o[13]=n(" Convocatoria "))]),_:1})]),_:1}),e(a(y),{class:"space-y-3"},{default:s(()=>[t("div",null,[e(a(m),{class:"text-muted-foreground"},{default:s(()=>o[14]||(o[14]=[n("Nombre:")])),_:1}),t("p",Ro,d(l.postulacion.convocatoria.nombre),1)]),t("div",null,[e(a(m),{class:"text-muted-foreground"},{default:s(()=>o[15]||(o[15]=[n("Cargo:")])),_:1}),t("p",jo,d(l.postulacion.convocatoria.cargo),1)]),t("div",null,[e(a(m),{class:"text-muted-foreground"},{default:s(()=>o[16]||(o[16]=[n("Periodo:")])),_:1}),t("p",Po,d(l.postulacion.convocatoria.periodo),1)]),t("div",null,[e(a(m),{class:"text-muted-foreground"},{default:s(()=>o[17]||(o[17]=[n("Ubicación:")])),_:1}),t("p",Bo,d(l.postulacion.convocatoria.ubicacion),1)])]),_:1})]),_:1})]),e(a(mo),{"default-value":"formulario",class:"space-y-4"},{default:s(()=>[e(a(co),{class:"grid w-full grid-cols-2"},{default:s(()=>[e(a(T),{value:"formulario"},{default:s(()=>o[18]||(o[18]=[n(" Respuestas del Formulario ")])),_:1}),e(a(T),{value:"candidatura",disabled:!l.postulacion.tiene_candidatura_vinculada},{default:s(()=>[o[20]||(o[20]=n(" Perfil de Candidatura ")),l.postulacion.tiene_candidatura_vinculada?(r(),b(a(V),{key:0,variant:"secondary",class:"ml-2"},{default:s(()=>o[19]||(o[19]=[n(" Vinculado ")])),_:1})):f("",!0)]),_:1},8,["disabled"])]),_:1}),e(a(W),{value:"formulario",class:"space-y-4"},{default:s(()=>[e(a(g),null,{default:s(()=>[e(a(k),null,{default:s(()=>[e(a(w),null,{default:s(()=>o[21]||(o[21]=[n("Respuestas del Formulario de Postulación")])),_:1}),e(a(R),null,{default:s(()=>o[22]||(o[22]=[n(" Respuestas proporcionadas por el usuario en el formulario de postulación. ")])),_:1})]),_:1}),e(a(y),null,{default:s(()=>[Object.keys(H.value).length===0?(r(),u("div",Mo,[e(a(F),{class:"mx-auto h-12 w-12 mb-2"}),o[23]||(o[23]=t("p",null,"No hay respuestas del formulario disponibles.",-1))])):(r(),u("div",Uo,[(r(!0),u(j,null,P(H.value,(i,c)=>(r(),u("div",{key:c,class:"border rounded-lg p-4"},[e(a(m),{class:"text-muted-foreground"},{default:s(()=>[n(d(c)+":",1)]),_:2},1024),typeof i=="string"&&i.length>100?(r(),u("p",qo,d(i),1)):(r(),u("p",Io,d(i||"Sin respuesta"),1))]))),128))]))]),_:1})]),_:1})]),_:1}),e(a(W),{value:"candidatura",class:"space-y-4"},{default:s(()=>[l.postulacion.tiene_candidatura_vinculada?(r(),u("div",Do,[e(a(g),null,{default:s(()=>[e(a(k),null,{default:s(()=>[e(a(w),null,{default:s(()=>o[25]||(o[25]=[n("Información del Perfil de Candidatura")])),_:1})]),_:1}),e(a(y),{class:"space-y-3"},{default:s(()=>[t("div",Ho,[t("div",null,[e(a(m),{class:"text-muted-foreground"},{default:s(()=>o[26]||(o[26]=[n("Usuario:")])),_:1}),t("p",Lo,d($.value.usuario),1)]),t("div",null,[e(a(m),{class:"text-muted-foreground"},{default:s(()=>o[27]||(o[27]=[n("Versión:")])),_:1}),t("p",Oo,"v"+d($.value.version),1)]),t("div",null,[e(a(m),{class:"text-muted-foreground"},{default:s(()=>o[28]||(o[28]=[n("Fecha aprobación:")])),_:1}),t("p",To,d($.value.fecha_aprobacion),1)]),t("div",null,[e(a(m),{class:"text-muted-foreground"},{default:s(()=>o[29]||(o[29]=[n("Aprobado por:")])),_:1}),t("p",Wo,d($.value.aprobado_por),1)])])]),_:1})]),_:1}),e(a(g),null,{default:s(()=>[e(a(k),null,{default:s(()=>[e(a(w),null,{default:s(()=>o[30]||(o[30]=[n("Datos del Perfil de Candidatura")])),_:1}),e(a(R),null,{default:s(()=>o[31]||(o[31]=[n(" Información capturada del perfil de candidatura en el momento de la postulación. ")])),_:1})]),_:1}),e(a(y),null,{default:s(()=>[t("div",Xo,[(r(!0),u(j,null,P(Y.value,(i,c)=>(r(),u("div",{key:c,class:"border rounded-lg p-4"},[e(a(m),{class:"text-muted-foreground"},{default:s(()=>[n(d(c)+":",1)]),_:2},1024),t("p",Go,d(i||"Sin información"),1)]))),128))])]),_:1})]),_:1})])):(r(),b(a(g),{key:0},{default:s(()=>[e(a(y),{class:"text-center py-8"},{default:s(()=>[e(a(B),{class:"mx-auto h-12 w-12 text-muted-foreground mb-2"}),o[24]||(o[24]=t("p",{class:"text-muted-foreground"},"No hay perfil de candidatura vinculado a esta postulación.",-1))]),_:1})]),_:1}))]),_:1})]),_:1}),e(a(g),null,{default:s(()=>[e(a(k),null,{default:s(()=>[e(a(w),null,{default:s(()=>o[32]||(o[32]=[n("Gestión de Estado")])),_:1}),e(a(R),null,{default:s(()=>o[33]||(o[33]=[n(" Cambia el estado de la postulación según el flujo de revisión. ")])),_:1})]),_:1}),e(a(y),null,{default:s(()=>[z.value?(r(),u("div",Ko,[t("div",Qo,[e(a(uo),{class:"h-5 w-5 text-amber-600"}),t("p",Yo,[o[39]||(o[39]=n(" ¿Estás seguro de que quieres cambiar el estado a ")),t("strong",null,d(no(N.value)),1),o[40]||(o[40]=n("? "))])]),t("div",null,[e(a(m),{for:"comentarios"},{default:s(()=>[n(" Comentarios "+d(L.value?"(requerido)":"(opcional)"),1)]),_:1}),e(a(fo),{id:"comentarios",modelValue:a(_).comentarios,"onUpdate:modelValue":o[6]||(o[6]=i=>a(_).comentarios=i),placeholder:L.value?"Explica el motivo del rechazo...":"Comentarios adicionales...",rows:"3",class:h([a(_).errors.comentarios?"border-red-300":""])},null,8,["modelValue","placeholder","class"]),a(_).errors.comentarios?(r(),u("p",Zo,d(a(_).errors.comentarios),1)):f("",!0)]),t("div",oa,[e(a(C),{onClick:Z,disabled:a(_).processing},{default:s(()=>o[41]||(o[41]=[n(" Confirmar Cambio ")])),_:1},8,["disabled"]),e(a(C),{variant:"outline",onClick:oo,disabled:a(_).processing},{default:s(()=>o[42]||(o[42]=[n(" Cancelar ")])),_:1},8,["disabled"])])])):(r(),u("div",Jo,[lo.value?(r(),b(a(C),{key:0,variant:"outline",onClick:o[1]||(o[1]=i=>A("enviada"))},{default:s(()=>[e(a(M),{class:"mr-2 h-4 w-4"}),o[34]||(o[34]=n(" Marcar como Enviada "))]),_:1})):f("",!0),ao.value?(r(),b(a(C),{key:1,variant:"outline",onClick:o[2]||(o[2]=i=>A("en_revision"))},{default:s(()=>[e(a(U),{class:"mr-2 h-4 w-4"}),o[35]||(o[35]=n(" Marcar en Revisión "))]),_:1})):f("",!0),eo.value?(r(),b(a(C),{key:2,onClick:o[3]||(o[3]=i=>A("aceptada"))},{default:s(()=>[e(a(q),{class:"mr-2 h-4 w-4"}),o[36]||(o[36]=n(" Aceptar "))]),_:1})):f("",!0),so.value?(r(),b(a(C),{key:3,variant:"destructive",onClick:o[4]||(o[4]=i=>A("rechazada"))},{default:s(()=>[e(a(I),{class:"mr-2 h-4 w-4"}),o[37]||(o[37]=n(" Rechazar "))]),_:1})):f("",!0),to.value?(r(),b(a(C),{key:4,variant:"outline",onClick:o[5]||(o[5]=i=>A("borrador"))},{default:s(()=>[e(a(D),{class:"mr-2 h-4 w-4"}),o[38]||(o[38]=n(" Volver a Borrador "))]),_:1})):f("",!0)]))]),_:1})]),_:1}),l.postulacion.revisado_por||l.postulacion.comentarios_admin?(r(),b(a(g),{key:0},{default:s(()=>[e(a(k),null,{default:s(()=>[e(a(w),{class:"flex items-center gap-2"},{default:s(()=>[e(a(yo),{class:"h-5 w-5"}),o[43]||(o[43]=n(" Información de Revisión "))]),_:1})]),_:1}),e(a(y),{class:"space-y-3"},{default:s(()=>[l.postulacion.revisado_por?(r(),u("div",aa,[e(a(m),{class:"text-muted-foreground"},{default:s(()=>o[44]||(o[44]=[n("Revisado por:")])),_:1}),t("p",ea,d(l.postulacion.revisado_por.name),1),t("p",sa,d(l.postulacion.fecha_revision),1)])):f("",!0),l.postulacion.comentarios_admin?(r(),u("div",ta,[e(a(m),{class:"text-muted-foreground"},{default:s(()=>o[45]||(o[45]=[n("Comentarios:")])),_:1}),t("p",la,d(l.postulacion.comentarios_admin),1)])):f("",!0)]),_:1})]),_:1})):f("",!0),l.postulacion.historial&&l.postulacion.historial.length>0?(r(),b(a(g),{key:1},{default:s(()=>[e(a(k),null,{default:s(()=>[e(a(w),{class:"flex items-center gap-2"},{default:s(()=>[e(a(xo),{class:"h-5 w-5"}),o[46]||(o[46]=n(" Historial de Cambios "))]),_:1}),e(a(R),null,{default:s(()=>o[47]||(o[47]=[n(" Cronología completa de todos los cambios de estado de esta postulación. ")])),_:1})]),_:1}),e(a(y),null,{default:s(()=>[t("div",na,[(r(!0),u(j,null,P(l.postulacion.historial,(i,c)=>{var v;return r(),u("div",{key:i.id,class:h(["relative flex items-start gap-4 pb-4",{"border-b border-border":c<l.postulacion.historial.length-1}])},[c<l.postulacion.historial.length-1?(r(),u("div",ia)):f("",!0),t("div",{class:h(["flex-shrink-0 w-12 h-12 rounded-full flex items-center justify-center",[i.tipo_cambio==="positivo"?"bg-green-100 text-green-600":i.tipo_cambio==="negativo"?"bg-red-100 text-red-600":i.tipo_cambio==="progreso"?"bg-blue-100 text-blue-600":"bg-gray-100 text-gray-600"]])},[(r(),b(G(io(i.tipo_cambio_icon)),{class:"w-5 h-5"}))],2),t("div",da,[t("div",ra,[e(a(V),{class:h([i.estado_anterior_color,"text-xs"])},{default:s(()=>[n(d(i.estado_anterior_label),1)]),_:2},1032,["class"]),o[48]||(o[48]=t("span",{class:"text-muted-foreground text-sm"},"→",-1)),e(a(V),{class:h([i.estado_nuevo_color,"text-xs"])},{default:s(()=>[n(d(i.estado_nuevo_label),1)]),_:2},1032,["class"])]),t("div",ua,[t("h4",ma,d(i.motivo_cambio||"Cambio de estado"),1),t("span",ca,d(i.tiempo_pasado),1)]),t("div",fa,[t("div",pa,[e(a(B),{class:"w-4 h-4 text-muted-foreground"}),o[49]||(o[49]=t("span",{class:"text-muted-foreground"},"Por:",-1)),t("span",_a,d(((v=i.cambiado_por)==null?void 0:v.name)||"Usuario eliminado"),1),t("span",va," • "+d(i.fecha_cambio),1)]),i.comentarios?(r(),u("div",ba,[e(a(m),{class:"text-muted-foreground"},{default:s(()=>o[50]||(o[50]=[n("Comentarios:")])),_:1}),t("p",ga,d(i.comentarios),1)])):f("",!0)])])],2)}),128))])]),_:1})]),_:1})):f("",!0)])])]),_:1})],64))}});export{Da as default};
